import{j as e,r,U as Or,V as xt,X as Er,Y as Vr,Z as Xe,$ as Ar,a0 as Ur,F as zr}from"./vendor_node_modules.js";import{u as qr,S as Br}from"./vendor_notistack.js";import{D as Ee,a as Ve,b as Ae,B as ue,c as Ge,F as Ye,C as qe,d as ae,A as Qr,I as Z,e as Gr,f as Kr,T as H,g as fe,M as Jr,h as lt,i as C,j as Fe,k as hr,l as Zr,m as Dt,n as Yr,o as ge,K as Kt,p as Jt,q as At,L as bt,r as pt,s as vt,t as z,W as gt,u as yt,H as jt,v as ee,V as Zt,w as Yt,x as Xr,E as eo,Q as fr,R as Pt,S as to,U as ro,P as oo,y as xr,z as Ut,G as _e,J as zt,N as br,O as Ke,X as vr,Y as no,Z as yr,_ as io,$ as so,a0 as lo,a1 as Xt,a2 as ao,a3 as co,a4 as po,a5 as uo,a6 as go,a7 as mo,a8 as ho,a9 as er,aa as fo,ab as xo,ac as bo,ad as vo,ae as yo,af as jo,ag as Co,ah as wo,ai as So,aj as ko,ak as Io,al as Mo,am as Do,an as Po,ao as Lo,ap as Nt,aq as Je,ar as jr,as as ke,at as Cr,au as Wt,av as Qe,aw as $o,ax as Wo,ay as Be,az as To,aA as Te,aB as Ct,aC as Rt,aD as Fo,aE as No}from"./vendor_mui.js";import{I as pe,m as Ro,a as tr,b as _o,c as Ho,d as rr,e as Oo,f as Eo,g as Vo,h as Ao,i as Uo,j as zo,k as qo,l as Bo,n as Qo,o as Go,p as Ko,q as Jo,r as or,s as Zo,t as Yo,u as Xo,v as en,w as tn,x as rn,y as on,z as nn,A as nr,B as sn,C as ln}from"./vendor_mdi.js";import{Q as an}from"./vendor_qrcode.js";import{F as cn,v as dn,e as pn,a as un,g as gn,b as mn,c as hn,d as _t,A as fn}from"./vendor_rjsf.js";import"./vendor_emotion.js";import"./vendor_lodash.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const m of s)if(m.type==="childList")for(const g of m.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&i(g)}).observe(document,{childList:!0,subtree:!0});function l(s){const m={};return s.integrity&&(m.integrity=s.integrity),s.referrerPolicy&&(m.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?m.credentials="include":s.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function i(s){if(s.ep)return;s.ep=!0;const m=l(s);fetch(s.href,m)}})();function xn({open:n,title:d,message:l,onConfirm:i,onCancel:s}){const m=b=>{o&&console.log("Confirmed"),b.preventDefault(),i()},g=b=>{o&&console.log("Canceled"),b.preventDefault(),s()};return e.jsxs(Ee,{open:n,children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:d})]})}),e.jsxs(Ae,{children:[e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",margin:"0",marginBottom:"20px",maxHeight:"350px",maxWidth:"350px"},children:e.jsx("p",{style:{flex:1,margin:"0"},children:l})}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around"},children:[e.jsx(ue,{onClick:m,variant:"contained",color:"primary",size:"small",children:"Confirm"}),e.jsx(ue,{onClick:g,variant:"contained",color:"primary",size:"small",children:"Cancel"})]})]})]})}const me="",te={enableMobile:`${me}enableMobile`,devicesFilter:`${me}devicesFilter`,devicesViewMode:`${me}devicesViewMode`,frontendVersion:`${me}frontendVersion`,matterbridgeVersion:`${me}matterbridgeVersion`,homePageMode:`${me}homePageMode`,logFilterLevel:`${me}logFilterLevel`,logFilterSearch:`${me}logFilterSearch`,logAutoScroll:`${me}logAutoScroll`,logLength:`${me}logLength`,frontendTheme:`${me}frontendTheme`,homePagePlugins:`${me}homePagePlugins`,virtualMode:`${me}virtualMode`,installAutoExit:`${me}installAutoExit`},bn={Devices_table_order_by:`${me}Devices_table_order_by`,Devices_table_order:`${me}Devices_table_order`,Devices_column_visibility:`${me}Devices_column_visibility`,Plugins_table_order_by:`${me}Plugins_table_order_by`,Plugins_table_order:`${me}Plugins_table_order`,Plugins_column_visibility:`${me}Plugins_column_visibility`,"Registered devices_table_order_by":`${me}Registered devices_table_order_by`,"Registered devices_table_order":`${me}Registered devices_table_order`,"Registered devices_column_visibility":`${me}Registered devices_column_visibility`,Clusters_table_order_by:`${me}Clusters_table_order_by`,Clusters_table_order:`${me}Clusters_table_order`,Clusters_column_visibility:`${me}Clusters_column_visibility`};function vn(){Object.values(te).forEach(n=>{localStorage.removeItem(n)}),Object.values(bn).forEach(n=>{localStorage.removeItem(n)})}const yn=({open:n,output:d,title:l,_command:i,_packageName:s,onInstall:m,onClose:g})=>{const{installAutoExit:b,setInstallAutoExit:t}=r.useContext(Le),T=r.useRef(null),j=S=>{t(S.target.checked),localStorage.setItem(te.installAutoExit,S.target.checked?"true":"false"),o&&console.log("handleInstallAutoExitChange called with value:",S.target.checked)};return r.useEffect(()=>{o&&console.log(`InstallProgressDialog output effect mounted, scrolling to bottom: ${T.current}`),setTimeout(()=>{o&&console.log("Scrolling to bottom:",T.current),T.current?.scrollIntoView({behavior:"smooth",block:"end"})},0)},[d]),e.jsxs(Ee,{open:n,onClose:(S,w)=>{w==="backdropClick"||w==="escapeKeyDown"||g()},slotProps:{paper:{sx:{width:"70vw",maxWidth:"70vw",height:"70vw",maxHeight:"70vh",overflow:"hidden"}}},children:[e.jsx(Ve,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:l})]})}),e.jsxs(Ae,{dividers:!0,style:{overflow:"hidden",display:"flex",flexDirection:"column",height:400,paddingBottom:0},children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontSize:"16px",fontWeight:"bold",color:"var(--primary-color)"},children:"Process log"}),e.jsxs("ul",{style:{width:"100%",height:"100%",fontFamily:"monospace",fontSize:"14px",padding:"10px",margin:0,marginBottom:"10px",color:"var(--div-text-color)",background:"var(--div-bg-color)",overflow:"auto",listStyle:"none",boxSizing:"border-box",borderRadius:4,border:"4px solid var(--primary-color)",whiteSpace:"pre-wrap",display:"block"},children:[d.split(`
`).map((S,w)=>e.jsx("li",{style:{padding:0,margin:0,wordBreak:"break-all"},children:S},w)),e.jsx("li",{ref:T,style:{padding:0,margin:0}})]})]}),e.jsxs(Ge,{sx:{justifyContent:"space-evenly"},children:[m&&e.jsx(ue,{variant:"contained",onClick:m,children:"Install"}),e.jsx(ue,{onClick:g,children:"Close"}),e.jsx(Ye,{control:e.jsx(qe,{checked:b,onChange:S=>j(S)}),label:"Close on success",style:{color:"var(--div-text-color)"}})]})]})},wt=[],Le=r.createContext(null);function jn({children:n}){const[d,l]=r.useState(!1),[i,s]=r.useState(null),{enqueueSnackbar:m,closeSnackbar:g}=qr(),b=r.useCallback(y=>{o&&console.log(`UiProvider closeSnackbarMessage: message ${y}`);const W=wt.findIndex(Q=>Q.message===y);W!==-1&&(g(wt[W].key),wt.splice(W,1),o&&console.log(`UiProvider closeSnackbarMessage: message ${y} removed from persistMessages`))},[g]),t=r.useCallback((y,W,Q)=>{o&&console.log(`UiProvider showSnackbarMessage: message ${y} timeout ${W}`);const ce=m(y,{variant:"default",autoHideDuration:W==null||W>0?(W??5)*1e3:null,persist:W===0,content:ne=>e.jsx(ae,{sx:{margin:"0",padding:"0",width:"300px",marginRight:"30px"},children:e.jsx(Qr,{severity:Q??"info",variant:"filled",sx:{color:"#fff",fontWeight:"normal",width:"100%",cursor:"pointer",padding:"0px 10px"},onClick:()=>g(ne),action:e.jsx(Z,{size:"small",onClick:()=>g(ne),sx:{color:"#fff"},children:e.jsx(Gr,{fontSize:"small"})}),children:y},ne)},ne)});W===0&&(o&&console.log(`UiProvider showSnackbarMessage: message ${y} timeout ${W} - persist key ${ce}`),wt.push({message:y,key:ce}))},[m,g]),[T,j]=r.useState(!1),[S,w]=r.useState(""),[E,q]=r.useState(""),[K,A]=r.useState(""),f=r.useRef(null),p=r.useRef(null),u=()=>{o&&console.log(`UiProvider handle confirm action ${K}`),j(!1),f.current&&f.current(K)},M=()=>{o&&console.log(`UiProvider handle cancel action ${K}`),j(!1),p.current&&p.current(K)},k=r.useCallback((y,W,Q,ce,ne)=>{o&&console.log(`UiProvider showConfirmCancelDialog for command ${Q}`),w(y),q(W),A(Q),f.current=ce,p.current=ne,j(!0)},[]),[P,O]=r.useState(!1),[oe,v]=r.useState(""),[c,a]=r.useState(""),[x,I]=r.useState(""),[R,re]=r.useState(""),[be,Ie]=r.useState(localStorage.getItem(te.installAutoExit)!=="false"),_=r.useCallback((y,W,Q)=>{o&&console.log(`UiProvider show install progress for package ${y}`),v(y),a(W),I(Q),O(!0)},[]),B=r.useCallback(y=>{o&&console.log(`UiProvider addInstallProgress: output ${y}`),re(W=>W+y+`
`)},[]),N=r.useCallback(()=>{o&&console.log(`UiProvider exitInstallProgressSuccess: package ${x}`),localStorage.getItem(te.installAutoExit)!=="false"&&O(!1)},[x]),Y=r.useCallback(()=>{o&&console.log(`UiProvider exitInstallProgressError: package ${x}`)},[x]),F=r.useCallback(()=>{o&&console.log("UiProvider hide install progress"),O(!1)},[]),L=()=>{o&&console.log("UiProvider handle install close action"),O(!1),I(""),re("")},$=r.useMemo(()=>({mobile:d,setMobile:l,currentPage:i,setCurrentPage:s,showSnackbarMessage:t,closeSnackbarMessage:b,closeSnackbar:g,showConfirmCancelDialog:k,showInstallProgress:_,exitInstallProgressSuccess:N,exitInstallProgressError:Y,hideInstallProgress:F,addInstallProgress:B,installAutoExit:be,setInstallAutoExit:Ie}),[d,i,l,s,t,b,g,k,_,N,Y,F,B,be,Ie]);return e.jsxs(Le.Provider,{value:$,children:[e.jsx(xn,{open:T,title:S,message:E,onConfirm:u,onCancel:M}),e.jsx(yn,{open:P,title:oe,_command:c,_packageName:x,output:R,onClose:L}),n]})}const wr=r.createContext(null),xe=r.createContext(null);function Cn({children:n}){const[d,l]=r.useState([]),[i,s]=r.useState(localStorage.getItem(te.logFilterLevel)??"info"),[m,g]=r.useState(localStorage.getItem(te.logFilterSearch)??"*"),[b,t]=r.useState(!1),{showSnackbarMessage:T,closeSnackbarMessage:j,closeSnackbar:S,showInstallProgress:w,hideInstallProgress:E,exitInstallProgressSuccess:q,exitInstallProgressError:K,addInstallProgress:A}=r.useContext(Le),f=r.useRef([]),p=r.useRef(null),u=r.useRef(1),M=r.useRef(Math.floor(Math.random()*999e3)+1e3),k=r.useRef(null),P=r.useRef(null),O=r.useRef(null),oe=r.useRef(i),v=r.useRef(m),c=r.useRef(0),a=r.useRef(null),x=r.useRef(Number(localStorage.getItem(te.logLength)??200)),I=r.useRef(localStorage.getItem(te.logAutoScroll)!=="false"),R=r.useMemo(()=>window.location.href.replace(/^http/,"ws"),[]),re=100,be=60,Ie=50,_=300,B=10;r.useEffect(()=>(o&&console.log("WebSocket messages started counter interval"),a.current=setInterval(()=>{c.current>0&&(o&&console.log(`WebSocket messages received in the last ${B} seconds: ${c.current*(60/B)} messages/minute`),c.current=0)},B*1e3),()=>{o&&console.log("WebSocket messages stopped counter interval"),a.current&&clearInterval(a.current),a.current=null}),[]),r.useEffect(()=>{oe.current=i},[i]),r.useEffect(()=>{v.current=m},[m]);const N=r.useCallback(()=>Math.floor(Math.random()*999e3)+1e3,[]),Y=r.useCallback((J,h)=>{o&&console.log(`WebSocket filterLogMessages called with level "${J}" and search "${h}"...`),l(ie=>ie.filter(G=>!(["debug","info","notice","warn","error","fatal"].includes(G.level)&&(J==="info"&&G.level==="debug"||J==="notice"&&(G.level==="debug"||G.level==="info")||J==="warn"&&(G.level==="debug"||G.level==="info"||G.level==="notice")||J==="error"&&(G.level==="debug"||G.level==="info"||G.level==="notice"||G.level==="warn")||J==="fatal"&&(G.level==="debug"||G.level==="info"||G.level==="notice"||G.level==="warn"||G.level==="error"))||h!=="*"&&h!==""&&!h.startsWith("/")&&!h.endsWith("/")&&!G.message.toLowerCase().includes(h.toLowerCase())&&!G.name.toLowerCase().includes(h.toLowerCase())||h.startsWith("/")&&h.endsWith("/")&&(()=>{try{const D=new RegExp(h.slice(1,-1),"i");return!D.test(G.message)&&!D.test(G.name)}catch(D){return console.error(`WebSocket log search invalid regex filter "${h}":`,D),!1}})())))},[]),F=r.useCallback(J=>{if(p.current&&p.current.readyState===WebSocket.OPEN)try{o&&console.log(`WebSocket sending message with id ${J.id}:`,J),J.id===void 0&&(J.id=M.current);const h=JSON.stringify(J);p.current.send(h),o&&console.log("WebSocket sent message:",J)}catch(h){o&&console.error(`WebSocket error sending message: ${h}`)}else o&&console.error("WebSocket message not sent, WebSocket not connected:",J)},[]),L=r.useCallback((J,h)=>{l(ie=>[...ie,{level:J,time:"",name:"",message:h}])},[]),$=r.useCallback((J,h)=>{o&&console.log(`WebSocket addListener id ${h}:`,J),(h==null||isNaN(h)||h===0)&&console.error("WebSocket addListener called without id, listener not added:",J),f.current=[...f.current,{listener:J,id:h}],o&&console.log("WebSocket addListener total listeners:",f.current.length)},[]),y=r.useCallback(J=>{o&&console.log("WebSocket removeListener:",J),f.current=f.current.filter(h=>h.listener!==J),o&&console.log("WebSocket removeListener total listeners:",f.current.length)},[]),W=r.useCallback(()=>{R===""||R===null||R===void 0||(L("WebSocket",`Connecting ${ct?"with password":""} to WebSocket: ${R}`),o&&console.log(`WebSocket connecting to: ${R}${ct?"?password=[redacted]":""}`),p.current=new WebSocket(R+(ct?`?password=${encodeURIComponent(ct)}`:"")),p.current.onmessage=J=>{b||t(!0),c.current+=1;try{const h=JSON.parse(J.data);if(h.id===void 0||h.src===void 0||h.dst===void 0){o&&console.error("WebSocket undefined message id/src/dst:",h);return}if(h.src!=="Matterbridge"||h.dst!=="Frontend"){o&&console.error("WebSocket invalid message src/dst:",h);return}if(h.error){o&&console.error("WebSocket error message response:",h);return}if(h.id===M.current&&h.method==="pong"&&h.response==="pong"){o&&console.log(`WebSocket pong response message id ${h.id}:`,h),P.current&&clearTimeout(P.current),P.current=null;return}else if(h.method==="snackbar"&&h.response&&h.response.message){o&&console.log(`WebSocket message id ${h.id} method ${h.method}:`,h),T(h.response.message,h.response.timeout,h.response.severity);return}else if(h.method==="close_snackbar"&&h.response&&h.response.message){o&&console.log(`WebSocket message id ${h.id} method ${h.method}:`,h),j(h.response.message);return}else if(h.method==="log"){if(!h.response||!h.response.level||!h.response.time||!h.response.name||!h.response.message||(h.response.level==="spawn"&&(h.response.name==="Matterbridge:spawn-init"?w(h.response.message,"",""):h.response.name==="Matterbridge:spawn-exit-success"?q():h.response.name==="Matterbridge:spawn-exit-error"?K():A(h.response.message+`
`)),["debug","info","notice","warn","error","fatal"].includes(h.response.level)&&(oe.current==="info"&&h.response.level==="debug"||oe.current==="notice"&&(h.response.level==="debug"||h.response.level==="info")||oe.current==="warn"&&(h.response.level==="debug"||h.response.level==="info"||h.response.level==="notice")||oe.current==="error"&&(h.response.level==="debug"||h.response.level==="info"||h.response.level==="notice"||h.response.level==="warn")||oe.current==="fatal"&&(h.response.level==="debug"||h.response.level==="info"||h.response.level==="notice"||h.response.level==="warn"||h.response.level==="error")))||v.current!=="*"&&v.current!==""&&!v.current.startsWith("/")&&!v.current.endsWith("/")&&!h.response.message.toLowerCase().includes(v.current.toLowerCase())&&!h.response.name.toLowerCase().includes(v.current.toLowerCase())||v.current.startsWith("/")&&v.current.endsWith("/")&&(()=>{try{const G=new RegExp(v.current.slice(1,-1),"i");return!G.test(h.response.message)&&!G.test(h.response.name)}catch(G){return console.error(`WebSocket log search invalid regex filter "${v.current}":`,G),!1}})()||h.response.name==="Commissioning"&&h.response.message.includes("is uncommissioned"))return;l(G=>{const D=[...G,{level:h.response.level,time:h.response.time,name:h.response.name,message:h.response.message}];return o&&console.log(`WebSocket new log message added (${D.length}/${x.current}):`,D[D.length-1]),D.length>x.current+x.current*10/100?(o&&console.log(`WebSocket sliced log messages to the last ${x.current} entries`),D.slice(D.length-x.current)):D})}else{if(o&&console.log(`WebSocket received message id ${h.id} method ${h.method}:`,h),h.id===0)f.current.forEach(ie=>ie.listener(h));else{const ie=f.current.find(G=>G.id===h.id);ie?ie.listener(h):console.warn(`WebSocket no listener found for message id ${h.id}:`,h)}return}}catch(h){console.error(`WebSocket error parsing message: ${h}`,h instanceof Error?h.stack:null)}},p.current.onopen=()=>{o&&console.log(`WebSocket: Connected to WebSocket: ${R}`),L("WebSocket",`Connected to WebSocket: ${R}`),t(!0),S(),u.current=1,O.current=setTimeout(()=>{k.current=setInterval(()=>{F({id:M.current,method:"ping",src:"Frontend",dst:"Matterbridge",params:{}}),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{o&&console.error(`WebSocketUse: No pong response received from WebSocket: ${R}`),L("WebSocket",`No pong response received from WebSocket: ${R}`),t(!1)},1e3*Ie)},1e3*be)},1e3*_)},p.current.onclose=()=>{o&&console.error(`WebSocket: Disconnected from WebSocket ${ht?"with Ingress":""}: ${R}`),L("WebSocket",`Disconnected from WebSocket: ${R}`),t(!1),S(),E(),O.current&&clearTimeout(O.current),P.current&&clearTimeout(P.current),k.current&&clearInterval(k.current),L("WebSocket",`Reconnecting (attempt ${u.current} of ${re}) to WebSocket${ht?" (Ingress)":""}: ${R}`),ht?setTimeout(Q,5e3):u.current===1?Q():u.current<re?setTimeout(Q,1e3*u.current):L("WebSocket",`Reconnect attempts exceeded limit of ${re} retries, refresh the page to reconnect to: ${R}`),u.current=u.current+1},p.current.onerror=J=>{o&&console.error(`WebSocket: WebSocket error connecting to ${R}:`,J),L("WebSocket",`WebSocket error connecting to ${R}`)})},[R]),Q=r.useCallback(()=>{o&&console.log(`WebSocket attemptReconnect ${u.current}/${re} to:`,R),W()},[W]);r.useEffect(()=>(W(),()=>{p.current&&p.current.readyState===WebSocket.OPEN&&p.current.close()}),[W]);const ce=r.useMemo(()=>({messages:d,logLength:x,logAutoScroll:I,logFilterLevel:i,logFilterSearch:m,setMessages:l,setLogFilterLevel:s,setLogFilterSearch:g,filterLogMessages:Y}),[d,x,I,i,m,l,s,g,Y]),ne=r.useMemo(()=>({logLength:x,logAutoScroll:I,logFilterLevel:i,logFilterSearch:m,setMessages:l,setLogFilterLevel:s,setLogFilterSearch:g,filterLogMessages:Y,online:b,retry:u.current,getUniqueId:N,addListener:$,removeListener:y,sendMessage:F,logMessage:L}),[x,I,l,s,g,b,u.current,$,y,F,L]);return e.jsx(wr.Provider,{value:ce,children:e.jsx(xe.Provider,{value:ne,children:n})})}function wn(n){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 296.2 296.2",...n,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"lg1",x1:"16.6",y1:"16.6",x2:"279.6",y2:"279.6",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#00b48d"}),e.jsx("stop",{offset:".1",stopColor:"#3faa77"}),e.jsx("stop",{offset:".3",stopColor:"#234148"}),e.jsx("stop",{offset:".7",stopColor:"#203b44"}),e.jsx("stop",{offset:".9",stopColor:"#ad2e6e"}),e.jsx("stop",{offset:"1",stopColor:"#c81b74"})]}),e.jsxs("linearGradient",{id:"lg2",x1:"31.1",y1:"31.1",x2:"265.1",y2:"265.1",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#00b48d"}),e.jsx("stop",{offset:".2",stopColor:"#285251"}),e.jsx("stop",{offset:".4",stopColor:"#234148"}),e.jsx("stop",{offset:".8",stopColor:"#203b44"}),e.jsx("stop",{offset:".9",stopColor:"#a8316c"}),e.jsx("stop",{offset:"1",stopColor:"#c81b74"})]}),e.jsxs("linearGradient",{id:"lg3",x1:"116.2",y1:"143.9",x2:"139.8",y2:"143.9",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#8bc751"}),e.jsx("stop",{offset:"1",stopColor:"#0db14b"})]}),e.jsx("linearGradient",{id:"lg4",x1:"136.1",y1:"100.8",x2:"159.6",y2:"100.8",xlinkHref:"#lg3"}),e.jsx("linearGradient",{id:"lg5",x1:"155.3",y1:"143.9",x2:"178.9",y2:"143.9",xlinkHref:"#lg3"}),e.jsxs("linearGradient",{id:"lg6",x1:"46.8",y1:"25.7",x2:"89.6",y2:"74.8",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#b1d34a"}),e.jsx("stop",{offset:"1",stopColor:"#50b848"})]})]}),e.jsx("rect",{width:"296.2",height:"296.2",rx:"56.7",ry:"56.7",style:{fill:"url(#lg1)"}}),e.jsx("rect",{x:"16.3",y:"16.3",width:"263.6",height:"263.6",rx:"50.5",ry:"50.5",style:{fill:"url(#lg2)"}}),e.jsx("circle",{cx:"128",cy:"143.9",r:"11.8",style:{fill:"url(#lg3)"}}),e.jsx("circle",{cx:"147.8",cy:"100.8",r:"11.8",style:{fill:"url(#lg4)"}}),e.jsx("path",{d:"m244.6 114.5.4-.5L160 33a17 17 0 0 0-24.7-.5l-86.4 83.3a15 15 0 0 0 9.2 26.9h19.3v-4.7l-13.7-12.7v-.1l83.7-80.8 84.2 81-13.9 12.8v4.5h19.5a15 15 0 0 0 7.4-28.1Z",style:{fill:"url(#lg3)"}}),e.jsx("circle",{cx:"167.1",cy:"143.9",r:"11.8",style:{fill:"url(#lg5)"}}),e.jsx("path",{fill:"#fff",d:"M219 89.3V35.5a10.5 10.5 0 1 0-21 0v33.7l21 20Z"}),e.jsx("path",{d:"M91.4 73.3H83a37 37 0 0 0-14.5-28.4L65 50.2c.1 0 12.6 9 11.7 25.4-5.3-.4-11.2-1.9-16.3-5.3-11.8-7.8-16-23.7-11.9-46 8.7 1.5 34 7 43 22.8 4.1 7.3 4.1 16.1 0 26.2Z",style:{fill:"url(#lg6)"}}),e.jsx("path",{d:"M65.9 80a49.6 49.6 0 0 0 17.8 2.2l16.6-16c1.6-8.3.5-15.7-3.3-22.4C84.6 22 47.8 17.5 46.2 17.4l-3-.4-.6 3c-3.8 18.4-5.9 50.6 23.2 60ZM48.4 24.4c8.7 1.5 34 7 43 22.8 4.1 7.3 4.1 16.1 0 26.2H83a37 37 0 0 0-14.5-28.4l-3.7 5.3c.1 0 12.6 9 11.7 25.4-5.3-.4-11.2-1.9-16.3-5.3-11.9-7.8-16-23.7-11.9-46Z",fill:"#1e5857"}),e.jsx("path",{fill:"#fff",d:"M250.5 90.5a17.4 17.4 0 1 1 0-34.8 17.4 17.4 0 0 1 0 34.8Zm0-22.7a5.4 5.4 0 0 0 0 10.7 5.3 5.3 0 0 0 0-10.7ZM258.8 148.2a15.9 15.9 0 0 0-9.6 28.5c-.8 4.2-5.4 4.6-5.4 4.6h-26v-43l13.6-13-1.8-2-82.2-79-81.2 78.3-2.5 2.6 13.7 13v42.9H53a21.5 21.5 0 1 0 11.7 15h12.6v18.8c0 7.8 6.4 14.1 14.1 14.1h29.3v14.8H64a10.6 10.6 0 0 0-17.7 8 10.6 10.6 0 0 0 17.6 8h157.6a16.3 16.3 0 1 0 0-16h-84.8V229h66.8c7.8 0 14.2-6.3 14.2-14.1v-19.2h27.6c14.3 0 17.8-12.8 18.5-16.6a15.9 15.9 0 0 0-5-30.9ZM43.7 210.8a10.3 10.3 0 1 1 0-20.6 10.3 10.3 0 0 1 0 20.6Zm192 36a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm-77-34.8h-22v-34h22v34Zm8.4-79.8c2.7 0 5.2 1 7.2 2.5v-10.4L188 137s2.6 1.3 4.6 1.3h6.7v68c0 3.2-2.6 5.7-5.7 5.7h-19v-34h1.4a7.5 7.5 0 0 0 0-15H120a7.5 7.5 0 0 0 0 15h.7v34h-19.3a5.7 5.7 0 0 1-5.7-5.6v-68.1h6.7c2 0 4.6-1.3 4.6-1.3l13.7-12.7v10.4a11.7 11.7 0 0 1 16 1.6v-13a14.9 14.9 0 0 0-25-10.8s-.1.2-.1.2l-.5.5-6.9 7H92.5l55-53.2 55.1 53.2h-11.8l-7-7c0-.2-.2-.3-.4-.5l-.2-.2a14.8 14.8 0 0 0-25 10.9v12.9c2.2-2.5 5.3-4.1 8.9-4.1Zm91.7 36.7a4.9 4.9 0 1 1 0-9.7 4.9 4.9 0 0 1 0 9.7Z"})]})}function He(){const{retry:n}=r.useContext(xe),d=()=>{window.location.reload()};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center",fontSize:"20px",color:"var(--main-text-color)",backgroundColor:"var(--main-bg-color)"},children:[e.jsx(wn,{style:{height:"128px",width:"128px",margin:"10px",marginBottom:"20px"}}),n<100?e.jsxs(e.Fragment,{children:[e.jsx(Kr,{style:{color:"var(--primary-color)"}}),e.jsx("div",{style:{marginTop:"20px",color:"var(--primary-color)",textAlign:"center"},children:e.jsxs("span",{children:["Reconnecting to Matterbridge ","(attempt "+n+")","..."]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginTop:"20px",color:"var(--primary-color)",textAlign:"center"},children:[e.jsx("span",{children:"Unable to connect to Matterbridge after multiple attempts."}),e.jsx("br",{}),e.jsx("span",{children:"Please check your network connection."}),e.jsx("br",{})]}),e.jsx(ue,{variant:"contained",color:"primary",onClick:d,style:{marginTop:"20px"},children:"Refresh the Page"})]})]})}function Sr({value:n,maxChars:d}){let l=n;if(n.length>d&&d>3){const i=d-3,s=n.substring(0,Math.ceil(i/2)),m=n.substring(n.length-Math.floor(i/2),n.length);l=`${s} â€¦ ${m}`}return n!==l?e.jsx(H,{title:n,placement:"top",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[0,12]}}]}},children:e.jsx("span",{children:l})}):e.jsx("span",{children:l})}function je({children:n,style:d}){const l={display:"flex",flexDirection:"column",flex:"0 0 auto",width:"100%",overflow:"hidden",margin:"0px",padding:"0px",gap:"0px",backgroundColor:"var(--div-bg-color)",boxShadow:"5px 5px 10px var(--div-shadow-color)",border:"1px solid var(--table-border-color)",borderRadius:"var(--div-border-radius)",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...d},children:n})}function De({children:n,style:d}){const l={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"30px",borderBottom:"1px solid var(--table-border-color)",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",margin:"0px",padding:"0px",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...d},children:n})}function Ce({children:n,style:d}){const l={color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",fontSize:"16px",fontWeight:"bold",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...d},children:n})}function mt({children:n,style:d}){const l={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"30px",color:"var(--footer-text-color)",backgroundColor:"var(--footer-bg-color)",margin:"0px",padding:"0px",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...d},children:n})}function at({children:n,style:d}){const l={color:"var(--footer-text-color)",backgroundColor:"var(--footer-bg-color)",fontSize:"14px",fontWeight:"bold",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...d},children:n})}function ut({children:n,style:d}){const l={color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",fontSize:"14px",fontWeight:"normal",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...d},children:n})}function Ne({children:n,style:d,onDragOver:l,onDragLeave:i,onDrop:s}){const m={flex:"0 0 auto",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"start",justifyContent:"space-between",margin:"0px",padding:"10px",gap:"20px"};return e.jsx("div",{style:{...m,...d},onDragOver:l,onDragLeave:i,onDrop:s,children:n})}function Ze({children:n,style:d,close:l}){const i={display:"flex",flexDirection:"row",margin:"0px",padding:"0px",paddingRight:"10px",gap:"10px"};return e.jsxs("div",{style:{...i,...d},children:[n,Oi]})}function Sn({systemInfo:n,compact:d}){const{mobile:l}=r.useContext(Le),{addListener:i,removeListener:s,getUniqueId:m,sendMessage:g}=r.useContext(xe),[b,t]=r.useState(n),T=r.useRef(m());if(o&&console.log("SystemInfoTable loading with systemInfo:",b,"compact:",d),n&&d&&b.totalMemory&&b.freeMemory){const f=b.totalMemory,p=b.freeMemory;b.freeMemory=`${p} / ${f}`,b.totalMemory=""}if(n&&d&&b.heapTotal&&b.heapUsed){const f=b.heapTotal,p=b.heapUsed;b.heapUsed=`${p} / ${f}`,b.heapTotal=""}if(n&&d&&b.osRelease&&b.osType){const f=b.osType,p=b.osRelease;b.osType=`${f} (${p})`,b.osRelease=""}if(n&&d&&b.osArch&&b.osPlatform){const f=b.osPlatform,p=b.osArch;b.osPlatform=`${f} (${p})`,b.osArch=""}const j=(f,p,u,M,k)=>{t(P=>({...P,totalMemory:f,freeMemory:p,heapTotal:u,heapUsed:M,rss:k}))},S=f=>{t(p=>({...p,cpuUsage:f.toFixed(2)+" %"}))},w=f=>{t(p=>({...p,processCpuUsage:f.toFixed(2)+" %"}))},E=(f,p)=>{t(u=>({...u,systemUptime:f,processUptime:p}))},q=()=>{o&&console.log("SystemInfoTable handleViewHistory clicked"),g({id:T.current,sender:"Header",method:"/api/viewhistorypage",src:"Frontend",dst:"Matterbridge",params:{}})};r.useEffect(()=>{const f=p=>{o&&console.log("SystemInfoTable received WebSocket Message:",p),p.method==="memory_update"&&p.response&&p.response.totalMemory&&p.response.freeMemory&&p.response.heapTotal&&p.response.heapUsed&&p.response.rss?(o&&console.log("SystemInfoTable received memory_update",p),j(p.response.totalMemory,p.response.freeMemory,p.response.heapTotal,p.response.heapUsed,p.response.rss)):p.method==="cpu_update"&&p.response&&p.response.cpuUsage?(o&&console.log("SystemInfoTable received cpu_update",p),S(p.response.cpuUsage),w(p.response.processCpuUsage)):p.method==="uptime_update"&&p.response&&p.response.systemUptime&&p.response.processUptime?(o&&console.log("SystemInfoTable received uptime_update",p),E(p.response.systemUptime,p.response.processUptime)):p.method==="/api/viewhistorypage"&&p.id===T.current&&p.success===!0&&(o&&console.log("SystemInfoTable received /api/viewhistorypage success"),window.open("./api/viewhistory","_blank","noopener,noreferrer"))};return i(f,T.current),o&&console.log(`SystemInfoTable added WebSocket listener id ${T.current}`),()=>{s(f),o&&console.log("SystemInfoTable removed WebSocket listener")}},[i,s]);const[K,A]=r.useState(!1);return!b||K?null:(o&&console.log("SystemInfoTable rendering..."),e.jsxs(je,{style:he&&l?{flex:"1 1 300px"}:{flex:"0 1 auto",width:"302px",minWidth:"302px"},children:[e.jsxs(De,{children:[e.jsx(Ce,{children:"System info"}),e.jsx(Ze,{close:()=>A(!0),children:e.jsx(Z,{size:"small",sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},onClick:q,children:e.jsx(H,{title:"Open the cpu and memory usage page",arrow:!0,children:e.jsx(pe,{path:Ro,size:"22px"})})})})]}),e.jsx(Ne,{style:he&&l?{flex:"1 1 auto",margin:"0px",padding:"0px",gap:"0px"}:{flex:"1 1 auto",overflow:"auto",margin:"0px",padding:"0px",gap:"0px"},children:e.jsxs("table",{style:{border:"none",borderCollapse:"collapse",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"60%"}})]}),e.jsx("tbody",{style:{border:"none",borderCollapse:"collapse"},children:Object.entries(b).filter(([f,p])=>p!==void 0&&p!=="").map(([f,p],u)=>e.jsxs("tr",{className:u%2===0?"table-content-even":"table-content-odd",style:{border:"none",borderCollapse:"collapse"},children:[e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap"},children:f.replace("interfaceName","Interface name").replace("macAddress","Mac address").replace("ipv4Address","IPv4 address").replace("ipv6Address","IPv6 address").replace("nodeVersion","Node version").replace("hostname","Hostname").replace("user","User").replace("osType","Os").replace("osPlatform","Platform").replace("freeMemory","Memory").replace("systemUptime","System uptime").replace("processUptime","Process uptime").replace("cpuUsage","Host CPU").replace("processCpuUsage","Process CPU").replace("rss","Rss").replace("heapUsed","Heap")}),e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:he&&l?typeof p!="string"?p.toString():p:e.jsx(Sr,{value:typeof p!="string"?p.toString():p,maxChars:22})})]},f))})]})})]}))}const ir=r.memo(Sn),sr={margin:"0px",padding:"0px",color:"var(--div-text-color)",transition:"color 0.2s ease","& svg":{display:"block"},"& svg path":{fill:"var(--div-text-color)",transition:"fill 0.2s ease"},"&:hover":{color:"var(--primary-color)"},"&:hover svg path":{fill:"var(--primary-color)"},"&:focus-visible":{outline:"2px solid var(--primary-color)",outlineOffset:"2px"}},kn=n=>{if(!n)return"";const d=n.toString().replace(/[^0-9]/g,"");if(d.length<5)return d;const l=d.slice(0,4),i=d.slice(4,7),s=d.slice(7,11);return[l,i,s].filter(Boolean).join("-")};function In({id:n}){const{online:d,sendMessage:l,addListener:i,removeListener:s,getUniqueId:m}=r.useContext(xe),[g,b]=r.useState(null),t=r.useRef(null),T=r.useRef(null),j=r.useRef(m()),{mobile:S,showConfirmCancelDialog:w}=r.useContext(Le);o&&console.log(`QRDiv loading with id = "${n}" storeId = "${t.current}" timeout = ${T.current} and  matter:`,g),r.useEffect(()=>{o&&console.log(`QRDiv id effect "${n}"`),t.current=n,T.current&&clearTimeout(T.current),T.current=null,n?(o&&console.log(`QRDiv id effect sending data request for storeId "${n}"`),l({id:j.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:n,server:!0}})):(o&&console.log("QRDiv id effect setting matter to null"),b(null))},[n,l]),r.useEffect(()=>{const p=u=>{o&&console.log("QRDiv received WebSocket Message:",u),u.method==="refresh_required"&&u.response.changed==="matter"&&u.response.matter&&(o&&console.log(`QRDiv received refresh_required: changed=${u.response.changed} for storeId "${u.response.matter.id}":`,u.response.matter),t.current===u.response.matter.id&&(o&&console.log(`QRDiv received refresh_required/matter: setting matter data for storeId "${u.response.matter.id}":`,u.response.matter),T.current&&clearTimeout(T.current),u.response.matter.advertising&&u.response.matter.advertiseTime&&u.response.matter.advertiseTime+9e5<=Date.now()&&(u.response.matter.advertising=!1),b(u.response.matter),u.response.matter.advertising&&(o&&console.log(`QRDiv setting matter advertise timeout for storeId "${u.response.matter.id}":`,u.response.matter.advertiseTime+9e5-Date.now()),T.current=setTimeout(()=>{T.current&&clearTimeout(T.current),o&&console.log(`QRDiv clearing advertising state for storeId "${t.current}" after 15 minutes`),b(M=>M&&{...M,advertising:!1})},u.response.matter.advertiseTime+9e5-Date.now()))))};return i(p,j.current),o&&console.log("QRDiv webSocket effect mounted"),()=>{s(p),T.current&&clearTimeout(T.current),T.current=null,o&&console.log("QRDiv webSocket effect unmounted")}},[i,s]);const E=()=>{o&&console.log(`QRDiv sent matter startCommission for node "${g?.id}"`),g&&l({id:j.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,startCommission:!0}})},q=()=>{o&&console.log(`QRDiv sent matter stopCommission for node "${g?.id}"`),g&&l({id:j.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,stopCommission:!0}})},K=()=>{o&&console.log(`QRDiv sent matter advertise for node "${g?.id}"`),g&&l({id:j.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,advertise:!0}})},A=p=>{o&&console.log(`QRDiv sent matter removeFabric for node "${g?.id}" and fabricIndex ${p}`),g&&l({id:j.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,removeFabric:p}})},f=async()=>{if(!g||!g.manualPairingCode)return;const p=g.manualPairingCode.toString();try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(p);else{const u=document.createElement("textarea");u.value=p,u.style.position="fixed",u.style.opacity="0",document.body.appendChild(u),u.focus(),u.select(),document.execCommand("copy"),document.body.removeChild(u)}o&&console.log("Manual pairing code copied to clipboard")}catch(u){console.error("Failed to copy manual pairing code",u)}};return!g||!d?(o&&console.log("QRDiv rendering undefined state"),null):g.online?g.advertising&&g.qrPairingCode&&g.manualPairingCode?(o&&console.log("QRDiv rendering advertising state"),e.jsxs(je,{style:he&&S?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px"},children:[e.jsxs(De,{children:[e.jsx(Ce,{children:"QR pairing code"}),e.jsxs(Ze,{children:[e.jsx(Z,{"aria-label":"send advertising",size:"small",onClick:K,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(H,{title:"Send again the mDNS advertisement",arrow:!0,children:e.jsx(pe,{path:tr,size:"22px"})})}),e.jsx(Z,{"aria-label":"stop pairing",size:"small",onClick:q,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(H,{title:"Turn off pairing",arrow:!0,children:e.jsx(pe,{path:_o,size:"22px"})})})]})]}),e.jsx(ut,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(an,{value:g.qrPairingCode,size:256,level:"M",fgColor:"var(--div-text-color)",bgColor:"var(--div-bg-color)",style:{margin:"20px"}}),e.jsxs(mt,{style:{justifyContent:"space-between"},children:[e.jsxs(at,{style:{fontWeight:"normal",color:"var(--div-text-color)"},children:["Manual pairing code: ",kn(g.manualPairingCode)]}),e.jsx(Ze,{children:e.jsx(H,{title:"Copy manual pairing code",arrow:!0,children:e.jsx(Z,{"aria-label":"copy manual pairing code",size:"small",onClick:f,sx:sr,children:e.jsx(pe,{path:Ho,size:.85})})})})]})]})):g.commissioned&&g.fabricInformations&&g.sessionInformations?(o&&console.log("QRDiv rendering commissioned state"),e.jsxs(je,{style:he&&S?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px",overflow:"hidden"},children:[e.jsxs(De,{children:[e.jsx(Ce,{children:"Paired fabrics"}),e.jsxs(Ze,{children:[e.jsx(Z,{"aria-label":"send advertising",size:"small",onClick:K,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(H,{title:"Send again the mDNS advertisement",arrow:!0,children:e.jsx(pe,{path:tr,size:"22px"})})}),e.jsx(Z,{"aria-label":"start pairing",size:"small",onClick:E,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(H,{title:"Turn on pairing",arrow:!0,children:e.jsx(pe,{path:rr,size:"22px"})})})]})]}),e.jsx(ut,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(Ne,{style:{flexDirection:"column",justifyContent:"flex-start",flex:"1 1 auto",overflow:"auto",padding:"0px 0px 10px 0px",gap:"0px"},children:g.fabricInformations.map((p,u)=>e.jsxs("div",{style:{margin:"0px",padding:"10px",gap:"0px",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",textAlign:"left",fontSize:"14px"},children:[e.jsxs("div",{style:{marginLeft:"20px",marginBottom:"10px",display:"flex",flexDirection:"row",justifyContent:"space-between",gap:"20px",alignItems:"center"},children:[e.jsxs("p",{className:"status-blue",style:{margin:"0px",padding:"3px 10px",width:"200px",fontSize:"14px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},children:["Fabric: ",p.fabricIndex]}),e.jsx(H,{title:"Remove the fabric. You will also need to remove it from the controller.",arrow:!0,children:e.jsx(Z,{"aria-label":"remove the fabric",size:"small",onClick:()=>w("Remove fabric","Are you sure you want to remove this fabric? You will also need to remove it from the controller.","RemoveFabric",()=>A(p.fabricIndex),()=>{}),sx:{...sr,padding:"2px"},children:e.jsx(pe,{path:Oo,size:1})})})]}),e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Vendor: ",p.rootVendorId," ",p.rootVendorName]}),p.label!==""&&e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Label: ",p.label]}),e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Sessions: ",g.sessionInformations?g.sessionInformations.filter(M=>M.fabric?.fabricIndex===p.fabricIndex&&M.isPeerActive===!0).length:"0"," ","subscriptions: ",g.sessionInformations?g.sessionInformations.filter(M=>M.fabric?.fabricIndex===p.fabricIndex&&M.isPeerActive===!0&&M.numberOfActiveSubscriptions>0).length:"0"]})]},u))}),e.jsx(mt,{style:{justifyContent:"center"},children:e.jsxs(at,{style:{fontWeight:"normal"},children:["Serial number: ",g.serialNumber]})})]})):!g.commissioned&&!g.advertising?(o&&console.log("QRDiv rendering not commissioned and not advertising state"),e.jsxs(je,{style:he&&S?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px"},children:[e.jsx(De,{children:e.jsx(Ce,{children:"QR pairing code"})}),e.jsx(ut,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(ue,{onClick:E,endIcon:e.jsx(pe,{path:rr,size:1}),style:{margin:"20px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:"Turn on pairing"}),e.jsx(mt,{style:{justifyContent:"center"},children:e.jsxs(at,{style:{fontWeight:"normal"},children:["Serial number: ",g.serialNumber]})})]})):(o&&console.log("QRDiv rendering unknown state"),null):(o&&console.log("QRDiv rendering offline state"),e.jsxs(je,{style:he&&S?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px"},children:[e.jsx(De,{style:{height:"30px",justifyContent:"space-between"},children:e.jsx(Ce,{children:"Server node"})}),e.jsx(ut,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(ut,{style:{fontWeight:"bold"},children:"Server offline"}),e.jsx(mt,{style:{justifyContent:"center"},children:e.jsxs(at,{style:{fontWeight:"normal"},children:["Serial number: ",g.serialNumber]})})]}))}const lr=r.memo(In),ar=["matterbridge-","matterbridge-plugin-template","matterbridge-dyson","matterbridge-irobot","matterbridge-tuya","matterbridge-mqtt","matterbridge-matter","matterbridge-security","matterbridge-automations","matterbridge-securitysystem"];function Mn(){const{mobile:n,showSnackbarMessage:d}=r.useContext(Le),{logMessage:l,sendMessage:i,getUniqueId:s}=r.useContext(xe),[m,g]=r.useState("matterbridge-"),[b,t]=r.useState(!1),[T,j]=r.useState(null),S=r.useRef(s()),w=c=>{c.preventDefault(),t(!0)},E=()=>{t(!1)},q=c=>{c.preventDefault(),t(!1);const a=c.dataTransfer.files[0];if(a){l("Plugins",`Installing package ${a.name}. Please wait...`);const x=new FormData;x.append("file",a),x.append("filename",a.name),fetch("./api/uploadpackage",{method:"POST",body:x}).then(I=>I.text()).then(I=>{l("Plugins",`Server response: ${I}`)}).catch(I=>{console.error("Error uploading plugin file:",I),l("Plugins",`Error installing package ${I}`)})}},K=c=>{const a=c.target.files&&c.target.files[0];if(a){l("Plugins",`Uploading package ${a.name}`);const x=new FormData;x.append("file",a),x.append("filename",a.name),fetch("./api/uploadpackage",{method:"POST",body:x}).then(I=>I.text()).then(I=>{l("Plugins",`Server response: ${I}`)}).catch(I=>{console.error("Error uploading plugin file:",I),l("Plugins",`Error uploading package ${I}`)})}},A=()=>{if(ar.includes(m.split("@")[0])){d(`Installation of plugin "${m}" is blocked by the ignore list.`);return}i({id:S.current,sender:"InstallPlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:m,restart:!1}})},f=()=>{i({id:S.current,sender:"InstallPlugins",method:"/api/uninstall",src:"Frontend",dst:"Matterbridge",params:{packageName:m}})},p=()=>{document.getElementById("file-upload")?.click()},u=()=>{if(ar.includes(m.split("@")[0])){d(`Addition of plugin "${m}" is blocked by the ignore list.`);return}i({id:S.current,sender:"InstallPlugins",method:"/api/addplugin",src:"Frontend",dst:"Matterbridge",params:{pluginNameOrPath:m}})},M=c=>{c.preventDefault(),console.log("Right-clicked Upload button")},k=c=>{c.preventDefault(),console.log("Right-clicked Add button")},P=c=>{j(c.currentTarget)},O=c=>{c!==""&&g(c),j(null)},[oe,v]=r.useState(!1);return o&&console.log("HomeInstallAddPlugins rendering..."),oe?null:e.jsxs(je,{children:[e.jsxs(De,{children:[e.jsx(Ce,{children:"Install plugins"}),e.jsx(Ze,{close:()=>v(!0)})]}),e.jsxs(Ne,{onDragOver:w,onDragLeave:E,onDrop:q,style:he&&n?{flexWrap:"wrap",alignItems:"center",gap:"10px"}:{flexWrap:"wrap",alignItems:"center",gap:"20px"},children:[e.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(fe,{value:m,onChange:c=>{g(c.target.value)},size:"small",id:"plugin-name",label:"Plugin name or plugin path",variant:"outlined",fullWidth:!0}),e.jsx(Z,{onClick:P,children:e.jsx(Jr,{})}),e.jsxs(lt,{id:"simple-menu",anchorEl:T,keepMounted:!0,open:!!T,onClose:()=>O(""),children:[e.jsx(C,{onClick:()=>O("matterbridge-zigbee2mqtt"),children:"matterbridge-zigbee2mqtt"}),e.jsx(C,{onClick:()=>O("matterbridge-somfy-tahoma"),children:"matterbridge-somfy-tahoma"}),e.jsx(C,{onClick:()=>O("matterbridge-shelly"),children:"matterbridge-shelly"}),e.jsx(C,{onClick:()=>O("matterbridge-hass"),children:"matterbridge-hass"}),e.jsx(C,{onClick:()=>O("matterbridge-webhooks"),children:"matterbridge-webhooks"}),e.jsx(C,{onClick:()=>O("matterbridge-bthome"),children:"matterbridge-bthome"}),e.jsx(C,{onClick:()=>O("matterbridge-test"),children:"matterbridge-test"}),e.jsx(C,{onClick:()=>O("matterbridge-example-accessory-platform"),children:"matterbridge-example-accessory-platform"}),e.jsx(C,{onClick:()=>O("matterbridge-example-dynamic-platform"),children:"matterbridge-example-dynamic-platform"}),e.jsx(C,{onClick:()=>O("matterbridge-eve-door"),children:"matterbridge-eve-door"}),e.jsx(C,{onClick:()=>O("matterbridge-eve-motion"),children:"matterbridge-eve-motion"}),e.jsx(C,{onClick:()=>O("matterbridge-eve-energy"),children:"matterbridge-eve-energy"}),e.jsx(C,{onClick:()=>O("matterbridge-eve-weather"),children:"matterbridge-eve-weather"}),e.jsx(C,{onClick:()=>O("matterbridge-eve-room"),children:"matterbridge-eve-room"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsx(H,{title:"Install or update a plugin from npm",children:e.jsxs(ue,{onClick:A,endIcon:e.jsx(Fe,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Install"]})}),e.jsx(H,{title:"Uninstall and remove a plugin",children:e.jsxs(ue,{onClick:f,endIcon:e.jsx(hr,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Uninstall"]})}),e.jsx(H,{title:"Upload and install a plugin from a tarball",children:e.jsxs(ue,{onClick:p,onContextMenu:M,endIcon:e.jsx(Zr,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Upload"]})}),e.jsx(H,{title:"Add an installed plugin",children:e.jsxs(ue,{onClick:u,onContextMenu:k,endIcon:e.jsx(Dt,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Add"]})}),e.jsx("input",{id:"file-upload",type:"file",accept:".tgz",style:{display:"none"},onChange:K})]})]})]})}const Dn=r.memo(Mn);function et({status:n,enabledText:d="Enabled",disabledText:l=void 0,tooltipText:i=void 0,onClick:s}){if(n===void 0)return null;{const m=e.jsx("div",{className:n?"status-enabled":"status-disabled",style:{cursor:"default"},onClick:s,children:n?d:l??d});return i!==void 0?e.jsx(H,{title:i,children:m}):m}}function Pn({title:n,children:d}){const l=r.useRef(null),[i,s]=r.useState(!1),m=()=>{const t=l.current;if(!t){s(!1);return}s(t.scrollWidth>t.clientWidth)},g=()=>{s(!1)},b={display:"inline-block",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};return e.jsx(H,{title:n,open:i,disableHoverListener:!0,disableFocusListener:!0,disableTouchListener:!0,slotProps:{tooltip:{sx:{fontSize:"14px",fontWeight:"normal",color:"#ffffff",backgroundColor:"var(--primary-color)"}}},children:e.jsx("span",{ref:l,onMouseEnter:m,onMouseLeave:g,style:b,children:d})})}function Ln(n,d,l){const i=n?.[l],s=d?.[l];return i==null&&s==null?0:i==null?-1:s==null?1:typeof i=="boolean"&&typeof s=="boolean"?i===s?0:i?1:-1:typeof i=="number"&&typeof s=="number"?i-s:String(i).localeCompare(String(s))}function $n({name:n,title:d,columns:l,rows:i,getRowKey:s,footerLeft:m,footerRight:g,onRowClick:b}){const t=r.useRef(new WeakMap),T=r.useRef(1),j=a=>{if(typeof s=="string"&&a&&a[s]!=null)return a[s];if(typeof s=="function"){const R=s(a);if(R!=null)return R}const x=l?.[0]?.id;if(x&&a&&a[x]!=null)return a[x];console.warn(`MbfTable(${n}): using fallback stable row key; consider providing getRowKey prop for better React performance`);let I=t.current.get(a);return I||(I=`rk_${T.current++}`,t.current.set(a,I)),I},[S,w]=r.useState(localStorage.getItem(`${n}_table_order_by`)||null),[E,q]=r.useState(localStorage.getItem(`${n}_table_order`)||null),[K,A]=r.useState(!1),[f,p]=r.useState(()=>{try{const a=localStorage.getItem(`${n}_column_visibility`);if(a)return JSON.parse(a)}catch{}return{}}),u=r.useMemo(()=>{const a={};for(const x of l)x.hidden||(a[x.id]=x.required?!0:f[x.id]!==!1);return a},[l,f]),M=r.useMemo(()=>{if(!S||!E)return i;const a=l.find(I=>I.id===S);if(!a||a.noSort)return i;const x=i.map((I,R)=>({el:I,index:R}));return x.sort((I,R)=>{let re;return typeof a.comparator=="function"?re=a.comparator(I.el,R.el):re=Ln(I.el,R.el,S),re!==0?E==="asc"?re:-re:I.index-R.index}),x.map(I=>I.el)},[i,S,E,l]),k=a=>{if(S!==a||!S){w(a),q("asc"),localStorage.setItem(`${n}_table_order_by`,a),localStorage.setItem(`${n}_table_order`,"asc");return}if(E==="asc"){q("desc"),localStorage.setItem(`${n}_table_order`,"desc");return}w(null),q(null),localStorage.removeItem(`${n}_table_order_by`),localStorage.removeItem(`${n}_table_order`)},P=()=>{A(!K)},O=a=>{p(x=>{const I=l.find(be=>be.id===a);if(I&&I.required)return x;const R=u[a]!==!1,re={...x};R?re[a]=!1:delete re[a];try{localStorage.setItem(`${n}_column_visibility`,JSON.stringify(re))}catch{}return re})},oe=()=>{p({});try{localStorage.removeItem(`${n}_column_visibility`)}catch{}A(!1)},[v,c]=r.useState(!1);return v?null:(o&&console.log(`Rendering table ${n}${S&&E?` ordered by ${S}:${E}`:""}`),e.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",margin:"0",padding:"0",gap:"0",width:"100%",height:"100%",overflow:"hidden"},children:[e.jsxs(Ee,{open:K,onClose:(a,x)=>{x==="backdropClick"||x==="escapeKeyDown"||P()},disableEscapeKeyDown:!0,disableRestoreFocus:!0,children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:`Configure ${n} columns`})]})}),e.jsx(Ae,{children:e.jsx(Yr,{children:l.filter(a=>!a.hidden).map(a=>e.jsx(Ye,{control:e.jsx(qe,{disabled:!!a.required,checked:a.required?!0:u[a.id]!==!1,onChange:()=>O(a.id)}),label:a.label},a.id))})}),e.jsxs(Ge,{children:[e.jsx(ue,{onClick:oe,children:"Reset"}),e.jsx(ue,{variant:"contained",onClick:a=>{if(a?.currentTarget&&typeof a.currentTarget.blur=="function")try{a.currentTarget.blur()}catch{}const x=document.activeElement;if(x&&x instanceof HTMLElement&&typeof x.blur=="function")try{x.blur()}catch{}P()},children:"Close"})]})]}),e.jsxs(De,{style:{height:"30px",minHeight:"30px",justifyContent:"space-between",borderBottom:"none"},children:[e.jsx(Ce,{children:n}),d&&e.jsx(Ce,{children:d}),e.jsx(Ze,{close:()=>c(!0),children:e.jsx(Z,{size:"small",sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},onClick:a=>{if(a?.currentTarget?.blur)try{a.currentTarget.blur()}catch{}P()},"aria-label":"Configure Columns",children:e.jsx(H,{title:`Configure ${n} columns`,children:e.jsx(pe,{path:Eo,size:"20px",color:"var(--header-text-color)"})})})})]}),e.jsx(Ne,{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",minHeight:0,width:"100%",overflow:"auto",margin:"0px",padding:"0px",gap:"0"},children:e.jsxs("table",{"aria-label":`${n} table`,style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{position:"sticky",top:0,zIndex:10,border:"none",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color"},children:e.jsx("tr",{style:{height:"30px",minHeight:"30px"},children:l.map(a=>{if(a.hidden||!a.required&&u[a.id]===!1)return null;const x=!a.noSort,I=x&&S===a.id&&!!E;return e.jsxs("th",{onClick:x?()=>k(a.id):void 0,style:{margin:"0",padding:"5px 10px",position:"sticky",top:0,minWidth:a.minWidth,maxWidth:a.maxWidth,textAlign:a.align||"left",cursor:x?"pointer":"default",border:"none",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",whiteSpace:a.maxWidth?"nowrap":void 0,overflow:a.maxWidth?"hidden":void 0,textOverflow:a.maxWidth?"ellipsis":void 0},"aria-sort":x?I?E==="asc"?"ascending":"descending":"none":void 0,children:[a.label,I&&e.jsxs("span",{style:{marginLeft:6},children:[E==="asc"&&e.jsx(pe,{path:Vo,size:"15px"}),E==="desc"&&e.jsx(pe,{path:Ao,size:"15px"})]})]},a.id)})})}),e.jsx("tbody",{children:M.map((a,x)=>{const I=j(a);return e.jsx("tr",{className:x%2===0?"table-content-even":"table-content-odd",onClick:b?R=>b(a,I,R):void 0,style:{height:"30px",minHeight:"30px",border:"none",borderCollapse:"collapse",cursor:b?"pointer":void 0},children:l.map(R=>{if(R.hidden||!R.required&&u[R.id]===!1)return null;const re=a[R.id],be=typeof R.render=="function"?R.render(re,I,a,R):typeof re=="boolean"?e.jsx(qe,{checked:re,disabled:!0,size:"small",sx:{m:0,p:0,color:"var(--table-text-color)","&.Mui-disabled":{color:"var(--table-text-color)",opacity:.7}}}):R.format&&typeof re=="number"?R.format(re):re!=null?String(re):null,_=!!R.tooltip&&R.maxWidth!==void 0&&R.maxWidth!==null&&re!==void 0&&re!==null&&be!==null?e.jsx(Pn,{title:String(re),children:be}):be;return e.jsx("td",{style:{border:"none",borderCollapse:"collapse",textAlign:R.align||"left",padding:"5px 10px",margin:"0",maxWidth:R.maxWidth,whiteSpace:R.maxWidth?"nowrap":void 0,overflow:R.maxWidth?"hidden":void 0,textOverflow:R.maxWidth?"ellipsis":void 0},children:_},R.id)})},I)})})]})}),(m||g)&&e.jsxs(mt,{style:{height:"30px",minHeight:"30px",justifyContent:"space-between",border:"none"},children:[e.jsx(at,{style:{fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)"},children:m}),e.jsx(at,{style:{fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)"},children:g})]})]}))}function Wn(n){return r.memo(n)}const Tt=Wn($n);function cr(n){return n.id!==0&&n.src==="Matterbridge"&&n.dst==="Frontend"}const tt={fontSize:"16px",fontWeight:"bold",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},rt={fontSize:"12px",fontWeight:"normal",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},Tn={fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)",backgroundColor:"var(--div-bg-color)"},Fn={fontSize:"16px",fontWeight:"bold",backgroundColor:"var(--div-bg-color)"},ze={padding:"0px",margin:"0px"},Nn="5px 10px 5px 10px",St={},Se={},kt={},It={};let ot=[],Ht=[];function Ot(n,d){const l=n?.properties;if(!l||typeof l!="object")return!1;const i=l[d];return!i||typeof i!="object"?!1:typeof i.type=="string"}function nt(n){const d=n.items;return d!==void 0&&typeof d=="object"&&!Array.isArray(d)}const Rn=({open:n,onClose:d,plugin:l})=>{const{sendMessage:i,addListener:s,removeListener:m,getUniqueId:g}=r.useContext(xe),b=r.useRef(g()),[t,T]=r.useState(l.configJson),[j,S]=r.useState(l.schemaJson),[w,E]=r.useState({"ui:submitButtonOptions":{submitText:"Confirm"},"ui:globalOptions":{orderable:!0}}),[q,K]=r.useState("");let A={};r.useEffect(()=>{const L=$=>{$.src==="Matterbridge"&&$.dst==="Frontend"&&(cr($)&&$.id===b.current&&$.method==="/api/select/devices"&&$.response&&(o&&console.log(`ConfigPluginDialog (id: ${$.id}) received ${$.response.length} /api/select/devices:`,$.response),ot=$.response),cr($)&&$.id===b.current&&$.method==="/api/select/entities"&&$.response&&(o&&console.log(`ConfigPluginDialog (id: ${$.id}) received ${$.response.length} /api/select/entities:`,$.response),Ht=$.response))};if(s(L,b.current),o&&console.log("ConfigPluginDialog added WebSocket listener id:",b.current),t&&j&&j.properties){const $=(y,W,Q=[])=>{!y||typeof y!="object"||(y.properties&&Object.keys(y.properties).forEach(ce=>{const ne=y.properties?.[ce],J=[...Q,ce];Object.keys(ne).forEach(h=>{if(h.startsWith("ui:")){let ie=W;J.forEach(G=>{ie[G]||(ie[G]={}),ie=ie[G]}),ie[h]=ne[h],delete ne[h]}}),$(ne,W,J)}),["oneOf","anyOf","allOf"].forEach(ce=>{Array.isArray(y[ce])&&y[ce].forEach(ne=>{$(ne,W,Q)})}),y.items&&typeof y.items=="object"&&$(y.items,W,Q))};$(j,w),E(w)}return l.name&&l.configJson&&l.schemaJson&&(T(l.configJson),S(l.schemaJson),i({id:b.current,sender:"ConfigPlugin",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name}}),i({id:b.current,sender:"ConfigPlugin",method:"/api/select/entities",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name}}),o&&console.log('HomePlugins sent "/api/select/devices" and "/api/select/entities" for plugin:',l.name)),()=>{m(L),o&&console.log("ConfigPluginDialog removed WebSocket listener")}},[s,t,l,m,j,i,w]);const f=(L,$)=>{A=L.formData},p=L=>{o&&console.log("ConfigPluginDialog handleSaveChanges:",L.formData),T(L.formData),l.configJson=L.formData,l.restartRequired=!0,i({id:b.current,sender:"ConfigPlugin",method:"/api/savepluginconfig",src:"Frontend",dst:"Matterbridge",params:{pluginName:L.formData.name,formData:L.formData}}),d()};function u(L){const{id:$,label:y,onKeyChange:W,onDropPropertyClick:Q,disabled:ce,schema:ne,children:J,registry:h,readonly:ie,required:G}=L,{templates:D}=h,{RemoveButton:ye}=D.ButtonTemplates;if(!(fn in ne))return e.jsx(ae,{sx:{display:"flex",flexDirection:"column",flexGrow:1,padding:0,margin:0,border:"none"},children:J});const ve=({target:se})=>W(se&&se.value);return e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",flexGrow:1,padding:0,margin:0,border:"none"},children:[e.jsx(fe,{id:`${$}-key`,name:`${$}-key`,required:G,disabled:ce||ie,defaultValue:y,onBlur:ie?void 0:ve,type:"text",variant:"outlined",sx:{width:"250px",minWidth:"250px",maxWidth:"250px",marginRight:"20px"}}),e.jsx(ae,{sx:{flex:1},children:J}),e.jsx(ye,{disabled:ce||ie,onClick:Q(y),registry:h})]})}function M(L){const{children:$,description:y,displayLabel:W,errors:Q,help:ce,hidden:ne,registry:J,uiSchema:h}=L,ie=mn(h),G=hn("WrapIfAdditionalTemplate",J,ie);return ne?e.jsx("div",{style:{display:"none"},children:$}):e.jsx(ae,{sx:{display:"flex",flexDirection:"column",flexGrow:1,padding:0,margin:0,border:"none"},children:e.jsxs(G,{...L,children:[W===!0&&y,$,Q,ce]})})}function k(L){const{description:$}=L;return $?e.jsx(ge,{sx:rt,children:$}):null}function P(L){const{required:$,title:y}=L;return y?e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:e.jsxs(ge,{sx:tt,children:["Title ",y," ",$&&e.jsx("mark",{children:"***"})]})}):null}function O(L){const{help:$}=L;return $?e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:e.jsx(ge,{sx:Tn,children:$})}):null}function oe(L){const{errors:$}=L;return $?e.jsxs(ae,{sx:{padding:"10px",margin:"10px",border:"1px solid grey"},children:[e.jsx(ge,{color:"error",sx:Fn,children:"Please fix the following errors:"}),e.jsx(pt,{children:$.map((y,W)=>e.jsxs(Xr,{children:[e.jsx(z,{children:e.jsx(eo,{color:"error"})}),e.jsx(ee,{primary:y.stack})]},W))})]}):null}function v(L){const{errors:$}=L;return $?e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:$.map((y,W)=>e.jsxs(ge,{color:"error",variant:"body2",sx:{marginLeft:1},children:["This field ",y]},W))}):null}function c(L){const{id:$,name:y,_schema:W,_uiSchema:Q,value:ce,options:ne,label:J,type:h,placeholder:ie,required:G,disabled:D,readonly:ye,autofocus:Re,onChange:ve,onChangeOverride:se,onBlur:de,onFocus:Oe,_rawErrors:Me,_hideError:dt,_registry:V,_formContext:we}=L,U=({target:{value:We}})=>ve(We===""?ne.emptyValue:We),le=({target:We})=>de($,We&&We.value),$e=({target:We})=>Oe($,We&&We.value);return e.jsx(ae,{sx:{padding:"0px",margin:"0px"},children:e.jsx(fe,{id:$,name:$,label:ie&&ie!==""?J:void 0,variant:"outlined",placeholder:ie&&ie!==""?ie:J,required:G,disabled:D||ye,autoFocus:Re,value:ce||ce===0?ce:"",type:h,autoComplete:h==="password"?"current-password":y,onChange:se||U,onBlur:le,onFocus:$e,fullWidth:!0})})}function a(L){return console.log("ArrayFieldTitleTemplate:",L),null}function x(L){return console.log("ArrayFieldDescriptionTemplate:",L),null}function I(L){return console.log("ArrayFieldItemTemplate:",L),null}function R(L){const{canAdd:$,onAddClick:y,schema:W,title:Q}=L,[ce,ne]=r.useState(!1),[J,h]=r.useState(!1),[ie,G]=r.useState(!1),[D,ye]=r.useState(""),Re=V=>{ye(V.target.value)},ve=()=>{o&&console.log("ArrayFieldTemplate: handleDialogDeviceToggle filter:",D,"selectDevices:",ot),ne(!ce)},se=()=>{o&&console.log("ArrayFieldTemplate: handleDialogEntityToggle filter:",D,"selectEntities:",Ht),h(!J)},de=()=>{o&&console.log("ArrayFieldTemplate: handleDialogDeviceEntityToggle filter:",D,"selectDevices:",ot),G(!ie)},Oe=V=>{ne(!1),W.selectFrom==="serial"&&nt(W)?W.items.default=V.serial:W.selectFrom==="name"&&nt(W)&&(W.items.default=V.name),y()},Me=V=>{h(!1),W.selectEntityFrom==="name"&&nt(W)?W.items.default=V.name:W.selectEntityFrom==="description"&&nt(W)&&(W.items.default=V.description),y()},dt=V=>{G(!1),W.selectDeviceEntityFrom==="name"&&nt(W)?W.items.default=V.name:W.selectDeviceEntityFrom==="description"&&nt(W)&&(W.items.default=V.description),y()};return e.jsxs(ae,{sx:{margin:"0px",padding:"5px 10px 5px 10px",border:"1px solid grey"},children:[Q&&e.jsxs(ae,{sx:{margin:"0px",padding:"0px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Q&&e.jsx(ge,{sx:tt,children:Q}),$&&e.jsxs(ae,{sx:{margin:"0px",padding:"0px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[W.selectFrom&&e.jsx(H,{title:"Add a device from the list",children:e.jsx(Z,{onClick:ve,size:"small",color:"primary",sx:ze,children:e.jsx(bt,{})})}),W.selectEntityFrom&&e.jsx(H,{title:"Add an entity from the list",children:e.jsx(Z,{onClick:se,size:"small",color:"primary",sx:ze,children:e.jsx(bt,{})})}),W.selectDeviceEntityFrom&&e.jsx(H,{title:"Add a device entity from the list",children:e.jsx(Z,{onClick:de,size:"small",color:"primary",sx:ze,children:e.jsx(bt,{})})}),e.jsx(H,{title:"Add a new item",children:e.jsx(Z,{onClick:y,size:"small",color:"primary",sx:ze,children:e.jsx(Dt,{})})})]})]}),W.description&&e.jsx(ge,{sx:rt,children:W.description}),L.items.map(V=>e.jsxs(ae,{sx:{margin:"2px 0px",padding:"0px",display:"flex",alignItems:"center"},children:[e.jsx(ae,{sx:{flexGrow:1,marginRight:"10px"},children:V.children}),e.jsx(Z,{disabled:!V.hasMoveUp,onClick:V.onReorderClick(V.index,V.index-1),size:"small",color:"primary",sx:ze,children:e.jsx(Jt,{})}),e.jsx(Z,{disabled:!V.hasMoveDown,onClick:V.onReorderClick(V.index,V.index+1),size:"small",color:"primary",sx:ze,children:e.jsx(Kt,{})}),e.jsx(Z,{onClick:V.onDropIndexClick(V.index),size:"small",color:"primary",sx:ze,children:e.jsx(At,{})})]},V.index)),e.jsxs(Ee,{open:ce,onClose:ve,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Ve,{children:"Select a device"}),e.jsxs(Ae,{children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(ge,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(fe,{fullWidth:!0,variant:"outlined",value:D,onChange:Re,placeholder:"Enter serial or name"})]}),e.jsx(pt,{dense:!0,children:ot.filter(V=>V.serial.toLowerCase().includes(D.toLowerCase())||V.name.toLowerCase().includes(D.toLowerCase())).map((V,we)=>e.jsxs(vt,{onClick:()=>Oe(V),sx:St,children:[V.icon==="wifi"&&e.jsx(z,{children:e.jsx(gt,{style:Se})}),V.icon==="ble"&&e.jsx(z,{children:e.jsx(yt,{style:Se})}),V.icon==="hub"&&e.jsx(z,{children:e.jsx(jt,{style:Se})}),e.jsx(ee,{primary:V.name,secondary:V.serial,primaryTypographyProps:{style:kt},secondaryTypographyProps:{style:It}})]},we))})]}),e.jsx(Ge,{children:e.jsx(ue,{onClick:ve,children:"Close"})})]}),e.jsxs(Ee,{open:J,onClose:se,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Ve,{children:"Select an entity"}),e.jsxs(Ae,{children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(ge,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(fe,{fullWidth:!0,variant:"outlined",value:D,onChange:Re,placeholder:"Enter name or description"})]}),e.jsx(pt,{dense:!0,children:Ht.filter(V=>V.name.toLowerCase().includes(D.toLowerCase())||V.description.toLowerCase().includes(D.toLowerCase())).map((V,we)=>e.jsxs(vt,{onClick:()=>Me(V),sx:St,children:[V.icon==="wifi"&&e.jsx(z,{children:e.jsx(gt,{style:Se})}),V.icon==="ble"&&e.jsx(z,{children:e.jsx(yt,{style:Se})}),V.icon==="hub"&&e.jsx(z,{children:e.jsx(jt,{style:Se})}),V.icon==="component"&&e.jsx(z,{children:e.jsx(Zt,{style:Se})}),V.icon==="matter"&&e.jsx(z,{children:e.jsx(Yt,{style:Se})}),e.jsx(ee,{primary:V.name,secondary:V.description,primaryTypographyProps:{style:kt},secondaryTypographyProps:{style:It}})]},we))})]}),e.jsx(Ge,{children:e.jsx(ue,{onClick:se,children:"Close"})})]}),e.jsxs(Ee,{open:ie,onClose:de,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsxs(Ve,{children:["Select an entity for ",Q]}),e.jsx(Ae,{children:e.jsx(pt,{dense:!0,children:ot.filter(V=>V.serial===Q||V.name===Q).map(V=>V.entities?.map((we,U)=>e.jsxs(vt,{onClick:()=>dt(we),sx:St,children:[we.icon==="wifi"&&e.jsx(z,{children:e.jsx(gt,{style:Se})}),we.icon==="ble"&&e.jsx(z,{children:e.jsx(yt,{style:Se})}),we.icon==="hub"&&e.jsx(z,{children:e.jsx(jt,{style:Se})}),we.icon==="component"&&e.jsx(z,{children:e.jsx(Zt,{style:Se})}),we.icon==="matter"&&e.jsx(z,{children:e.jsx(Yt,{style:Se})}),e.jsx(ee,{primary:we.name,secondary:we.description,primaryTypographyProps:{style:kt},secondaryTypographyProps:{style:It}})]},U)))})}),e.jsx(Ge,{children:e.jsx(ue,{onClick:de,children:"Close"})})]})]})}function re(L){const{onAddClick:$,schema:y,properties:W,title:Q,description:ce}=L,[ne,J]=r.useState(!1),[h,ie]=r.useState(""),G=se=>{ie(se.target.value)},D=()=>{J(!ne)},ye=se=>{o&&console.log(`ObjectFieldTemplate: handleSelectValue value "${se.serial}" for schema "${y.selectFrom}"`),J(!1);let de="";y.selectFrom==="serial"?de=se.serial:y.selectFrom==="name"&&(de=se.name),K(de),o&&console.log(`ObjectFieldTemplate: handleSelectValue newkey "${de}"`),$(y)()},Re=()=>{$(y)()},ve=!y.additionalProperties;return o&&console.log(`ObjectFieldTemplate: isRoot ${ve} newkey "${q}"`),!ve&&q!==""&&(o&&console.log("ObjectFieldTemplate: newkey",q,"properties",W),W.forEach(se=>{if(se.name==="newKey"&&se.content.key==="newKey"&&se.content.props.name==="newKey"&&se.content.props.onKeyChange&&q!==""){o&&console.log("ObjectFieldTemplate: newkey onKeyChange",q);const de=q;K(""),se.content.props.onKeyChange(de)}})),e.jsxs(ae,{sx:{margin:"0px",padding:ve?"10px":"5px 10px 0px 10px",border:ve?"none":"1px solid grey"},children:[y.title&&ve&&e.jsx(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px",marginBottom:"10px"},children:e.jsx(ge,{sx:tt,children:y.title})}),Q&&!ve&&e.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px"},children:[e.jsx(ge,{sx:tt,children:Q}),e.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px"},children:[y.selectFrom&&e.jsx(H,{title:"Add a device from the list",children:e.jsx(Z,{onClick:D,size:"small",color:"primary",sx:ze,children:e.jsx(bt,{})})}),e.jsx(H,{title:"Add a new item",children:e.jsx(Z,{onClick:Re,size:"small",color:"primary",sx:ze,children:e.jsx(Dt,{})})})]})]}),y.description&&e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginBottom:"10px"},children:e.jsx(ge,{sx:rt,children:y.description})}),W.map(({content:se,name:de,hidden:Oe})=>!Oe&&e.jsxs(ae,{sx:{margin:"0px",marginBottom:"10px",padding:Ot(y,de)&&["object","array"].includes(y.properties[de].type)?"0px":Nn,border:Ot(y,de)&&["object","array"].includes(y.properties[de].type)?"none":"1px solid grey"},children:[Ot(y,de)&&!["object","array","boolean"].includes(y.properties[de].type)&&e.jsx(ge,{sx:tt,children:y.properties[de].title||de}),e.jsx(ae,{sx:{flexGrow:1,padding:"0px",margin:"0px"},children:se})]},de)),e.jsxs(Ee,{open:ne,onClose:D,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Ve,{children:"Select a device"}),e.jsxs(Ae,{children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(ge,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(fe,{fullWidth:!0,variant:"outlined",value:h,onChange:G,placeholder:"Enter serial or name"})]}),e.jsx(pt,{dense:!0,children:ot.filter(se=>se.serial.toLowerCase().includes(h.toLowerCase())||se.name.toLowerCase().includes(h.toLowerCase())).map((se,de)=>e.jsxs(vt,{onClick:()=>ye(se),sx:St,children:[se.icon==="wifi"&&e.jsx(z,{children:e.jsx(gt,{style:Se})}),se.icon==="ble"&&e.jsx(z,{children:e.jsx(yt,{style:Se})}),se.icon==="hub"&&e.jsx(z,{children:e.jsx(jt,{style:Se})}),e.jsx(ee,{primary:se.name,secondary:se.serial,primaryTypographyProps:{style:kt},secondaryTypographyProps:{style:It}})]},de))})]}),e.jsx(Ge,{children:e.jsx(ue,{onClick:D,children:"Close"})})]})]})}function be(L){const{uiSchema:$}=L,{submitText:y,norender:W}=gn($);return W?null:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",margin:"10px",padding:"0px",gap:"20px"},children:[e.jsx(ue,{type:"submit",variant:"contained",color:"primary",children:y}),e.jsx(ue,{variant:"contained",color:"primary",onClick:d,children:"Cancel"})]})}function Ie(L){const{className:$,disabled:y,onClick:W,registry:Q,style:ce,uiSchema:ne,...J}=L;return e.jsx(H,{title:"Remove the item",children:e.jsx(Z,{disabled:y,size:"small",color:"primary",onClick:W,children:e.jsx(At,{})})})}function _(L){const{className:$,disabled:y,onClick:W,registry:Q,uiSchema:ce,...ne}=L;return e.jsx(H,{title:"Add an item",children:e.jsx(Z,{size:"small",color:"primary",onClick:W,children:e.jsx(Dt,{})})})}function B(L){const{disabled:$,onClick:y,registry:W,style:Q,uiSchema:ce,...ne}=L;return e.jsx(H,{title:"Move up the item",children:e.jsx(Z,{size:"small",color:"primary",onClick:y,children:e.jsx(Jt,{})})})}function N(L){const{disabled:$,onClick:y,registry:W,style:Q,uiSchema:ce,...ne}=L;return e.jsx(H,{title:"Move down the item",children:e.jsx(Z,{size:"small",color:"primary",onClick:y,children:e.jsx(Kt,{})})})}function Y(L){const{id:$,name:y,value:W,schema:Q,readonly:ce,onChange:ne}=L,[J,h]=r.useState(),ie=D=>{o&&console.log(`CheckboxWidget ${y} onChangeField:`,D),h(D&&D!==""?D:void 0)},G=()=>{o&&console.log(`CheckboxWidget onClick plugin="${l.name}" action="${y}" value="${J}"`),i({id:b.current,sender:"ConfigPlugin",method:"/api/action",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name,action:y,value:J,formData:A,id:$}}),Q.buttonClose===!0?d():Q.buttonSave===!0&&p({formData:t})};return Q.buttonText&&Q.description?e.jsxs(ae,{sx:{margin:"0px",padding:"10px",border:"1px solid grey",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(ge,{sx:rt,children:Q.description}),e.jsx(ue,{variant:"contained",color:"primary",onClick:()=>G(),children:Q.buttonText})]}):Q.buttonField&&Q.description?e.jsxs(ae,{sx:{margin:"0px",padding:"10px",gap:"20px",border:"1px solid grey",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(ge,{sx:rt,children:Q.description}),e.jsx(fe,{id:y+"-input",name:y,label:Q.textLabel,placeholder:Q.textPlaceholder,onChange:D=>ie(D.target.value),sx:{width:"250px",minWidth:"250px",maxWidth:"250px"}}),e.jsx(ue,{id:y+"-button",variant:"contained",color:"primary",disabled:J===void 0,onClick:()=>G(),children:Q.buttonField})]}):e.jsxs(ae,{sx:{margin:"0px",padding:"0px"},children:[y&&e.jsxs(ae,{sx:{margin:"0px",padding:"0px",gap:"10px",display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(ge,{sx:tt,children:Q.title||y}),e.jsx(qe,{checked:W,readOnly:ce,onChange:()=>ne(!W),sx:{padding:"0px",margin:"0px"}})]}),Q.description&&e.jsx(ge,{sx:rt,children:Q.description})]})}function F({schema:L,id:$,name:y,options:W,label:Q,hideLabel:ce,required:ne,disabled:J,placeholder:h,readonly:ie,value:G,multiple:D,autofocus:ye,onChange:Re,onBlur:ve,onFocus:se,errorSchema:de,rawErrors:Oe=[],registry:Me,uiSchema:dt,hideError:V,formContext:we,...U}){const{enumOptions:le,enumDisabled:$e,emptyValue:We}=W;D=typeof D>"u"?!1:!!D;const qt=D?[]:"",Bt=typeof G>"u"||D&&G.length<1||!D&&G===qt,Pr=({target:{value:Ue}})=>Re(_t(Ue,le,We)),Lr=({target:Ue})=>ve($,_t(Ue&&Ue.value,le,We)),$r=({target:Ue})=>se($,_t(Ue&&Ue.value,le,We)),Qt=pn(G,le,D),{InputLabelProps:Wr,SelectProps:Tr,autocomplete:Fr,...Nr}=U,Rr=!D&&L.default===void 0;return e.jsxs(fe,{id:$,name:$,value:!Bt&&typeof Qt<"u"?Qt:qt,required:ne,disabled:J||ie,autoFocus:ye,autoComplete:Fr,placeholder:h,error:Oe.length>0,onChange:Pr,onBlur:Lr,onFocus:$r,...Nr,select:!0,InputLabelProps:{...Wr,shrink:!Bt},SelectProps:{...Tr,multiple:D},"aria-describedby":un($),children:[Rr&&e.jsx(C,{value:"",children:h}),Array.isArray(le)&&le.map(({value:Ue,label:_r},Gt)=>{const Hr=Array.isArray($e)&&$e.indexOf(Ue)!==-1;return e.jsx(C,{value:String(Gt),disabled:Hr,children:_r},Gt)})]})}return o&&console.log("ConfigPluginDialog rendering..."),!n||!j||!t?null:e.jsxs(Ee,{open:n,onClose:d,slotProps:{paper:{sx:{maxWidth:"800px"}}},children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h3",{children:"Matterbridge plugin configuration"})]})}),e.jsx(Ae,{style:{padding:"0px",margin:"0px",width:"800px",height:"600px",overflow:"auto"},children:e.jsx(cn,{schema:j,formData:t,uiSchema:w,validator:dn,templates:{FieldTemplate:M,BaseInputTemplate:c,TitleFieldTemplate:P,DescriptionFieldTemplate:k,FieldHelpTemplate:O,FieldErrorTemplate:v,ErrorListTemplate:oe,WrapIfAdditionalTemplate:u,ArrayFieldTitleTemplate:a,ArrayFieldDescriptionTemplate:x,ArrayFieldItemTemplate:I,ArrayFieldTemplate:R,ObjectFieldTemplate:re,ButtonTemplates:{SubmitButton:be,RemoveButton:Ie,AddButton:_,MoveUpButton:B,MoveDownButton:N}},widgets:{CheckboxWidget:Y,SelectWidget:F},onChange:f,onSubmit:p})})]})};function kr(n){if(o&&console.log(`getQRColor (id: ${n?.id}) received matter:`,n??"undefined"),n===void 0||!n.online||!n.qrPairingCode&&!n.manualPairingCode&&!n.fabricInformations&&!n.sessionInformations)return"red";if(n.commissioned===!1&&n.qrPairingCode&&n.manualPairingCode)return"var(--primary-color)";let d=0,l=0;for(const i of n.sessionInformations??[])i.fabric&&i.isPeerActive===!0&&d++,i.numberOfActiveSubscriptions>0&&(l+=i.numberOfActiveSubscriptions);return n.commissioned===!0&&n.fabricInformations&&n.sessionInformations&&(d===0||l===0)?"var(--secondary-color)":"var(--div-text-color)"}function _n({storeId:n,setStoreId:d}){const{online:l,sendMessage:i,addListener:s,removeListener:m,getUniqueId:g}=r.useContext(xe),{showConfirmCancelDialog:b}=r.useContext(Le),t=r.useRef(g()),[T,j]=r.useState(null),[S,w]=r.useState(null),[E,q]=r.useState([]),K=[{label:"Name",id:"name",required:!0,render:(N,Y,F,L)=>e.jsx(H,{title:`Plugin path ${F.path}`,children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>v(F),children:F.name})})},{label:"Description",id:"description",render:(N,Y,F,L)=>e.jsx(H,{title:"Open the plugin homepage",children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>v(F),children:F.description})})},{label:"Version",id:"version",render:(N,Y,F,L)=>e.jsx(e.Fragment,{children:e.jsx(H,{title:`Plugin v.${F.version}`,children:e.jsx("span",{children:F.version.split("-")[0]+(F.version.includes("-dev-")?"@dev":"")+(F.version.includes("-git-")?"@git":"")})})})},{label:"Author",id:"author",render:(N,Y,F,L)=>e.jsx(e.Fragment,{children:F.author?F.author.replace("https://github.com/",""):"Unknown"})},{label:"Type",id:"type",render:(N,Y,F,L)=>e.jsx(e.Fragment,{children:F.type?F.type.replace("Platform",""):"Unknown"})},{label:"Devices",id:"registeredDevices"},{label:"Actions",id:"actions",required:!0,noSort:!0,render:(N,Y,F,L)=>e.jsxs("div",{style:{margin:"0px",padding:"0px",gap:"4px",display:"flex",flexDirection:"row"},children:[S&&S.bridgeMode==="childbridge"&&!F.error&&F.enabled&&e.jsx(H,{title:"Shows the QRCode or the fabrics",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0",padding:"0",width:"19px",height:"19px",color:kr(F.matter)},onClick:()=>{F.matter?.id&&d(F.matter?.id)},size:"small",children:e.jsx(fr,{})})}),S&&S.bridgeMode==="childbridge"&&!F.error&&F.enabled&&e.jsx(H,{title:"Restart the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0",padding:"0",width:"19px",height:"19px"},onClick:()=>O(F),size:"small",children:e.jsx(Pt,{})})}),e.jsx(H,{title:"Plugin config",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{disabled:F.restartRequired===!0,style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>Ie(F),size:"small",children:e.jsx(to,{})})}),S&&!S.readOnly&&e.jsx(H,{title:"Remove the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>{f("Remove plugin","Are you sure? This will also remove all devices and configuration from the controller.","remove",F)},size:"small",children:e.jsx(hr,{})})}),F.enabled?e.jsx(H,{title:"Disable the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>{f("Disable plugin","Are you sure? This will also remove all devices and configuration from the controller.","disable",F)},size:"small",children:e.jsx(ro,{})})}):e.jsx(e.Fragment,{}),F.enabled?e.jsx(e.Fragment,{}):e.jsx(H,{title:"Enable the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>oe(F),size:"small",children:e.jsx(oo,{})})}),e.jsx(H,{title:"Open the plugin help",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>a(F),size:"small",children:e.jsx(xr,{})})}),e.jsx(H,{title:"Open the plugin version history",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>x(F),size:"small",children:e.jsx(Ut,{})})}),F.latestVersion!==void 0&&F.latestVersion!==F.version&&S&&!S.readOnly&&e.jsx(H,{title:"Update the plugin to the latest version",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{color:"var(--primary-color)",margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>M(F),size:"small",children:e.jsx(_e,{})})}),(F.version.includes("-dev-")||F.version.includes("-git-"))&&F.devVersion!==void 0&&F.devVersion!==F.version&&S&&!S.readOnly&&e.jsx(H,{title:"Update the plugin to the latest dev version",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{color:"var(--secondary-color)",margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>k(F),size:"small",children:e.jsx(_e,{})})}),S&&!S.readOnly&&e.jsx(H,{title:"Sponsor the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{style:{margin:"0",padding:"0",width:"19px",height:"19px",color:"#b6409c"},onClick:()=>c(F),size:"small",children:e.jsx(zt,{})})})]})},{label:"Status",id:"status",required:!0,noSort:!0,render:(N,Y,F,L)=>e.jsx("div",{style:{display:"flex",flexDirection:"row",flex:"1 1 auto",margin:"0",padding:"0",gap:"5px",width:"auto",maxWidth:"max-content"},children:F.error?e.jsx(e.Fragment,{children:e.jsx(et,{status:!1,enabledText:"Error",disabledText:"Error",tooltipText:"The plugin is in error state. Check the log!"})}):e.jsx(e.Fragment,{children:F.enabled===!1?e.jsx(e.Fragment,{children:e.jsx(et,{status:F.enabled,enabledText:"Enabled",disabledText:"Disabled",tooltipText:"Whether the plugin is enable or disabled"})}):e.jsx(e.Fragment,{children:F.loaded&&F.started&&F.configured?e.jsx(e.Fragment,{children:e.jsx(et,{status:F.loaded,enabledText:"Running",tooltipText:"Whether the plugin is running"})}):e.jsxs(e.Fragment,{children:[e.jsx(et,{status:F.loaded,enabledText:"Loaded",tooltipText:"Whether the plugin has been loaded"}),e.jsx(et,{status:F.started,enabledText:"Started",tooltipText:"Whether the plugin started"}),e.jsx(et,{status:F.configured,enabledText:"Configured",tooltipText:"Whether the plugin has been configured"})]})})})})}];r.useEffect(()=>{const N=Y=>{o&&console.log("HomePlugins received WebSocket Message:",Y),Y.method==="refresh_required"&&Y.response.changed==="plugins"?(o&&console.log(`HomePlugins received refresh_required: changed=${Y.response.changed} and sending /api/plugins request`),i({id:t.current,sender:"HomePlugins",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})):Y.method==="refresh_required"&&Y.response.changed==="matter"?(o&&console.log(`HomePlugins received refresh_required: changed=${Y.response.changed} and setting matter id ${Y.response.matter?.id}`),q(F=>{const L=F.findIndex(y=>y.matter?.id===Y.response.matter?.id);if(L<0)return o&&console.log(`HomePlugins received refresh_required: changed=${Y.response.changed} and matter id ${Y.response.matter?.id} not found`),F;o&&console.log(`HomePlugins received refresh_required: changed=${Y.response.changed} set matter id ${Y.response.matter?.id}`);const $=[...F];return $[L]={...$[L],matter:Y.response.matter},$})):Y.method==="refresh_required"&&Y.response.changed==="settings"&&(o&&console.log(`HomePlugins received refresh_required: changed=${Y.response.changed} and sending /api/settings request`),i({id:t.current,sender:"HomePlugins",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})),Y.id===t.current&&Y.method==="/api/settings"?(o&&console.log(`HomePlugins (id: ${Y.id}) received settings:`,Y.response),j(Y.response.systemInformation),w(Y.response.matterbridgeInformation)):Y.id===t.current&&Y.method==="/api/plugins"&&(o&&console.log(`HomePlugins (id: ${Y.id}) received ${Y.response.length} plugins:`,Y.response),q(Y.response))};return s(N,t.current),o&&console.log("HomePlugins added WebSocket listener id:",t.current),()=>{m(N),o&&console.log("HomePlugins removed WebSocket listener")}},[s,m,i]),r.useEffect(()=>{l&&(o&&console.log("HomePlugins sending api requests"),i({id:t.current,sender:"HomePlugins",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),i({id:t.current,sender:"HomePlugins",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[l,i]);const A=r.useRef(null),f=(N,Y,F,L)=>{o&&console.log(`handleActionWithConfirmCancel ${F} ${L.name}`),A.current=L,b(N,Y,F,p,u)},p=N=>{o&&console.log(`handleConfirm action confirmed ${N} ${A.current?.name}`),N==="remove"&&A.current?P(A.current):N==="disable"&&A.current&&oe(A.current),A.current=null},u=N=>{o&&console.log(`handleCancel action canceled ${N} ${A.current?.name}`),A.current=null},M=N=>{o&&console.log("handleUpdatePlugin plugin:",N.name),i({id:t.current,sender:"HomePlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:N.name,restart:!1}})},k=N=>{o&&console.log("handleUpdateDevPlugin plugin:",N.name),i({id:t.current,sender:"HomePlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:N.name+"@dev",restart:!1}})},P=N=>{o&&console.log("handleRemovePlugin plugin:",N.name),i({id:t.current,sender:"HomePlugins",method:"/api/removeplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:N.name}})},O=N=>{o&&console.log("handleRestartPlugin plugin:",N.name),i({id:t.current,sender:"HomePlugins",method:"/api/restartplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:N.name}})},oe=N=>{o&&console.log("handleEnableDisablePlugin plugin:",N.name,"enabled:",N.enabled),N.enabled===!0?(N.enabled=!1,i({id:t.current,sender:"HomePlugins",method:"/api/disableplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:N.name}})):(N.enabled=!0,i({id:t.current,sender:"HomePlugins",method:"/api/enableplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:N.name}}))},v=N=>{o&&console.log(`handleHomepagePlugin plugin: ${N.name} homepage: ${N.homepage}`),N.homepage&&window.open(N.homepage,"_blank")},c=N=>{o&&console.log("handleSponsorPlugin plugin:",N.name,"funding:",N.funding),N.funding&&window.open(N.funding,"_blank")},a=N=>{o&&console.log("handleHelpPlugin plugin:",N.name,"help:",N.help),N.help&&window.open(N.help,"_blank")},x=N=>{o&&console.log("handleChangelogPlugin plugin:",N.name,"changelog:",N.changelog),N.changelog&&window.open(N.changelog,"_blank")},[I,R]=r.useState(),[re,be]=r.useState(!1),Ie=N=>{o&&console.log("handleConfigPlugin plugin:",N.name),i({id:t.current,sender:"HomePlugins",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:N.name}}),i({id:t.current,sender:"HomePlugins",method:"/api/select/entities",src:"Frontend",dst:"Matterbridge",params:{plugin:N.name}}),R(N),_()},_=()=>{be(!0)},B=()=>{be(!1)};return o&&console.log("HomePlugins rendering..."),l?e.jsxs(je,{children:[I&&e.jsx(Rn,{open:re,onClose:B,plugin:I}),e.jsx(Tt,{name:"Plugins",columns:K,rows:E,footerRight:"",footerLeft:""})]}):e.jsx(He,{})}const Hn=r.memo(_n),On=n=>`${n.pluginName}::${n.serial}`;function En({storeId:n,setStoreId:d}){const{online:l,sendMessage:i,addListener:s,removeListener:m,getUniqueId:g}=r.useContext(xe),[b,t]=r.useState(!1),[T,j]=r.useState(!0),[S,w]=r.useState(null),[E,q]=r.useState([]),[K,A]=r.useState([]),[f,p]=r.useState([]),[u,M]=r.useState([]),k=r.useRef(g()),P=[{label:"Plugin",id:"pluginName"},{label:"Name",id:"name",required:!0},{label:"Serial",id:"serial"},{label:"Availability",id:"availability",render:(v,c,a,x)=>a.reachable===!0?"Online":a.reachable===!1?e.jsx("span",{style:{color:"red"},children:"Offline"}):"",comparator:(v,c)=>{const a=v.reachable===!0?1:v.reachable===!1?0:-1,x=c.reachable===!0?1:c.reachable===!1?0:-1;return a-x}},{label:"Power",id:"powerSource",render:(v,c,a,x)=>a.powerSource==="ac"||a.powerSource==="dc"?e.jsx(br,{fontSize:"small",sx:{color:"var(--primary-color)"}}):a.powerSource==="ok"?a.batteryLevel?e.jsx(H,{title:`Battery level: ${a.batteryLevel}%`,children:e.jsx(Ke,{fontSize:"small",sx:{color:"green"}})}):e.jsx(Ke,{fontSize:"small",sx:{color:"gray"}}):a.powerSource==="warning"?a.batteryLevel?e.jsx(H,{title:`Battery level: ${a.batteryLevel}%`,children:e.jsx(Ke,{fontSize:"small",sx:{color:"yellow"}})}):e.jsx(Ke,{fontSize:"small",sx:{color:"yellow"}}):a.powerSource==="critical"?a.batteryLevel?e.jsx(H,{title:`Battery level: ${a.batteryLevel}%`,children:e.jsx(Ke,{fontSize:"small",sx:{color:"red"}})}):e.jsx(Ke,{fontSize:"small",sx:{color:"red"}}):e.jsx("span",{})},{label:"Actions",id:"selected",required:!0,render:(v,c,a,x)=>e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[a.matter!==void 0?e.jsx(H,{title:"Show the QRCode or the fabrics",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{onClick:()=>d(n===a.matter?.id?S?.matterbridgeInformation.bridgeMode==="bridge"?"Matterbridge":null:a.matter?.id||null),"aria-label":"Show the QRCode",sx:{margin:0,padding:0,color:kr(a.matter)},children:e.jsx(fr,{fontSize:"small"})})}):e.jsx("div",{style:{width:"20px",height:"20px"}}),a.configUrl?e.jsx(H,{title:"Open the configuration page",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Z,{onClick:()=>window.open(a.configUrl,"_blank"),"aria-label":"Open config url",sx:{margin:0,padding:0},children:e.jsx(vr,{fontSize:"small"})})}):e.jsx("div",{style:{width:"20px",height:"20px"}}),a.selected!==void 0?e.jsx(H,{title:"Select/unselect the device",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(qe,{checked:a.selected,onChange:I=>oe(I,a),sx:{margin:"0",marginLeft:"8px",padding:"0"},size:"small"})}):e.jsx("div",{style:{width:"20px",height:"20px"}})]})}],O=r.useCallback(v=>{v.selected=void 0;const c=E.find(I=>I.name===v.pluginName);if(!c)return console.error(`HomeDevices isSelected: plugin ${v.pluginName} not found for device ${v.name} `),v.selected;const a=c.schemaJson?.properties?.whiteList?.selectFrom;let x=c.configJson.postfix;return x===""&&(x=void 0),c.hasWhiteList===!0&&c.hasBlackList===!0&&a&&(v.selected=!0,a==="serial"&&c.configJson.whiteList&&c.configJson.whiteList.length>0&&c.configJson.whiteList.includes(x?v.serial.replace("-"+x,""):v.serial)&&(v.selected=!0),a==="serial"&&c.configJson.whiteList&&c.configJson.whiteList.length>0&&!c.configJson.whiteList.includes(x?v.serial.replace("-"+x,""):v.serial)&&(v.selected=!1),a==="serial"&&c.configJson.blackList&&c.configJson.blackList.length>0&&c.configJson.blackList.includes(x?v.serial.replace("-"+x,""):v.serial)&&(v.selected=!1),a==="name"&&c.configJson.whiteList&&c.configJson.whiteList.length>0&&c.configJson.whiteList.includes(v.name)&&(v.selected=!0),a==="name"&&c.configJson.whiteList&&c.configJson.whiteList.length>0&&!c.configJson.whiteList.includes(v.name)&&(v.selected=!1),a==="name"&&c.configJson.blackList&&c.configJson.blackList.length>0&&c.configJson.blackList.includes(v.name)&&(v.selected=!1)),v.selected},[E]);r.useEffect(()=>{const v=c=>{if(o&&console.log("HomeDevices received WebSocket Message:",c),c.method==="refresh_required"&&c.response.changed!=="matter"?(o&&console.log(`HomeDevices received refresh_required: changed=${c.response.changed} and sending /api/plugins request`),i({id:k.current,sender:"HomeDevices",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})):c.method==="refresh_required"&&c.response.changed==="matter"?(o&&console.log(`HomeDevices received refresh_required: changed=${c.response.changed} and setting matter id ${c.response.matter?.id}`),M(a=>{const x=a.findIndex(R=>R.name.replaceAll(" ","")===c.response.matter?.id);if(x<0)return o&&console.debug(`HomeDevices: matter id ${c.response.matter?.id} not found`),a;const I=[...a];return I[x]={...I[x],matter:c.response.matter},o&&console.log(`HomeDevices received refresh_required: changed=${c.response.changed} and set matter id ${c.response.matter?.id}`),I})):c.method==="restart_required"?(o&&console.log("HomeDevices received restart_required"),t(!0)):c.method==="restart_not_required"?(o&&console.log("HomeDevices received restart_not_required"),t(!1)):c.method==="state_update"&&c.response.plugin&&c.response.serialNumber&&c.response.cluster.includes("BasicInformation")&&c.response.attribute==="reachable"&&(o&&console.log(`HomeDevices updating device reachability for plugin ${c.response.plugin} serial ${c.response.serialNumber} value ${c.response.value}`),A(a=>{const x=a.findIndex(I=>I.pluginName===c.response.plugin&&I.serial===c.response.serialNumber);return x<0?(o&&console.warn(`HomeDevices: device to update not found for plugin ${c.response.plugin} serial ${c.response.serialNumber}`),a):(a[x]={...a[x],reachable:c.response.value},[...a])})),c.id===k.current&&c.method==="/api/settings")o&&console.log(`HomeDevices (id: ${c.id}) received settings:`,c.response),w(c.response),t(c.response.matterbridgeInformation.restartRequired||c.response.matterbridgeInformation.fixedRestartRequired);else if(c.id===k.current&&c.method==="/api/plugins"){if(o&&console.log(`HomeDevices (id: ${c.id}) received ${c.response?.length} plugins:`,c.response),c.response){let a=!0;for(const x of c.response)x.enabled===!0&&(x.loaded!==!0||x.started!==!0||x.error===!0)&&(a=!1);if(!a)return;o&&console.log("HomeDevices reset plugins, devices and selectDevices"),j(!1),q(c.response),A([]),p([]),i({id:k.current,sender:"HomeDevices",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}}),o&&console.log("HomeDevices sent /api/devices");for(const x of c.response)x.enabled===!0&&x.loaded===!0&&x.started===!0&&x.error!==!0&&(i({id:k.current,sender:"HomeDevices",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:x.name}}),o&&console.log(`HomeDevices sent /api/select/devices for plugin: ${x.name}`))}}else if(c.id===k.current&&c.method==="/api/devices"){if(o&&console.log(`HomeDevices (id: ${c.id}) received ${c.response?.length} devices:`,c.response),c.response){for(const a of c.response)a.selected=O(a);A(c.response)}}else c.id===k.current&&c.method==="/api/select/devices"&&(o&&console.log(`HomeDevices (id: ${c.id}) received ${c.response?.length} selectDevices for plugin ${c.response&&c.response.length>0?c.response[0].pluginName:"without select devices"}:`,c.response),c.response&&c.response.length>0&&p(a=>{const x=a.filter(R=>R.pluginName!==c.response[0].pluginName),I=c.response.map(R=>({...R,selected:O(R)}));return[...x,...I]}))};return s(v,k.current),o&&console.log(`HomeDevices added WebSocket listener id ${k.current}`),()=>{m(v),o&&console.log("HomeDevices removed WebSocket listener")}},[E,s,m,i,O]),r.useEffect(()=>{if(K.length===0&&f.length===0){M([]);return}o&&console.log(`HomeDevices mixing devices (${K.length}) and selectDevices (${f.length})`);const v=[];for(const c of K)v.push(c);for(const c of f)K.find(a=>a.pluginName===c.pluginName&&a.serial.includes(c.serial))||v.push(c);v.length>0&&(M(v),o&&console.log(`HomeDevices mixed ${v.length} devices and selectDevices`))},[E,K,f,M]),r.useEffect(()=>{l&&(o&&console.log("HomeDevices sending /api/settings and /api/plugins requests"),i({id:k.current,sender:"HomeDevices",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),i({id:k.current,sender:"HomeDevices",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[l,i]);const oe=(v,c)=>{o&&console.log(`handleCheckboxChange: checkbox changed to ${v.target.checked} for device ${c.name} serial ${c.serial}`),K.findIndex(a=>a.pluginName===c.pluginName&&a.serial===c.serial)<0?(o&&console.warn(`handleCheckboxChange: device ${c.name} serial ${c.serial} not found in devices, trying in mixedDevices`),M(a=>{const x=a.findIndex(I=>I.pluginName===c.pluginName&&I.serial===c.serial);return x<0?(console.error(`handleCheckboxChange: device ${c.name} serial ${c.serial} not found in mixedDevices`),a):(a[x]={...a[x],selected:v.target.checked},[...a])})):A(a=>{const x=a.findIndex(I=>I.pluginName===c.pluginName&&I.serial===c.serial);return x<0?(console.error(`handleCheckboxChange: device ${c.name} serial ${c.serial} not found in devices`),a):(a[x]={...a[x],selected:v.target.checked},[...a])}),v.target.checked?i({id:k.current,sender:"HomeDevices",method:"/api/command",src:"Frontend",dst:"Matterbridge",params:{command:"selectdevice",plugin:c.pluginName,serial:c.serial,name:c.name}}):i({id:k.current,sender:"HomeDevices",method:"/api/command",src:"Frontend",dst:"Matterbridge",params:{command:"unselectdevice",plugin:c.pluginName,serial:c.serial,name:c.name}})};return o&&console.log("HomeDevices rendering..."),l?e.jsx(je,{style:{flex:"1 1 auto"},children:e.jsx(Tt,{name:"Devices",getRowKey:On,rows:u,columns:P,footerLeft:T?"Waiting for the plugins to fully load...":`Registered devices: ${K.length.toString()}/${u.length.toString()}`,footerRight:b?"Restart required":""})}):e.jsx(He,{})}const Vn=r.memo(En);function ft({children:n,style:d,name:l}){const{setCurrentPage:i}=r.useContext(Le);i(l),o&&console.log(`MbfPage: current page set to ${l}`);const s={display:"flex",flexDirection:"column",width:"100%",height:"100%",margin:"0px",padding:"0px",gap:"20px"};return e.jsx("div",{style:{...s,...d},children:n})}const An=()=>"ontouchstart"in window||typeof window.DocumentTouch<"u"&&document instanceof window.DocumentTouch?(o&&console.log("WebSocketLogs detectTouchscreen = true"),!0):(o&&console.log("WebSocketLogs detectTouchscreen = false"),!1);function Un(){const{messages:n,logAutoScroll:d}=r.useContext(wr),[l,i]=r.useState(!1),s=r.useRef(null),m=r.useRef(0),g=r.useRef(null),b=r.useMemo(()=>An(),[]),t=w=>i(!0),T=w=>i(!1);r.useEffect(()=>{if(o&&console.log(`WebSocketLogs logAutoScroll: ${d.current} isHovering: ${l}`),d.current&&!l&&!b){const w=Date.now();w-m.current>=500?(o&&console.log("WebSocketLogs auto-scroll to bottom"),m.current=w,s.current?.scrollIntoView({behavior:"smooth",block:"end"})):(o&&console.log("WebSocketLogs auto-scroll skipped to avoid flicker"),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{s.current?.scrollIntoView({behavior:"smooth"}),m.current=Date.now()},1e3))}},[n,d,l,b]);const j=w=>{switch(w.toLowerCase()){case"debug":return"gray";case"info":return"#267fb7";case"notice":return"green";case"warn":return"#e9db18";case"error":return"red";case"fatal":return"#ff0000";case"spawn":return"#ff00d0";default:return"#5c0e91"}},S=w=>w.toLowerCase()==="warn"?"black":"white";return e.jsx("div",{style:{margin:"0px",padding:"0px"},children:e.jsxs("ul",{style:{margin:"0px",padding:"0px"},onMouseEnter:t,onMouseLeave:T,children:[n.map((w,E)=>e.jsxs("li",{style:{wordWrap:"break-word",maxHeight:"200px",overflow:"hidden"},children:[e.jsx("span",{style:{marginRight:"5px",padding:"1px 5px",backgroundColor:j(w.level),color:S(w.level),fontSize:"12px",borderRadius:"3px",textAlign:"center"},children:w.level}),w.time&&e.jsx("span",{style:{marginRight:"3px",color:"#505050"},children:"["+w.time+"]"}),w.name&&e.jsx("span",{style:{marginRight:"3px",color:"#09516d"},children:"["+w.name+"]"}),e.jsx("span",{style:{color:"var(--main-log-color)"},children:w.message})]},E)),e.jsx("div",{ref:s})]})})}const Ir=r.memo(Un);function zn(){const[n,d]=r.useState(localStorage.getItem(te.logFilterLevel)??"info"),[l,i]=r.useState(localStorage.getItem(te.logFilterSearch)??"*"),{online:s,logAutoScroll:m}=r.useContext(xe);return o&&console.log("HomeLogs rendering..."),s?e.jsxs(je,{style:{flex:"1 1 auto"},children:[e.jsxs(De,{children:[e.jsx(Ce,{children:"Logs"}),e.jsxs(Ce,{style:{fontWeight:"normal",fontSize:"12px",marginTop:"2px"},children:['Filter: logger level "',n,'" and search "',l===""?"*":l,'" Scroll: ',m.current?"auto":"manual"]})]}),e.jsx(Ne,{style:{flex:"1 1 auto",overflow:"auto",margin:"0px",padding:"10px",alignItems:"start"},children:e.jsx(Ir,{})})]}):e.jsx(He,{})}const qn=r.memo(zn);function Bn(){const{online:n}=r.useContext(xe);return o&&console.log("HomeBrowserRefresh rendering..."),n?e.jsxs(je,{children:[e.jsx(De,{children:e.jsx(Ce,{children:"Frontend Update"})}),e.jsxs(Ne,{style:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"The frontend has been updated. You are viewing an outdated web UI. Please refresh the page now."}),e.jsx("div",{children:e.jsx(ue,{onClick:()=>window.location.reload(),endIcon:e.jsx(no,{}),style:{marginLeft:"10px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Refresh"})})]})]}):e.jsx(He,{})}const Qn=r.memo(Bn);function Gn({changelog:n}){const{online:d}=r.useContext(xe);return o&&console.log("HomeShowChangelog rendering..."),d?e.jsxs(je,{children:[e.jsx(De,{children:e.jsx(Ce,{children:"Matterbridge Update"})}),e.jsxs(Ne,{style:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Matterbridge has been updated."}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"10px"},children:[e.jsx(ue,{onClick:()=>window.open("https://github.com/Luligu/matterbridge","_blank"),endIcon:e.jsx(yr,{style:{color:"#FFD700"}}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Star"}),e.jsx(ue,{onClick:()=>window.open("https://www.buymeacoffee.com/luligugithub","_blank"),endIcon:e.jsx(zt,{style:{color:"#b6409c"}}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Sponsor"}),e.jsx(ue,{onClick:()=>window.open(n,"_blank"),endIcon:e.jsx(Ut,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Changelog"}),e.jsx(ue,{onClick:()=>window.location.reload(),endIcon:e.jsx(io,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Close"})]})]})]}):e.jsx(He,{})}const Kn=r.memo(Gn);function Jn({matterbridgeInfo:n}){const{mobile:d}=r.useContext(Le);o&&console.log("MatterbridgeInfoTable:",n);const l=["matterbridgeLatestVersion","matterbridgeDevVersion","--matterFileLogger","--fileLogger","--matterLoggerLevel","--loggerLevel","--virtualMode","--bridgeMode","--restartMode","--restartRequired","fixedRestartRequired","--updateRequired","matterMdnsInterface","matterIpv4Address","matterIpv6Address","readOnly","shellyBoard","shellySysUpdate","shellyMainUpdate","matterPort","matterDiscriminator","matterPasscode"],[i,s]=r.useState(!1);return!n||i?null:(o&&console.log("MatterbridgeInfoTable rendering..."),e.jsxs(je,{style:he&&d?{flex:"1 1 300px"}:{flex:"0 1 auto",width:"302px",minWidth:"302px"},children:[e.jsxs(De,{children:[e.jsx(Ce,{children:"Matterbridge info"}),e.jsx(Ze,{close:()=>s(!0)})]}),e.jsx(Ne,{style:he&&d?{flex:"1 1 auto",margin:"0px",padding:"0px",gap:"0px"}:{flex:"1 1 auto",overflow:"auto",margin:"0px",padding:"0px",gap:"0px"},children:e.jsxs("table",{style:{border:"none",borderCollapse:"collapse",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"60%"}})]}),e.jsx("tbody",{style:{border:"none",borderCollapse:"collapse"},children:Object.entries(n).filter(([m,g])=>!l.includes(m)&&g!==null&&g!==void 0&&g!=="").map(([m,g],b)=>e.jsxs("tr",{className:b%2===0?"table-content-even":"table-content-odd",style:{border:"none",borderCollapse:"collapse"},children:[e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap"},children:m.replace("matterbridgeVersion","Matterbridge version").replace("matterbridgeLatestVersion","Matterbridge latest v.").replace("matterbridgeDevVersion","Matterbridge dev v.").replace("frontendVersion","Frontend version").replace("homeDirectory","Home").replace("rootDirectory","Root").replace("matterbridgeDirectory","Storage").replace("matterbridgeCertDirectory","Cert").replace("matterbridgePluginDirectory","Plugins").replace("globalModulesDirectory","Modules").replace("bridgeMode","Bridge mode").replace("restartMode","Restart mode").replace("virtualMode","Virtual mode").replace("profile","Profile").replace("loggerLevel","Logger level").replace("fileLogger","File logger").replace("loggerLevel","Logger level").replace("fileLogger","File logger").replace("matterLoggerLevel","Matter logger level").replace("matterFileLogger","Matter file logger").replace("restartRequired","Restart required").replace("updateRequired","Update required")}),e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:he&&d?typeof g!="string"?g.toString():g:e.jsx(Sr,{value:typeof g!="string"?g.toString():g,maxChars:24})})]},m))})]})})]}))}const Zn=r.memo(Jn);function Yn(){const[n,d]=r.useState(null),[l,i]=r.useState(null),[s,m]=r.useState([]),[g]=r.useState(localStorage.getItem(te.homePagePlugins)!=="false"),[b,t]=r.useState(localStorage.getItem(te.homePageMode)??"devices"),[T,j]=r.useState(""),[S,w]=r.useState(!1),[E,q]=r.useState(!1),[K,A]=r.useState(null),{mobile:f}=r.useContext(Le),{addListener:p,removeListener:u,online:M,sendMessage:k,getUniqueId:P}=r.useContext(xe),O=r.useRef(P());return r.useEffect(()=>{const oe=v=>{o&&console.log("Home received WebSocket Message:",v),v.method==="refresh_required"&&v.response.changed==="settings"&&(o&&console.log(`Home received refresh_required: changed=${v.response.changed} and sending /api/settings request`),A(null),m([]),k({id:O.current,sender:"Home",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),k({id:O.current,sender:"Home",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})),v.method==="/api/settings"&&v.id===O.current&&(o&&console.log("Home received settings:",v.response),d(v.response.systemInformation),i(v.response.matterbridgeInformation),v.response.matterbridgeInformation.matterbridgeVersion&&j(`https://github.com/Luligu/matterbridge/blob/${v.response.matterbridgeInformation.matterbridgeVersion.includes("-dev-")?"dev":"main"}/CHANGELOG.md`),localStorage.getItem(te.frontendVersion)===null&&v.response.matterbridgeInformation.frontendVersion?localStorage.setItem(te.frontendVersion,v.response.matterbridgeInformation.frontendVersion):v.response.matterbridgeInformation.frontendVersion!==localStorage.getItem(te.frontendVersion)&&v.response.matterbridgeInformation.frontendVersion&&(localStorage.setItem(te.frontendVersion,v.response.matterbridgeInformation.frontendVersion),q(!0)),localStorage.getItem(te.matterbridgeVersion)===null?localStorage.setItem(te.matterbridgeVersion,v.response.matterbridgeInformation.matterbridgeVersion):v.response.matterbridgeInformation.matterbridgeVersion!==localStorage.getItem(te.matterbridgeVersion)&&(localStorage.setItem(te.matterbridgeVersion,v.response.matterbridgeInformation.matterbridgeVersion),w(!0)),v.response.matterbridgeInformation.shellyBoard&&(localStorage.getItem(te.homePageMode)||(localStorage.setItem(te.homePageMode,"devices"),t("devices")))),v.method==="/api/plugins"&&v.id===O.current&&(o&&console.log("Home received plugins:",v.response),m(v.response))};return p(oe,O.current),o&&console.log(`Home added WebSocket listener id ${O.current}`),()=>{u(oe),o&&console.log("Home removed WebSocket listener")}},[p,u,k]),r.useEffect(()=>{if(o&&console.log(`Home storeId effect with storeId ${K}`),l?.bridgeMode==="bridge"&&!K&&(o&&console.log("Home storeId effect set storeId to Matterbridge"),A("Matterbridge")),l?.bridgeMode==="childbridge"&&!K&&s){for(const oe of s)if(oe.matter?.id){o&&console.log(`Home storeId effect set storeId to ${oe.matter.id}`),A(oe.matter.id);break}}},[l,s,K]),r.useEffect(()=>{M&&(o&&console.log("Home online effect, sending /api/settings and /api/plugins requests"),k({id:O.current,sender:"Home",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),k({id:O.current,sender:"Home",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[M,k]),o&&console.log("Home rendering..."),!M||!n||!l?e.jsx(He,{}):e.jsxs(ft,{name:"Home",style:he&&f?{alignItems:"center",gap:"10px"}:{flexDirection:"row"},children:[(he&&!f||!he)&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"302px",minWidth:"302px",gap:"20px"},children:[e.jsx(lr,{id:K}),e.jsx(ir,{systemInfo:n,compact:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",gap:he&&f?"10px":"20px"},children:[E&&e.jsx(Qn,{}),S&&e.jsx(Kn,{changelog:T}),he&&f&&e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"10px"},children:[e.jsx(lr,{id:K}),e.jsx(ir,{systemInfo:n,compact:!0}),e.jsx(Zn,{matterbridgeInfo:l})]}),g&&!l.readOnly&&e.jsx(Dn,{}),g&&e.jsx(Hn,{storeId:K,setStoreId:A}),b==="devices"&&e.jsx(Vn,{storeId:K,setStoreId:A}),b==="logs"&&e.jsx(qn,{})]})]})}const Xn=r.memo(Yn),Mt=!1,dr={display:"flex",gap:"2px",justifyContent:"space-evenly",width:"100%",height:"40px"},ei={margin:"0",padding:"0",fontSize:"36px",fontWeight:"medium",color:"var(--primary-color)"},ti={margin:"0",padding:"0",fontSize:"20px",fontWeight:"medium",color:"var(--div-text-color)",textAlign:"center"},pr={margin:"0",padding:"0",paddingBottom:"2px",fontSize:"16px",fontWeight:"medium",color:"var(--div-text-color)",textAlign:"center"},ri={display:"flex",gap:"2px",justifyContent:"center",width:"100%",height:"18px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},oi={margin:"0",padding:"0",fontSize:"12px",fontWeight:"normal",color:"var(--div-text-color)"},ni={display:"flex",justifyContent:"center",width:"100%",height:"52px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},ii={margin:"0",padding:"0",fontSize:"14px",fontWeight:"bold",color:"var(--div-text-color)"},si={display:"flex",gap:"4px",justifyContent:"center",width:"100%",height:"15px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},Et={margin:"0",padding:"0px 4px",borderRadius:"5px",textAlign:"center",fontSize:"12px",fontWeight:"normal",color:"var(--secondary-color)"},li=[256,257,268,269],ai=[266,267],ci=[259,260,261,271,272],di=[256,257,268,269,266,267,259,260,261,272];function X({icon:n,iconColor:d,cluster:l,value:i,unit:s,prefix:m}){return o&&console.log(`Render cluster "${l.clusterName}.${l.attributeName}" value(${typeof i}-${isNaN(i)}) "${i}" unit "${s}"`),m=m??!1,e.jsxs(ae,{sx:dr,children:[n&&r.cloneElement(n,{key:`${l.clusterId}-${l.attributeId}-icon`,sx:{...ei,color:d??"var(--primary-color)"}}),e.jsxs(ae,{sx:{...dr,gap:"4px",alignContent:"center",alignItems:"end",justifyContent:"center"},children:[s&&m===!0&&e.jsx(ge,{sx:pr,children:s},`${l.clusterId}-${l.attributeId}-unit`),e.jsx(ge,{sx:ti,children:i==null||typeof i=="number"&&isNaN(i)||i==="NaN"?"---":i},`${l.clusterId}-${l.attributeId}-value`),s&&m===!1&&e.jsx(ge,{sx:pr,children:s},`${l.clusterId}-${l.attributeId}-unit`)]},`${l.clusterId}-${l.attributeId}-valueunitbox`)]},`${l.clusterId}-${l.attributeId}-box`)}function pi({device:n,endpoint:d,id:l,deviceType:i,clusters:s}){const m=["Unknown","Good","Fair","Moderate","Poor","VeryPoor","Ext.Poor"];let g="";o&&console.log(`Device "${n.name}" endpoint "${d}" id "${l}" deviceType "0x${i.toString(16).padStart(4,"0")}" clusters (${s?.length})`);const b=s.find(t=>t.clusterName==="Descriptor"&&t.attributeName==="tagList")?.attributeLocalValue;if(b){let t="";b.map(T=>{T.label&&(t+=T.label+" ")}),g=t.trim()}if(i===17&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="batVoltage").map(t=>g=`${t.attributeLocalValue} mV`),di.includes(i)&&s.filter(t=>t.clusterName==="LevelControl"&&t.attributeName==="currentLevel").map(t=>g=`Level ${t.attributeValue}`),i===514&&s.filter(t=>t.clusterName==="WindowCovering"&&t.attributeName==="currentPositionLiftPercent100ths").map(t=>g=`Position ${t.attributeLocalValue/100}%`),i===769&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="occupiedHeatingSetpoint").map(t=>g=`Heat ${t.attributeLocalValue/100}Â°C `),i===769&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="occupiedCoolingSetpoint").map(t=>g=g+`Cool ${t.attributeLocalValue/100}Â°C`),i===118&&s.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="coState").map(t=>g=`${t.attributeLocalValue===0?"No CO detected":"CO alarm!"}`),i===1296&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="voltage").map(t=>g=`${t.attributeLocalValue/1e3} V, `),i===1296&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="activeCurrent").map(t=>g=g+`${t.attributeLocalValue/1e3} A, `),i===1296&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="activePower").map(t=>g=g+`${t.attributeLocalValue/1e3} W`),i===39){const t=s.find(j=>j.clusterName==="ModeSelect"&&j.attributeName==="currentMode")?.attributeLocalValue;g=s.find(j=>j.clusterName==="ModeSelect"&&j.attributeName==="supportedModes")?.attributeLocalValue?.find(j=>j.mode===t)?.label||"Unknown"}if(i===116){const t=s.find(j=>j.clusterName==="RvcRunMode"&&j.attributeName==="currentMode")?.attributeLocalValue;g=s.find(j=>j.clusterName==="RvcRunMode"&&j.attributeName==="supportedModes")?.attributeLocalValue?.find(j=>j.mode===t)?.label||"Unknown"}return e.jsxs(je,{style:{margin:"0px",padding:"5px",width:"150px",height:"150px",borderColor:"var(--div-bg-color)",borderRadius:"5px",justifyContent:"space-between"},children:[i===19&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(X,{icon:t.attributeLocalValue===!0?e.jsx(gt,{}):e.jsx(so,{}),iconColor:t.attributeLocalValue===!0?"green":"red",cluster:t,value:t.attributeLocalValue===!0?"Online":"Offline"})),i===17&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="batPercentRemaining").map(t=>e.jsx(X,{icon:e.jsx(Ke,{}),cluster:t,value:t.attributeLocalValue/2,unit:"%"})),i===17&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="wiredCurrentType").map(t=>e.jsx(X,{icon:e.jsx(br,{}),cluster:t,value:t.attributeLocalValue===0?"AC":"DC"})),i===1293&&s.filter(t=>t.clusterName==="DeviceEnergyManagement"&&t.attributeName==="esaState").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Uo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Offline":"Online"})),li.includes(i)&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(X,{icon:e.jsx(lo,{}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),ai.includes(i)&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:zo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),ci.includes(i)&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:qo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),i===115&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Bo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===124&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Qo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===117&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Go,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===123&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(X,{icon:e.jsx(Xt,{}),cluster:t,value:"Oven"})),i===112&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(X,{icon:e.jsx(ao,{}),cluster:t,value:"Fridge"})),i===113&&s.filter(t=>t.clusterName==="TemperatureControl"&&t.attributeName==="selectedTemperatureLevel").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Ko,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===121&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(X,{icon:e.jsx(Xt,{}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===122&&s.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="fanMode").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Jo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===120&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:or,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Cooktop"})),i===119&&s.filter(t=>t.clusterName==="TemperatureControl"&&t.attributeName==="selectedTemperatureLevel").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:or,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===514&&s.filter(t=>t.clusterName==="WindowCovering"&&t.attributeName==="currentPositionLiftPercent100ths").map(t=>e.jsx(X,{icon:e.jsx(co,{}),cluster:t,value:t.attributeLocalValue/100,unit:"%"})),i===769&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="localTemperature").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Zo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:(t.attributeLocalValue??0)/100,unit:"Â°C"})),i===10&&s.filter(t=>t.clusterName==="DoorLock"&&t.attributeName==="lockState").map(t=>e.jsx(X,{icon:t.attributeValue==="1"?e.jsx(po,{}):e.jsx(uo,{}),cluster:t,value:t.attributeValue==="1"?"Locked":"Unlocked"})),i===43&&s.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="percentCurrent").map(t=>e.jsx(X,{icon:e.jsx(go,{}),cluster:t,value:t.attributeValue,unit:"%"})),i===15&&s.filter(t=>t.clusterName==="Switch"&&t.attributeName==="currentPosition").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Yo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeValue,unit:"pos",prefix:!0})),i===39&&s.filter(t=>t.clusterName==="ModeSelect"&&t.attributeName==="currentMode").map(t=>e.jsx(X,{icon:e.jsx(mo,{}),cluster:t,value:t.attributeValue,unit:"Mode",prefix:!0})),i===771&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(X,{icon:e.jsx(ho,{}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),i===45&&s.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="percentCurrent").map(t=>e.jsx(X,{icon:e.jsx(er,{}),cluster:t,value:t.attributeValue,unit:"%"})),i===114&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="localTemperature").map(t=>e.jsx(X,{icon:e.jsx(er,{}),cluster:t,value:(t.attributeLocalValue??0)/100,unit:"Â°C"})),i===67&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(X,{icon:e.jsx(fo,{}),cluster:t,value:t.attributeLocalValue===!0?"Leak":"No leak"})),i===65&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(X,{icon:e.jsx(xo,{}),cluster:t,value:t.attributeLocalValue===!0?"Freeze":"No freeze"})),i===68&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(X,{icon:e.jsx(bo,{}),cluster:t,value:t.attributeLocalValue===!0?"Rain":"No rain"})),i===116&&s.filter(t=>t.clusterName==="RvcRunMode"&&t.attributeName==="currentMode").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:Xo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeValue,unit:"Run mode",prefix:!0})),i===1292&&s.filter(t=>t.clusterName==="EnergyEvse"&&t.attributeName==="state").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:en,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Free":"In use"})),i===1295&&s.filter(t=>t.clusterName==="WaterHeaterManagement"&&t.attributeName==="tankPercentage").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:tn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Tank "+(t.attributeLocalValue??0)+"%"})),i===777&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="featureMap").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:rn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"HeatPump"})),i===23&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="featureMap").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:on,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Solar"})),i===24&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="featureMap").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:nn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Inverter"})),i===118&&s.find(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="featureMap"&&t.attributeLocalValue.smokeAlarm===!0)&&s.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="smokeState").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:nr,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"No smoke":"Smoke!"})),i===118&&s.find(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="featureMap"&&t.attributeLocalValue.smokeAlarm===!1)&&s.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="coState").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:nr,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"No Co":"Co!"})),i===66&&s.filter(t=>t.clusterName==="ValveConfigurationAndControl"&&t.attributeName==="currentState").map(t=>e.jsx(X,{icon:e.jsx(vo,{}),cluster:t,value:t.attributeLocalValue===0?"Closed":"Opened"})),i===44&&s.filter(t=>t.clusterName==="AirQuality"&&t.attributeName==="airQuality").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:sn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:m[t.attributeLocalValue??0]})),i===770&&s.filter(t=>t.clusterName==="TemperatureMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(X,{icon:e.jsx(yo,{}),cluster:t,value:t.attributeLocalValue/100,unit:"Â°C"})),i===775&&s.filter(t=>t.clusterName==="RelativeHumidityMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(X,{icon:e.jsx(pe,{path:ln,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue/100,unit:"%"})),i===774&&s.filter(t=>t.clusterName==="FlowMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(X,{icon:e.jsx(jo,{}),cluster:t,value:t.attributeLocalValue,unit:"l/h"})),i===773&&s.filter(t=>t.clusterName==="PressureMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(X,{icon:e.jsx(Co,{}),cluster:t,value:t.attributeLocalValue,unit:"hPa"})),i===21&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(X,{icon:t.attributeValue==="true"?e.jsx(wo,{}):e.jsx(So,{}),cluster:t,value:t.attributeValue==="true"?"Closed":"Opened"})),i===263&&s.filter(t=>t.clusterName==="OccupancySensing"&&t.attributeName==="occupancy").map(t=>e.jsx(X,{icon:t.attributeValue==="{ occupied: true }"?e.jsx(ko,{}):e.jsx(Io,{}),cluster:t,value:t.attributeValue==="{ occupied: true }"?"Occupied":"Unocc."})),i===262&&s.filter(t=>t.clusterName==="IlluminanceMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(X,{icon:e.jsx(Mo,{}),cluster:t,value:Math.round(Math.pow(10,t.attributeLocalValue/1e4)),unit:"lx"})),i===1296&&s.filter(t=>t.clusterName==="ElectricalEnergyMeasurement"&&t.attributeName==="cumulativeEnergyImported").map(t=>e.jsx(X,{icon:e.jsx(Do,{}),cluster:t,value:Math.round(t.attributeLocalValue?.energy/1e6),unit:"kwh"})),e.jsx(ae,{sx:ri,children:e.jsx(ge,{sx:oi,children:g})}),e.jsx(ae,{sx:ni,children:e.jsx(ge,{sx:ii,children:n.name})}),e.jsxs(ae,{sx:si,children:[o&&e.jsx(ge,{sx:Et,children:d}),e.jsx(ge,{sx:Et,children:l}),o&&e.jsxs(ge,{sx:Et,children:["0x",i.toString(16).padStart(4,"0")]})]})]})}function ui({filter:n}){const{online:d,sendMessage:l,addListener:i,removeListener:s,getUniqueId:m}=r.useContext(xe),[g,b]=r.useState([]),[t,T]=r.useState({}),[j,S]=r.useState({}),[w,E]=r.useState({}),q=r.useRef(m()),K=r.useCallback(p=>{(o||Mt)&&console.log(`DevicesIcons received state_update "${p.response.cluster}.${p.response.attribute}" for "${p.response.id}:${p.response.number}": "${p.response.value}"`,p.response);const u=g.find(k=>k.pluginName===p.response.plugin&&k.serial===p.response.serialNumber);if(!u){(o||Mt)&&console.warn(`DevicesIcons updater device of plugin "${p.response.plugin}" serial "${p.response.serialNumber}" number "${p.response.number}" id "${p.response.id}" not found in devices(${g.length})`);return}const M=w[u.serial]?.find(k=>k.endpoint===p.response.number.toString()&&k.clusterName===p.response.cluster&&k.attributeName===p.response.attribute);if(!M){(o||Mt)&&console.warn(`DevicesIcons updater device "${u.name}" serial "${u.serial}" cluster "${p.response.cluster}" attribute "${p.response.attribute}" not found in clusters(${w[u.serial]?.length})`);return}M.attributeValue=String(p.response.value),M.attributeLocalValue=p.response.value,E({...w}),(o||Mt)&&console.log(`DevicesIcons updated "${M.clusterName}.${M.attributeName}" for device "${u.name}" serial "${u.serial}" to "${M.attributeValue}"`)},[w,g]),A=r.useCallback(p=>{if(o&&console.log(`DevicesIcons received for device "${p.response.deviceName}" serial "${p.response.serialNumber}" deviceTypes (${p.response.deviceTypes.length}) "${p.response.deviceTypes.join(",")}" clusters (${p.response.clusters.length}):`,p.response),p.response.clusters.length===0)return;const u=p.response.serialNumber;t[u]=[],j[u]=p.response.deviceTypes,w[u]=[];for(const M of p.response.clusters)t[u].find(k=>k.endpoint===M.endpoint)||t[u].push({endpoint:M.endpoint,id:M.id,deviceTypes:M.deviceTypes}),!["FixedLabel","Identify","Groups","PowerTopology"].includes(M.clusterName)&&w[u].push(M);T({...t}),S({...j}),E({...w}),o&&console.log(`DevicesIcons endpoints for "${u}":`,t[u]),o&&console.log(`DevicesIcons deviceTypes for "${u}":`,j[u]),o&&console.log(`DevicesIcons clusters for "${u}":`,w[u])},[w,j,t]);r.useEffect(()=>{const p=u=>{if(o&&console.log("DevicesIcons received WebSocket Message:",u),u.method==="refresh_required")o&&console.log(`DevicesIcons received refresh_required: changed=${u.response.changed} and sending api requests`),l({id:q.current,sender:"DevicesIcons",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}});else if(u.method==="state_update"&&u.response)K(u);else if(u.method==="/api/devices"&&u.response){o&&console.log(`DevicesIcons received ${u.response.length} devices:`,u.response),b(u.response),T({}),S({}),E({});for(const M of u.response)o&&console.log("DevicesIcons sending /api/clusters"),l({id:q.current,sender:"DevicesIcons",method:"/api/clusters",src:"Frontend",dst:"Matterbridge",params:{plugin:M.pluginName,endpoint:M.endpoint||0}})}else u.method==="/api/clusters"&&u.response&&A(u)};return i(p,q.current),o&&console.log("DevicesIcons WebSocket effect mounted"),()=>{s(p),o&&console.log("DevicesIcons WebSocket effect unmounted")}},[g]),r.useEffect(()=>(o&&console.log("DevicesIcons useEffect online mounting"),d&&(o&&console.log("DevicesIcons useEffect online sending api requests"),l({id:q.current,sender:"DevicesIcons",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}})),o&&console.log("DevicesIcons useEffect online mounted"),()=>{o&&console.log("DevicesIcons useEffect online unmounted")}),[d,l]);const f=r.memo(pi);return o&&console.log("DevicesIcons rendering..."),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",paddingBottom:"5px",gap:"20px",width:"100%",overflow:"auto"},children:g.filter(p=>p.name.toLowerCase().includes(n)||p.serial.toLowerCase().includes(n)).map(p=>t[p.serial]&&t[p.serial].map(u=>u.deviceTypes.map(M=>e.jsx(f,{device:p,endpoint:u.endpoint,id:u.id,deviceType:M,clusters:w[p.serial].filter(k=>k.endpoint===u.endpoint)},`${p.pluginName}-${p.uniqueId}-${u.endpoint}-${u.id}-${M.toString()}`))))})}const gi=r.memo(ui),mi=[{label:"Plugin name",id:"pluginName",required:!0},{label:"Device type",id:"type"},{label:"Endpoint",id:"endpoint",align:"right"},{label:"Name",id:"name",required:!0},{label:"Serial number",id:"serial"},{label:"Unique ID",id:"uniqueId"},{label:"Url",id:"configUrl"},{label:"Config",id:"configButton",noSort:!0,render:(n,d,l,i)=>l.configUrl?e.jsx(Z,{onClick:()=>window.open(l.configUrl,"_blank"),"aria-label":"Open Config",sx:{margin:0,padding:0},children:e.jsx(vr,{fontSize:"small"})}):null},{label:"Cluster",id:"cluster"}],hi=[{label:"Endpoint",id:"endpoint",required:!0},{label:"Id",id:"id"},{label:"Device Types",id:"deviceTypes",render:(n,d,l,i)=>Array.isArray(n)?e.jsx(e.Fragment,{children:n.map(s=>`0x${s.toString(16).padStart(4,"0")}`).join(", ")}):e.jsx(e.Fragment,{children:n})},{label:"Cluster Name",id:"clusterName",required:!0},{label:"Cluster ID",id:"clusterId"},{label:"Attribute Name",id:"attributeName",required:!0},{label:"Attribute ID",id:"attributeId"},{label:"Attribute Value",id:"attributeValue",required:!0,maxWidth:350,tooltip:!0}],fi=n=>`${n.pluginName}::${n.uniqueId}`,xi=n=>`${n.endpoint}::${n.clusterName}::${n.attributeName}`;function bi({filter:n}){const{online:d,sendMessage:l,addListener:i,removeListener:s,getUniqueId:m}=r.useContext(xe),[g,b]=r.useState([]),[t,T]=r.useState(g),[j,S]=r.useState([]),[w,E]=r.useState(0),[q,K]=r.useState(null),[A,f]=r.useState(null),[p,u]=r.useState(null),[M,k]=r.useState(null),P=r.useRef(m()),O=r.useRef(t),oe=r.useCallback(c=>{o&&console.log(`DevicesTable received state_update "${c.response.cluster}.${c.response.attribute}" for "${c.response.id}:${c.response.number}": "${c.response.value}"`,c.response);const a=O.current.find(x=>x.pluginName===c.response.plugin&&x.uniqueId===c.response.uniqueId);if(!a){o&&console.warn(`DevicesTable updater device of plugin "${c.response.plugin}" serial "${c.response.serialNumber}" not found in filteredDevicesRef.current`);return}if(q&&A&&a.pluginName===q&&a.uniqueId===M&&c.response.number.toString()===A){const x=j.find(I=>I.endpoint===c.response.number.toString()&&I.clusterName===c.response.cluster&&I.attributeName===c.response.attribute);if(!x){o&&console.warn(`DevicesTable updater cluster ${c.response.cluster}.${c.response.attribute} for device "${a.name}" serial "${a.serial}" not found in clusters`);return}x.attributeValue=typeof c.response.value=="object"?JSON.stringify(c.response.value,void 0,1).replaceAll('"',""):String(c.response.value),x.attributeLocalValue=c.response.value,S([...j]),o&&console.log(`DevicesTable updated attribute ${x.clusterName}.${x.attributeName} for device "${a.name}" serial "${a.serial}" to "${x.attributeValue}"`)}},[j,A,q,M]);r.useEffect(()=>{const c=a=>{if(o&&console.log("DevicesTable received WebSocket Message:",a),a.method==="refresh_required"&&a.response.changed==="devices")o&&console.log(`DevicesTable received refresh_required: changed=${a.response.changed} and sending /api/devices request`),l({id:P.current,sender:"DevicesTable",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}});else if(a.method==="state_update"&&a.response)oe(a);else if(a.method==="/api/devices")o&&console.log(`DevicesTable received ${a.response.length} devices:`,a.response),b(a.response);else if(a.method==="/api/clusters"){o&&console.log(`DevicesTable received ${a.response.clusters.length} clusters for plugin ${a.response.plugin}:`,a.response),S(a.response.clusters);const x={};for(const I of a.response.clusters)o&&console.log("Cluster:",I.endpoint),x[I.endpoint]?x[I.endpoint]++:x[I.endpoint]=1;E(Object.keys(x).length)}};return i(c,P.current),o&&console.log("DevicesTable added WebSocket listener"),()=>{s(c),o&&console.log("DevicesTable removed WebSocket listener")}},[l,i,s,oe]),r.useEffect(()=>{d&&(o&&console.log("DevicesTable sending api requests with id ",P.current),l({id:P.current,sender:"DevicesTable",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),l({id:P.current,sender:"DevicesTable",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}),l({id:P.current,sender:"DevicesTable",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}}))},[d,l]),r.useEffect(()=>{q&&A&&(o&&console.log("DevicesTable sending /api/clusters"),l({id:P.current,sender:"DevicesTable",method:"/api/clusters",src:"Frontend",dst:"Matterbridge",params:{plugin:q,endpoint:Number(A)}}))},[q,A,l]),r.useEffect(()=>{if(n===""){T(g),O.current=g;return}const c=g.filter(a=>a.name.toLowerCase().includes(n)||a.serial.toLowerCase().includes(n));T(c),O.current=c},[g,n]);const v=c=>{if(c.uniqueId===M){k(null),K(null),f(null),u(null);return}k(c.uniqueId),K(c.pluginName),f(c.endpoint?c.endpoint.toString():null),u(c.name)};return o&&console.log("DevicesTable rendering..."),d?e.jsxs("div",{style:{display:"flex",flexDirection:"column",margin:"0px",padding:"0px",gap:"20px",width:"100%",overflow:"hidden"},children:[e.jsx(je,{style:{margin:"0px",padding:"0px",gap:"0px",width:"100%",maxHeight:`${q&&A?"30%":"100%"}`,flex:"1 1 auto",overflow:"hidden"},children:e.jsx(Tt,{name:"Registered devices",getRowKey:fi,onRowClick:v,rows:t,columns:mi,footerLeft:`Total devices: ${t.length.toString()}`})}),q&&A&&e.jsx(je,{style:{margin:"0px",padding:"0px",gap:"0px",width:"100%",height:"70%",maxHeight:"70%",flex:"1 1 auto",overflow:"hidden"},children:e.jsx(Tt,{name:"Clusters",title:p||"",getRowKey:xi,rows:j,columns:hi,footerLeft:`Total child endpoints: ${w-1}`})})]}):e.jsx(He,{})}const vi=r.memo(bi);function yi(){const{online:n}=r.useContext(xe),[d,l]=r.useState(""),[i,s]=r.useState("icon");r.useEffect(()=>{const b=localStorage.getItem(te.devicesFilter);b&&l(b)},[]),r.useEffect(()=>{const b=localStorage.getItem(te.devicesViewMode);b&&s(b)},[]);const m=b=>{l(b.target.value.toLowerCase()),localStorage.setItem(te.devicesFilter,b.target.value.toLowerCase())},g=b=>{s(b),localStorage.setItem(te.devicesViewMode,b)};return o&&console.log("Devices rendering..."),n?e.jsxs(ft,{name:"Devices",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",padding:0,margin:0,gap:"20px",width:"100%"},children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(ge,{sx:{fontSize:"16px",fontWeight:"normal",color:"var(--div-text-color)",marginLeft:"5px",whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(fe,{variant:"outlined",value:d,onChange:m,placeholder:"Enter the device name or serial",sx:{width:"260px"},InputProps:{style:{backgroundColor:"var(--main-bg-color)"}}})]}),e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(ge,{sx:{fontSize:"16px",fontWeight:"normal",color:"var(--div-text-color)",marginLeft:"5px",whiteSpace:"nowrap"},children:"View mode:"}),e.jsx(Z,{onClick:()=>g("table"),"aria-label":"Table View",disabled:i==="table",children:e.jsx(H,{title:"Table View",children:e.jsx(Po,{style:{color:i==="table"?"var(--main-icon-color)":"var(--primary-color)"}})})}),e.jsx(Z,{onClick:()=>g("icon"),"aria-label":"Icon View",disabled:i==="icon",children:e.jsx(H,{title:"Icon View (beta)",children:e.jsx(Lo,{style:{color:i==="icon"?"var(--main-icon-color)":"var(--primary-color)"}})})})]})]}),i==="table"&&e.jsx(vi,{filter:d}),i==="icon"&&e.jsx(gi,{filter:d})]}):e.jsx(He,{})}const ji=r.memo(yi);function Ci(){const{logLength:n,logAutoScroll:d,setMessages:l,setLogFilterLevel:i,setLogFilterSearch:s,online:m,filterLogMessages:g}=r.useContext(xe),[b,t]=r.useState(localStorage.getItem(te.logFilterLevel)??"info"),[T,j]=r.useState(localStorage.getItem(te.logFilterSearch)??"*"),[S,w]=r.useState(n.current.toString()),[E,q]=r.useState(d.current),K=M=>{const k=M.target.value;t(k),i(k),g(k,T),localStorage.setItem(te.logFilterLevel,k),o&&console.log("handleLogFilterLevelChange called with value:",k)},A=M=>{const k=M.target.value;j(k),s(k),g(b,k),localStorage.setItem(te.logFilterSearch,k),o&&console.log("handleLogFilterSearchChange called with value:",k)},f=M=>{const k=M.target.checked;q(k),d.current=k,g(b,T),localStorage.setItem(te.logAutoScroll,k?"true":"false"),o&&console.log("handleAutoScrollChange called with value:",k)},p=M=>{const k=M.target.value;w(k),n.current=Number(k),localStorage.setItem(te.logLength,k),o&&console.log("handleLogLengthChange called with value:",k)},u=()=>{o&&console.log("handleClearLogsClick called"),l([])};return o&&console.log("Logs rendering..."),m?e.jsxs(ft,{name:"Logs",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",margin:"0px",padding:"0px",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(Nt,{id:"select-level",style:{color:"var(--div-text-color)"},children:"Filter log by level:"}),e.jsxs(Je,{style:{height:"30px",backgroundColor:"var(--main-bg-color)"},labelId:"select-level",id:"debug-level",value:b,onChange:K,children:[e.jsx(C,{value:"debug",children:"Debug"}),e.jsx(C,{value:"info",children:"Info"}),e.jsx(C,{value:"notice",children:"Notice"}),e.jsx(C,{value:"warn",children:"Warn"}),e.jsx(C,{value:"error",children:"Error"}),e.jsx(C,{value:"fatal",children:"Fatal"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"5px"},children:[e.jsx(Nt,{id:"search",style:{color:"var(--div-text-color)"},children:"Filter log by text:"}),e.jsx(H,{title:"Use /text/ for case-insensitive regex search",children:e.jsx(fe,{style:{width:"210px"},size:"small",id:"logsearch",variant:"outlined",value:T,onChange:A,slotProps:{input:{style:{height:"30px",padding:"0 0px",backgroundColor:"var(--main-bg-color)"}}}})})]}),e.jsx(Ye,{control:e.jsx(qe,{checked:E,onChange:f}),label:"Auto scroll",style:{color:"var(--div-text-color)"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsx(Nt,{id:"select-size-label",style:{color:"var(--div-text-color)"},children:"Log length:"}),e.jsxs(Je,{style:{height:"30px",backgroundColor:"var(--main-bg-color)"},labelId:"select-size-label",id:"select-size",value:S,onChange:p,children:[e.jsx(C,{value:100,children:"100"}),e.jsx(C,{value:200,children:"200"}),e.jsx(C,{value:500,children:"500"}),e.jsx(C,{value:1e3,children:"1000"})]}),e.jsx(H,{title:"Clear the logs",children:e.jsx(ue,{onClick:u,endIcon:e.jsx(At,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Clear"})})]})]}),e.jsx("div",{style:{flex:"1",overflow:"auto",margin:"0px",padding:"0px"},children:e.jsx(Ir,{})})]}):e.jsx(He,{})}const wi=r.memo(Ci),Si=({open:n,ip:d,onClose:l,onSave:i})=>{const s=d?d.split(".").slice(0,3).join(".")+".1":"",[m,g]=r.useState("dhcp"),[b,t]=r.useState({ip:d??"",subnet:"255.255.255.0",gateway:s,dns:s}),T=w=>E=>{t({...b,[w]:E.target.value})},j=()=>{l()},S=()=>{i({type:m,...b}),l()};return e.jsxs(Ee,{open:n,onClose:(w,E)=>{E==="backdropClick"||E==="escapeKeyDown"||l()},maxWidth:"sm",style:{maxWidth:"550px",margin:"auto"},children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:"Network Configuration"})]})}),e.jsxs(Ae,{dividers:!0,children:[e.jsxs(jr,{component:"fieldset",fullWidth:!0,children:[e.jsx(ke,{component:"legend",children:"Select IP Configuration"}),e.jsxs(Cr,{row:!0,value:m,onChange:w=>g(w.target.value),children:[e.jsx(Ye,{value:"dhcp",control:e.jsx(Wt,{}),label:"DHCP"}),e.jsx(Ye,{value:"static",control:e.jsx(Wt,{}),label:"Static"})]})]}),m==="static"&&e.jsxs(Qe,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(Qe,{size:6,children:e.jsx(fe,{label:"IP Address",fullWidth:!0,value:b.ip,onChange:T("ip")})}),e.jsx(Qe,{size:6,children:e.jsx(fe,{label:"Subnet Mask",fullWidth:!0,value:b.subnet,onChange:T("subnet")})}),e.jsx(Qe,{size:6,children:e.jsx(fe,{label:"Gateway",fullWidth:!0,value:b.gateway,onChange:T("gateway")})}),e.jsx(Qe,{size:6,children:e.jsx(fe,{label:"DNS Server",fullWidth:!0,value:b.dns,onChange:T("dns")})})]})]}),e.jsxs(Ge,{children:[e.jsx(ue,{onClick:j,children:"Cancel"}),e.jsx(ue,{variant:"contained",onClick:S,children:"Save"})]})]})},ki=({open:n,onClose:d,onSave:l})=>{const[i,s]=r.useState(""),[m,g]=r.useState(""),b=E=>{s(E.target.value)},t=E=>{g(E.target.value)},T=i.length>0&&i===m,j=()=>{d()},S=()=>{T&&(l(i),d())},w=()=>{l(""),d()};return e.jsxs(Ee,{open:n,onClose:(E,q)=>{q==="backdropClick"||q==="escapeKeyDown"||d()},maxWidth:"sm",style:{maxWidth:"500px",margin:"auto"},disableEscapeKeyDown:!0,children:[e.jsx(Ve,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:"Change Password"})]})}),e.jsx(Ae,{dividers:!0,children:e.jsx(jr,{component:"fieldset",fullWidth:!0,sx:{margin:0,padding:0,gap:"20px"},children:e.jsxs(Qe,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(Qe,{size:12,children:e.jsx(fe,{type:"password",autoComplete:"new-password",label:"New Password",size:"small",variant:"outlined",fullWidth:!0,value:i,onChange:b})}),e.jsx(Qe,{size:12,children:e.jsx(fe,{type:"password",autoComplete:"new-password",label:"Confirm Password",size:"small",variant:"outlined",fullWidth:!0,value:m,onChange:t,error:m!==""&&i!==m,helperText:m!==""&&i!==m?"Passwords do not match":""})})]})})}),e.jsxs(Ge,{children:[e.jsx(ue,{onClick:j,children:"Cancel"}),e.jsx(ue,{variant:"contained",onClick:S,disabled:!T,children:"Change"}),e.jsx(ue,{variant:"contained",onClick:w,children:"Reset"})]})]})};function it(n=1e3){let d=null;const l=(i=>{d!==null&&window.clearTimeout(d),d=window.setTimeout(()=>{i(),d=null},n)});return l.cancel=()=>{d!==null&&(window.clearTimeout(d),d=null)},l}const Ft=330;function Ii(){const{mobile:n}=r.useContext(Le),{online:d,addListener:l,removeListener:i,sendMessage:s,getUniqueId:m}=r.useContext(xe),[g,b]=r.useState(null),[t,T]=r.useState(null),j=r.useRef(m());return r.useEffect(()=>{const S=w=>{o&&console.log("Settings received WebSocket Message:",w),w.method==="refresh_required"&&w.response.changed==="settings"?(o&&console.log(`Settings received refresh_required: changed=${w.response.changed} and sending /api/settings request`),s({id:j.current,sender:"Settings",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):w.method==="/api/settings"&&(o&&console.log("Settings received /api/settings:",w.response),b(w.response.matterbridgeInformation),T(w.response.systemInformation))};return l(S,j.current),o&&console.log("Settings added WebSocket listener"),()=>{i(S),o&&console.log("Settings removed WebSocket listener")}},[l,i,s]),r.useEffect(()=>{d&&(o&&console.log("Settings received online"),s({id:j.current,sender:"Settings",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}))},[d,s]),o&&console.log("Settings rendering..."),!d||!g||!t?e.jsx(He,{}):e.jsx(ft,{name:"Settings",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:he&&n?"10px":"20px"},children:[e.jsx(Mi,{matterbridgeInfo:g,systemInfo:t}),e.jsx(Di,{matterbridgeInfo:g}),e.jsx(Pi,{matterbridgeInfo:g}),e.jsx(Li,{systemInfo:t})]})})}function Mi({matterbridgeInfo:n,systemInfo:d}){const{sendMessage:l,getUniqueId:i}=r.useContext(xe),[s,m]=r.useState("bridge"),[g,b]=r.useState("Info"),[t,T]=r.useState(!1),[j,S]=r.useState("dark"),[w,E]=r.useState(localStorage.getItem(te.homePagePlugins)!=="false"),[q,K]=r.useState(localStorage.getItem(te.homePageMode)??"devices"),[A,f]=r.useState(localStorage.getItem(te.virtualMode)??"outlet"),p=r.useRef(i()),[u,M]=r.useState(!1),k=()=>M(!1),P=_=>{o&&console.log("handleSaveNetConfig called with config:",_),l({id:p.current,sender:"Settings",method:"/api/shellynetconfig",src:"Frontend",dst:"Matterbridge",params:_})},[O,oe]=r.useState(!1),v=()=>oe(!1),c=_=>{o&&console.log("handleSaveChangePassword called with password:",_),l({id:p.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setpassword",value:_}}),Ai(_)};r.useEffect(()=>{n&&(m(n.bridgeMode==="bridge"?"bridge":"childbridge"),b(n.loggerLevel.charAt(0).toUpperCase()+n.loggerLevel.slice(1)),T(n.fileLogger),f(n.virtualMode))},[n]),r.useEffect(()=>{const _=localStorage.getItem(te.frontendTheme);_&&S(_)},[]);const a=_=>{o&&console.log("handleChangeBridgeMode called with value:",_.target.value),m(_.target.value),l({id:p.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setbridgemode",value:_.target.value}})},x=_=>{o&&console.log("handleChangeMbLoggerLevel called with value:",_.target.value),b(_.target.value),l({id:p.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmbloglevel",value:_.target.value}})},I=_=>{o&&console.log("handleLogOnFileMbChange called with value:",_.target.checked),T(_.target.checked),l({id:p.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmblogfile",value:_.target.checked}})},R=_=>{const B=_.target.value;o&&console.log("handleChangeTheme called with value:",B),S(B),localStorage.setItem(te.frontendTheme,B),document.body.setAttribute("frontend-theme",B)},re=_=>{const B=_.target.checked;o&&console.log("handleChangeHomePagePlugins called with value:",B),E(B),localStorage.setItem(te.homePagePlugins,B?"true":"false")},be=_=>{const B=_.target.value;o&&console.log("handleChangeHomePageMode called with value:",B),K(B),localStorage.setItem(te.homePageMode,B)},Ie=_=>{const B=_.target.value;o&&console.log("handleChangeVirtualMode called with value:",B),f(B),localStorage.setItem(te.virtualMode,B),l({id:p.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setvirtualmode",value:B}})};return!n||!d?null:e.jsxs(je,{style:{flex:`1 1 ${Ft}px`},children:[e.jsx(De,{children:e.jsx(Ce,{children:"Matterbridge settings"})}),e.jsx(Si,{open:u,ip:d.ipv4Address,onClose:k,onSave:P}),e.jsx(ki,{open:O,onClose:v,onSave:c}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"0px",backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"matterbridgeInfo-mode",children:"Mode:"}),e.jsxs(Cr,{row:!0,name:"mode-buttons-group",value:s,onChange:a,children:[e.jsx(Ye,{value:"bridge",control:e.jsx(Wt,{}),label:"Bridge",disabled:n.readOnly===!0}),e.jsx(Ye,{value:"childbridge",control:e.jsx(Wt,{}),label:"Childbridge",disabled:n.readOnly===!0})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"mblogger-level-label",children:"Logger level:"}),e.jsxs(Je,{style:{height:"30px"},labelId:"mblogger-level-label",id:"mblogger-level",value:g,onChange:x,children:[e.jsx(C,{value:"Debug",children:"Debug"}),e.jsx(C,{value:"Info",children:"Info"}),e.jsx(C,{value:"Notice",children:"Notice"}),e.jsx(C,{value:"Warn",children:"Warn"}),e.jsx(C,{value:"Error",children:"Error"}),e.jsx(C,{value:"Fatal",children:"Fatal"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"mblogger-file-label",children:"Log on file:"}),e.jsx(qe,{checked:t,onChange:I,id:"mblogger-file",name:"logOnFileMb"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"frontend-theme-label",children:"Frontend theme:"}),e.jsxs(Je,{style:{height:"30px"},labelId:"frontend-theme-label",id:"frontend-theme",value:j,onChange:R,children:[e.jsx(C,{value:"classic",children:"Classic"}),e.jsx(C,{value:"light",children:"Light"}),e.jsx(C,{value:"dark",children:"Dark"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"frontend-home-plugin-label",children:"Home page plugins:"}),e.jsx(qe,{checked:w,onChange:re,name:"showPlugins"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"frontend-home-label",children:"Home page bottom panel:"}),e.jsxs(Je,{style:{height:"30px"},labelId:"frontend-home-label",id:"frontend-home",value:q,onChange:be,children:[e.jsx(C,{value:"logs",children:"Logs"}),e.jsx(C,{value:"devices",children:"Devices"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"10px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"frontend-virtual-label",children:"Virtual devices:"}),e.jsxs(Je,{style:{height:"30px"},labelId:"frontend-virtual-label",id:"frontend-virtual",value:A,onChange:Ie,children:[e.jsx(C,{value:"disabled",children:"Disabled"}),e.jsx(C,{value:"outlet",children:"Outlet"}),e.jsx(C,{value:"light",children:"Light"}),e.jsx(C,{value:"switch",children:"Switch"}),e.jsx(C,{value:"mounted_switch",children:"Mounted Switch"})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"20px"},children:e.jsx(ue,{variant:"contained",color:"primary",onClick:()=>oe(!0),children:"Change password"})}),n.shellyBoard&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"20px"},children:e.jsx(ue,{variant:"contained",color:"primary",onClick:()=>M(!0),children:"Configure IP"})})]})]})}function Di({matterbridgeInfo:n}){const{sendMessage:d,getUniqueId:l}=r.useContext(xe),[i,s]=r.useState("Info"),[m,g]=r.useState(!1),[b,t]=r.useState(""),[T,j]=r.useState(""),[S,w]=r.useState(""),[E,q]=r.useState(""),[K,A]=r.useState(""),[f,p]=r.useState(""),u=r.useRef(l()),M=r.useMemo(()=>it(1e3),[]),k=r.useMemo(()=>it(1e3),[]),P=r.useMemo(()=>it(1e3),[]),O=r.useMemo(()=>it(1e3),[]),oe=r.useMemo(()=>it(1e3),[]),v=r.useMemo(()=>it(1e3),[]);r.useEffect(()=>{n&&(s(["Debug","Info","Notice","Warn","Error","Fatal"][n.matterLoggerLevel]),g(n.matterFileLogger),t(n.matterMdnsInterface||""),j(n.matterIpv4Address||""),w(n.matterIpv6Address||""),q(n.matterPort?n.matterPort.toString():""),A(n.matterDiscriminator?n.matterDiscriminator.toString():""),p(n.matterPasscode?n.matterPasscode.toString():""))},[n]),r.useEffect(()=>()=>M.cancel(),[M]),r.useEffect(()=>()=>k.cancel(),[k]),r.useEffect(()=>()=>P.cancel(),[P]),r.useEffect(()=>()=>O.cancel(),[O]),r.useEffect(()=>()=>oe.cancel(),[oe]),r.useEffect(()=>()=>v.cancel(),[v]);const c=_=>{o&&console.log("handleChangeMjLoggerLevel called with value:",_.target.value),s(_.target.value),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmjloglevel",value:_.target.value}})},a=_=>{o&&console.log("handleLogOnFileMjChange called with value:",_.target.checked),g(_.target.checked),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmjlogfile",value:_.target.checked}})},x=_=>{o&&console.log("handleChangeMdnsInterface called with value:",_.target.value);const B=_.target.value;t(B),M(()=>{o&&console.log("debounced sendMessage setmdnsinterface with value:",B),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmdnsinterface",value:B}})})},I=_=>{o&&console.log("handleChangeIpv4Address called with value:",_.target.value);const B=_.target.value;j(B),k(()=>{o&&console.log("debounced sendMessage setipv4address with value:",B),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setipv4address",value:B}})})},R=_=>{o&&console.log("handleChangeIpv6Address called with value:",_.target.value);const B=_.target.value;w(B),P(()=>{o&&console.log("debounced sendMessage setipv6address with value:",B),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setipv6address",value:B}})})},re=_=>{o&&console.log("handleChangeMatterPort called with value:",_.target.value);const B=_.target.value;q(B),O(()=>{o&&console.log("debounced sendMessage setmatterport with value:",B),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterport",value:B}})})},be=_=>{o&&console.log("handleChangeMatterDiscriminator called with value:",_.target.value);const B=_.target.value;A(B),oe(()=>{o&&console.log("debounced sendMessage setmatterdiscriminator with value:",B),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterdiscriminator",value:B}})})},Ie=_=>{o&&console.log("handleChangemMatterPasscode called with value:",_.target.value);const B=_.target.value;p(B),v(()=>{o&&console.log("debounced sendMessage setmatterpasscode with value:",B),d({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterpasscode",value:B}})})};return n?e.jsxs(je,{style:{flex:`1 1 ${Ft}px`},children:[e.jsx(De,{children:e.jsx(Ce,{children:"Matter settings"})}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"0px",backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"mjlogger-level-label",children:"Logger level:"}),e.jsxs(Je,{style:{height:"30px"},labelId:"mjlogger-level-label",id:"mjlogger-level",value:i,onChange:c,children:[e.jsx(C,{value:"Debug",children:"Debug"}),e.jsx(C,{value:"Info",children:"Info"}),e.jsx(C,{value:"Notice",children:"Notice"}),e.jsx(C,{value:"Warn",children:"Warn"}),e.jsx(C,{value:"Error",children:"Error"}),e.jsx(C,{value:"Fatal",children:"Fatal"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"10px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px"},id:"mjlogger-file-label",children:"Log on file:"}),e.jsx(qe,{checked:m,onChange:a,id:"mjlogger-file",name:"logOnFileMj"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Mdns interface:"}),e.jsx(fe,{value:b,onChange:x,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Ipv4 address:"}),e.jsx(fe,{value:T,onChange:I,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Ipv6 address:"}),e.jsx(fe,{value:S,onChange:R,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning port:"}),e.jsx(fe,{value:E,onChange:re,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning discriminator:"}),e.jsx(fe,{value:K,onChange:be,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(ke,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning passcode:"}),e.jsx(fe,{value:f,onChange:Ie,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]})]})]}):null}function Pi({matterbridgeInfo:n}){return n?e.jsxs(je,{style:{flex:`1 1 ${Ft}px`},children:[e.jsx(De,{children:e.jsx(Ce,{children:"Matterbridge info"})}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"5px"},children:[e.jsx(Pe,{value:n.matterbridgeVersion,label:"Current Version"}),e.jsx(Pe,{value:n.matterbridgeLatestVersion,label:"Latest Version"}),e.jsx(Pe,{value:n.rootDirectory,label:"Root Directory"}),e.jsx(Pe,{value:n.homeDirectory,label:"Home Directory"}),e.jsx(Pe,{value:n.matterbridgeDirectory,label:"Matterbridge Storage Directory"}),e.jsx(Pe,{value:n.matterbridgePluginDirectory,label:"Matterbridge Plugin Directory"}),e.jsx(Pe,{value:n.globalModulesDirectory,label:"Global Module Directory"})]})]}):null}function Li({systemInfo:n}){return n?e.jsxs(je,{style:{flex:`1 1 ${Ft}px`},children:[e.jsx(De,{children:e.jsx(Ce,{children:"System info"})}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"5px"},children:[e.jsx(Pe,{value:n.interfaceName,label:"Interface name"}),e.jsx(Pe,{value:n.macAddress,label:"MAC Address"}),e.jsx(Pe,{value:n.ipv4Address,label:"IPv4 Address"}),e.jsx(Pe,{value:n.ipv6Address,label:"IPv6 Address"}),e.jsx(Pe,{value:n.nodeVersion,label:"Node Version"}),e.jsx(Pe,{value:n.hostname,label:"Hostname"}),e.jsx(Pe,{value:n.user,label:"User"})]})]}):null}function Pe({value:n,label:d,width:l}){return e.jsx(fe,{focused:!0,value:n,size:"small",label:d,variant:"standard",sx:{width:l?`${l-20}px`:"100%","& .MuiInput-underline:before":{borderBottomColor:"var(--main-label-color)",borderBottomWidth:"1px",opacity:.5},"& .MuiInput-underline:hover:not(.Mui-disabled):before":{borderBottomColor:"var(--main-label-color)",borderBottomWidth:"1px",opacity:.5},"& .MuiInput-underline.Mui-focused:after":{borderBottomColor:"var(--main-label-color)",borderBottomWidth:"1px",opacity:.5}},slotProps:{input:{readOnly:!0,sx:{color:"var(--div-text-color)","&:before":{borderBottomColor:"var(--main-label-color)"},"&:after":{borderBottomColor:"var(--main-label-color)"}}},inputLabel:{sx:{marginTop:"3px",color:"var(--main-label-color)","&.Mui-focused":{color:"var(--main-label-color)"}}}}})}const $i=r.memo(Ii);function Wi(){const{online:n,sendMessage:d,addListener:l,removeListener:i,getUniqueId:s}=r.useContext(xe),{showSnackbarMessage:m}=r.useContext(Le),[g,b]=r.useState(null),[t,T]=r.useState([]),[j,S]=r.useState([]),[w,E]=r.useState(null),[q,K]=r.useState({cpuUsage:0}),[A,f]=r.useState({totalMemory:"",freeMemory:"",heapTotal:"",heapUsed:"",external:"",arrayBuffers:"",rss:""}),[p,u]=r.useState({systemUptime:"",processUptime:""}),M=r.useRef(s());return o&&console.log("Test uniqueId:",M),r.useEffect(()=>{o&&console.log("Test useEffect WebSocketMessage mounting");const k=P=>{if(P.method==="restart_required")o&&console.log("Test received restart_required"),m("Restart required",0);else if(P.method==="refresh_required")o&&console.log(`Test received refresh_required: changed=${P.response.changed} and sending api requests`),m("Refresh required",0),d({id:M.current,method:"/api/settings",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}}),d({id:M.current,method:"/api/plugins",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}}),d({id:M.current,method:"/api/devices",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}});else if(P.method==="memory_update")o&&console.log("Test received memory_update",P),f(P.response);else if(P.method==="cpu_update")o&&console.log("Test received cpu_update",P),K(P.response);else if(P.method==="uptime_update")o&&console.log("Test received uptime_update",P),u(P.response);else if(P.method==="/api/settings"&&P.response)o&&console.log("Test received /api/settings:",P.response),m("Test received /api/settings",0),b(P.response);else if(P.method==="/api/plugins"&&P.response)o&&console.log(`Test received ${P.response.length} plugins:`,P.response),m("Test received /api/plugins",0),T(P.response);else if(P.method==="/api/devices"&&P.response){o&&console.log(`Test received ${P.response.length} devices:`,P.response),m("Test received /api/devices",0),S(P.response);for(const O of P.response)o&&console.log("Test sending /api/clusters for device:",O.pluginName,O.name,O.endpoint),d({id:M.current,method:"/api/clusters",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{plugin:O.pluginName,endpoint:O.endpoint||0}})}else P.method==="/api/clusters"&&P.response&&(o&&console.log(`Test received ${P.response.clusters.length} clusters for device ${P.response.deviceName} endpoint ${P.response.id}:${P.response.number}:`,P),m(`Test received /api/clusters for ${P.response.plugin}::${P.response.deviceName}`,0),E(P.response))};return l(k,M.current),o&&console.log("Test useEffect WebSocketMessage mounted"),()=>{o&&console.log("Test useEffect WebSocketMessage unmounting"),i(k),o&&console.log("Test useEffect WebSocketMessage unmounted")}},[l,i,d,m]),r.useEffect(()=>(o&&console.log("Test useEffect online mounting"),n&&o&&console.log("Test useEffect online received online"),o&&console.log("Test useEffect online mounted"),()=>{o&&console.log("Test useEffect online unmounted")}),[n,d,m]),o&&console.log("Test rendering..."),n?e.jsx(ft,{name:"Test",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",alignContent:"center",gap:"20px",height:"100vh",width:"100vw"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"256px",width:"256px",margin:"10px"}}),e.jsx("p",{children:"Welcome to the Test page of the Matterbridge frontend"})]})}):e.jsx(He,{})}const Ti=r.memo(Wi);function Fi(n,d){o&&console.log("getCssVariable:",n,"defaultValue",d);const l=getComputedStyle(document.body).getPropertyValue(n).trim();return l||console.error("getCssVariable: undefined",l),l||d}function Ni(n){return $o({palette:{primary:{main:n},action:{disabled:"var(--main-label-color)"},text:{disabled:"var(--main-label-color)"}},typography:{fontFamily:"Roboto, Helvetica, Arial, sans-serif"},components:{MuiDialog:{styleOverrides:{paper:{color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",border:"2px solid var(--div-border-color)",borderRadius:"var(--div-border-radius)",boxShadow:"2px 2px 5px var(--div-shadow-color)"}}},MuiTooltip:{defaultProps:{placement:"top-start",arrow:!0}},MuiButton:{styleOverrides:{root:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)","&:hover":{backgroundColor:"var(--main-button-bg-color)"},"&.Mui-disabled":{color:"var(--main-button-color)",backgroundColor:"var(--main-grey-color)"}},contained:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},outlined:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},text:{color:"var(--main-button-color)"}},defaultProps:{variant:"contained",size:"small"}},MuiIconButton:{styleOverrides:{root:{color:"var(--main-icon-color)","&:hover .MuiSvgIcon-root":{color:"var(--primary-color)"}}}},MuiCheckbox:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-checked":{color:"var(--primary-color)"}}}},MuiTextField:{defaultProps:{size:"small",variant:"outlined",fullWidth:!0}},MuiOutlinedInput:{styleOverrides:{root:{backgroundColor:"var(--div-bg-color)","& .MuiOutlinedInput-notchedOutline":{borderColor:"var(--main-label-color)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"var(--main-text-color)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"var(--primary-color)"},padding:"0px"},input:{color:"var(--div-text-color)",padding:"4px 8px"}}},MuiInputLabel:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-focused":{color:"var(--primary-color)"}}}},MuiFormLabel:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-focused":{color:"var(--main-label-color)"}}}},MuiFormControl:{styleOverrides:{root:{color:"var(--main-grey-color)"}}},MuiRadio:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-checked":{color:"var(--primary-color)"}}}},MuiSelect:{styleOverrides:{root:{backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)",height:"30px","&:hover":{borderColor:"var(--main-text-color)"},"&.Mui-focused":{borderColor:"var(--primary-color)"}}}},MuiMenu:{styleOverrides:{paper:{backgroundColor:"var(--main-menu-bg-color)",padding:"0px",margin:"0px"},list:{padding:"0px"}}},MuiMenuItem:{styleOverrides:{root:{color:"var(--main-menu-color)",backgroundColor:"var(--main-menu-bg-color)","&:hover":{backgroundColor:"var(--main-menu-hover-color)"},"&.Mui-selected":{color:"var(--main-menu-color)",backgroundColor:"var(--main-menu-bg-color)"},"&.Mui-selected:hover":{backgroundColor:"var(--main-menu-hover-color)"}}}},MuiListItemButton:{styleOverrides:{root:{cursor:"pointer","&:hover":{backgroundColor:"var(--main-bg-color)"}}}},MuiListItemIcon:{styleOverrides:{root:{color:"var(--div-text-color)"}}},MuiListItemText:{styleOverrides:{primary:{fontSize:"16px",fontWeight:"bold",color:"var(--div-text-color)"},secondary:{fontSize:"14px",fontWeight:"normal",color:"var(--div-text-color)"}}}}})}function Ri(){const{mobile:n,showSnackbarMessage:d,showConfirmCancelDialog:l}=r.useContext(Le),{online:i,sendMessage:s,logMessage:m,addListener:g,removeListener:b,getUniqueId:t}=r.useContext(xe),[T,j]=r.useState(!1),[S,w]=r.useState(!1),[E,q]=r.useState(!1),[K,A]=r.useState(!1),[f,p]=r.useState(null),u=r.useRef(t()),[M,k]=r.useState(null),[P,O]=r.useState(null),[oe,v]=r.useState(null),[c,a]=r.useState(null),[x,I]=r.useState(null),R=Or(),re=()=>{window.open("https://www.buymeacoffee.com/luligugithub","_blank")},be=()=>{window.open("https://matterbridge.io/")},Ie=()=>{window.open("https://matterbridge.io/README.html")},_=()=>{window.open("https://matterbridge.io/CHANGELOG.html")},B=()=>{window.open("https://discord.gg/QX58CDe6hd","_blank")},N=()=>{window.open("https://github.com/Luligu/matterbridge","_blank")},Y=()=>{s({id:u.current,sender:"Header",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:"matterbridge",restart:!0}}),q(!1)},F=()=>{s({id:u.current,sender:"Header",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:"matterbridge@dev",restart:!0}}),A(!1)},L=()=>{s({id:u.current,sender:"Header",method:"/api/checkupdates",src:"Frontend",dst:"Matterbridge",params:{}})},$=()=>{o&&console.log("Header: handleShellySystemUpdateClick"),m("Matterbridge","Installing system updates..."),s({id:u.current,sender:"Header",method:"/api/shellysysupdate",src:"Frontend",dst:"Matterbridge",params:{}})},y=()=>{o&&console.log("Header: handleShellyMainUpdateClick"),m("Matterbridge","Installing software updates..."),s({id:u.current,sender:"Header",method:"/api/shellymainupdate",src:"Frontend",dst:"Matterbridge",params:{}})},W=()=>{o&&console.log("Header: handleShellyCreateSystemLog"),s({id:u.current,sender:"Header",method:"/api/shellycreatesystemlog",src:"Frontend",dst:"Matterbridge",params:{}})},Q=()=>{o&&console.log("Header: handleShellyDownloadSystemLog"),m("Matterbridge","Downloading Shelly system log..."),d("Downloading Shelly system log...",5),window.location.href="./api/shellydownloadsystemlog"},ce=()=>{f?.matterbridgeInformation.restartMode===""?s({id:u.current,sender:"Header",method:"/api/restart",src:"Frontend",dst:"Matterbridge",params:{}}):s({id:u.current,sender:"Header",method:"/api/shutdown",src:"Frontend",dst:"Matterbridge",params:{}})},ne=()=>{s({id:u.current,sender:"Header",method:"/api/shutdown",src:"Frontend",dst:"Matterbridge",params:{}})},J=()=>{s({id:u.current,sender:"Header",method:"/api/reboot",src:"Frontend",dst:"Matterbridge",params:{}})},h=()=>{s({id:u.current,sender:"Header",method:"/api/softreset",src:"Frontend",dst:"Matterbridge",params:{}})},ie=()=>{s({id:u.current,sender:"Header",method:"/api/hardreset",src:"Frontend",dst:"Matterbridge",params:{}})},G=U=>{k(U.currentTarget)},D=U=>{o&&console.log("Header: handleMenuClose",U),k(null),U==="/"||U==="/devices"||U==="/log"||U==="/settings"?R(U):U==="reset_frontend"?(m("Matterbridge","Resetting frontend UI..."),d("Resetting frontend UI...",5),vn(),window.location.reload()):U==="download-mblog"?(m("Matterbridge","Downloading matterbridge log..."),d("Downloading matterbridge log...",5),window.location.href="./api/download-mblog"):U==="download-mjlog"?(m("Matterbridge","Downloading matter log..."),d("Downloading matter log...",5),window.location.href="./api/download-mjlog"):U==="view-mblog"?(m("Matterbridge","Loading matterbridge log..."),d("Loading matterbridge log...",5),window.open("./api/view-mblog","_blank","noopener,noreferrer")):U==="view-mjlog"?(m("Matterbridge","Loading matter log..."),d("Loading matter log...",5),window.open("./api/view-mjlog","_blank","noopener,noreferrer")):U==="view-diagnostic"?(m("Matterbridge","Loading diagnostic log..."),d("Loading diagnostic log...",5),window.open("./api/view-diagnostic","_blank","noopener,noreferrer")):U==="download-diagnostic"?(m("Matterbridge","Downloading diagnostic log..."),d("Downloading diagnostic log...",5),window.location.href="./api/download-diagnostic"):U==="view-history"?s({id:u.current,sender:"Header",method:"/api/viewhistorypage",src:"Frontend",dst:"Matterbridge",params:{}}):U==="download-history"?s({id:u.current,sender:"Header",method:"/api/downloadhistorypage",src:"Frontend",dst:"Matterbridge",params:{}}):U==="view-shellylog"?(m("Matterbridge","Loading shelly system log..."),d("Loading shelly system log...",5),window.location.href="./api/shellyviewsystemlog"):U==="download-mbstorage"?(m("Matterbridge","Downloading matterbridge storage..."),d("Downloading matterbridge storage...",5),window.location.href="./api/download-mbstorage"):U==="download-pluginstorage"?(m("Matterbridge","Downloading matterbridge plugins storage..."),d("Downloading matterbridge plugins storage...",5),window.location.href="./api/download-pluginstorage"):U==="download-pluginconfig"?(m("Matterbridge","Downloading matterbridge plugins config..."),d("Downloading matterbridge plugins config...",5),window.location.href="./api/download-pluginconfig"):U==="download-mjstorage"?(m("Matterbridge","Downloading matter storage..."),d("Downloading matter storage...",5),window.location.href="./api/download-mjstorage"):U==="download-backup"?(m("Matterbridge","Downloading backup..."),d("Downloading backup...",10),window.location.href="./api/download-backup"):U==="update"?Y():U==="updatedev"?F():U==="updatecheck"?L():U==="shelly-sys-update"?$():U==="shelly-main-update"?y():U==="shelly-create-system-log"?W():U==="shelly-download-system-log"?Q():U==="softreset"?h():U==="hardreset"?ie():U==="restart"?ce():U==="shutdown"?ne():U==="reboot"?J():U==="create-backup"?s({id:u.current,sender:"Header",method:"/api/create-backup",src:"Frontend",dst:"Matterbridge",params:{}}):U==="unregister"?s({id:u.current,sender:"Header",method:"/api/unregister",src:"Frontend",dst:"Matterbridge",params:{}}):U==="reset"?s({id:u.current,sender:"Header",method:"/api/reset",src:"Frontend",dst:"Matterbridge",params:{}}):U==="factoryreset"&&s({id:u.current,sender:"Header",method:"/api/factoryreset",src:"Frontend",dst:"Matterbridge",params:{}})},ye=U=>{o&&console.log("Header: handleMenuCloseCancel:",U),k(null)},Re=U=>{O(U.currentTarget)},ve=()=>{O(null)},se=U=>{v(U.currentTarget)},de=()=>{v(null)},Oe=U=>{a(U.currentTarget)},Me=()=>{a(null)},dt=U=>{I(U.currentTarget)},V=()=>{I(null)},we=()=>{Hi(),o&&console.log("Matterbridge logo clicked: debug is now",o)};return r.useEffect(()=>{const U=le=>{o&&console.log("Header received WebSocket Message:",le),le.method==="/api/settings"&&le.id===u.current?(o&&console.log("Header received settings:",le.response),p(le.response),j(le.response.matterbridgeInformation.restartRequired||le.response.matterbridgeInformation.fixedRestartRequired),w(le.response.matterbridgeInformation.fixedRestartRequired),q(le.response.matterbridgeInformation.updateRequired)):le.method==="refresh_required"&&le.response.changed==="settings"?(o&&console.log(`Header received refresh_required: changed=${le.response.changed} and sending /api/settings request`),s({id:u.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):le.method==="restart_required"?(o&&console.log(`Header received restart_required with fixed: ${le.response.fixed}`),j(!0),le.response.fixed===!0&&w(!0)):le.method==="restart_not_required"?(o&&console.log("Header received restart_not_required"),j(!1)):le.method==="update_required"?(o&&console.log("Header received update_required"),le.response.devVersion===!0?A(!0):q(!0),s({id:u.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):le.method==="shelly_sys_update"?(o&&console.log("Header received WS_ID_SHELLY_SYS_UPDATE:"),p($e=>$e?{matterbridgeInformation:{...$e.matterbridgeInformation,shellySysUpdate:le.response.available},systemInformation:$e.systemInformation}:null)):le.method==="shelly_main_update"?(o&&console.log("Header received WS_ID_SHELLY_MAIN_UPDATE:"),p($e=>$e?{matterbridgeInformation:{...$e.matterbridgeInformation,shellyMainUpdate:le.response.available},systemInformation:$e.systemInformation}:null)):le.method==="/api/viewhistorypage"&&le.id===u.current&&le.success===!0?(o&&console.log("Header received /api/viewhistorypage success"),window.open("./api/viewhistory","_blank","noopener,noreferrer")):le.method==="/api/downloadhistorypage"&&le.id===u.current&&le.success===!0&&(o&&console.log("Header received /api/downloadhistorypage success"),window.location.href="./api/downloadhistory")};return g(U,u.current),o&&console.log(`Header added WebSocket listener id ${u.current}`),()=>{b(U),o&&console.log("Header removed WebSocket listener")}},[g,b,s,d]),r.useEffect(()=>{i&&(o&&console.log("Header sending /api/settings and /api/checkupdates requests"),s({id:u.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),s({id:u.current,sender:"Header",method:"/api/checkupdates",src:"Frontend",dst:"Matterbridge",params:{}}))},[i,s]),o&&console.log("Header rendering... mobile %s",n),!i||!f?null:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"30px"},onClick:we}),e.jsx("h2",{style:{fontSize:"22px",color:"var(--main-icon-color)",margin:"0px"},children:"Matterbridge"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:e.jsxs("nav",{children:[e.jsx(xt,{to:"/",className:"nav-link",children:"Home"}),e.jsx(xt,{to:"/devices",className:"nav-link",children:"Devices"}),e.jsx(xt,{to:"/log",className:"nav-link",children:"Logs"}),e.jsx(xt,{to:"/settings",className:"nav-link",children:"Settings"})]})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[!f.matterbridgeInformation.readOnly&&e.jsx(H,{title:`Matterbridge v.${f.matterbridgeInformation.matterbridgeVersion}`,children:e.jsxs("span",{className:"status-information",style:{cursor:"default"},children:["v.",f.matterbridgeInformation.matterbridgeVersion.split("-")[0]+(f.matterbridgeInformation.matterbridgeVersion.includes("-dev-")?"@dev":"")+(f.matterbridgeInformation.matterbridgeVersion.includes("-git-")?"@git":"")]})}),f.matterbridgeInformation.shellyBoard&&e.jsx("img",{src:"Shelly.svg",alt:"Shelly Icon",style:{height:"30px",padding:"0px",margin:"0px",marginRight:"30px"}}),f.matterbridgeInformation.bridgeMode!==""&&f.matterbridgeInformation.readOnly===!1?e.jsx(H,{title:"Bridge mode",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:f.matterbridgeInformation.bridgeMode})}):null,f.matterbridgeInformation.restartMode!==""&&f.matterbridgeInformation.readOnly===!1?e.jsx(H,{title:"Restart mode",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:f.matterbridgeInformation.restartMode})}):null,f.matterbridgeInformation.profile&&f.matterbridgeInformation.profile!==""&&f.matterbridgeInformation.readOnly===!1?e.jsx(H,{title:"Current profile",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:f.matterbridgeInformation.profile})}):null,o&&e.jsxs("span",{className:"status-information",style:{cursor:"default"},children:[n?"Mobile ":"Desktop ",`${Lt}x${$t}`,` enabled ${localStorage.getItem(te.enableMobile)!=="false"}`]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"5px"},children:[f.matterbridgeInformation.readOnly===!1?e.jsx(H,{title:"Matterbridge discord group",children:e.jsx("img",{src:"discord.svg",alt:"Discord Logo",style:{cursor:"pointer",height:"25px"},onClick:B})}):null,f.matterbridgeInformation.readOnly===!1?e.jsx(H,{title:"Give a star to Matterbridge",children:e.jsx(Z,{style:{color:"#FFD700",margin:"0",padding:"0"},onClick:N,children:e.jsx(yr,{})})}):null,f.matterbridgeInformation.readOnly===!1?e.jsx(H,{title:"Sponsor Matterbridge",children:e.jsx(Z,{style:{color:"#b6409c",margin:"0",padding:"0"},onClick:re,children:e.jsx(zt,{})})}):null,e.jsx(H,{title:"Matterbridge homepage",children:e.jsx(Z,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:be,children:e.jsx(Wo,{})})}),e.jsx(H,{title:"Matterbridge help",children:e.jsx(Z,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:Ie,children:e.jsx(xr,{})})}),e.jsx(H,{title:"Matterbridge changelog",children:e.jsx(Z,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:_,children:e.jsx(Ut,{})})}),f.matterbridgeInformation&&!f.matterbridgeInformation.readOnly&&E&&e.jsx(H,{title:`Update matterbridge to latest version v.${f.matterbridgeInformation.matterbridgeLatestVersion}`,children:e.jsx(Z,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:Y,children:e.jsx(_e,{})})}),f.matterbridgeInformation&&!f.matterbridgeInformation.readOnly&&K&&e.jsx(H,{title:`Update matterbridge to latest dev version v.${f.matterbridgeInformation.matterbridgeDevVersion}`,children:e.jsx(Z,{style:{color:"var(--secondary-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:F,children:e.jsx(_e,{})})}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&f.matterbridgeInformation.shellySysUpdate&&e.jsx(H,{title:"Shelly system update",children:e.jsx(Z,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:$,children:e.jsx(_e,{})})}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&f.matterbridgeInformation.shellyMainUpdate&&e.jsx(H,{title:"Shelly software update",children:e.jsx(Z,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:y,children:e.jsx(_e,{})})}),e.jsx(H,{title:"Restart matterbridge",children:e.jsx(Z,{style:{color:T||S?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:ce,children:e.jsx(Pt,{})})}),f.matterbridgeInformation.restartMode===""?e.jsx(H,{title:"Shut down matterbridge",children:e.jsx(Z,{style:{color:T||S?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:ne,children:e.jsx(Be,{})})}):null,e.jsx(H,{title:"Download, backup and more",children:e.jsx(Z,{onClick:G,children:e.jsx(To,{style:{color:"var(--main-icon-color)"}})})}),e.jsxs(lt,{id:"command-menu",anchorEl:M,keepMounted:!0,open:!!M,onClose:()=>D(""),children:[he&&n&&e.jsxs(C,{onClick:()=>D("/"),children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Home page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),he&&n&&e.jsxs(C,{onClick:()=>D("/devices"),children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Devices page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),he&&n&&e.jsxs(C,{onClick:()=>D("/log"),children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Logs page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),he&&n&&e.jsxs(C,{onClick:()=>D("/settings"),children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Settings page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&!f.matterbridgeInformation.readOnly&&e.jsxs(C,{onClick:()=>D("update"),children:[e.jsx(z,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Install latest stable",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&!f.matterbridgeInformation.readOnly&&e.jsxs(C,{onClick:()=>D("updatedev"),children:[e.jsx(z,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Install latest dev",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&!f.matterbridgeInformation.readOnly&&e.jsxs(C,{onClick:()=>D("updatecheck"),children:[e.jsx(z,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Check for updates",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&f.matterbridgeInformation.shellySysUpdate&&e.jsxs(C,{onClick:()=>D("shelly-sys-update"),children:[e.jsx(z,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shelly system update",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&f.matterbridgeInformation.shellyMainUpdate&&e.jsxs(C,{onClick:()=>D("shelly-main-update"),children:[e.jsx(z,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shelly software update",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>D("restart"),children:[e.jsx(z,{children:e.jsx(Pt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Restart",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation.restartMode===""?e.jsxs(C,{onClick:()=>D("shutdown"),children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shutdown",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}):null,f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&e.jsxs(C,{onClick:()=>{l("Reboot","Are you sure you want to reboot the Shelly board?","reboot",D,ye)},children:[e.jsx(z,{children:e.jsx(Pt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reboot...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsx(Ct,{}),e.jsxs(C,{onClick:se,children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"View",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(lt,{id:"sub-menu-view",anchorEl:oe,keepMounted:!0,open:!!oe,onClose:de,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(C,{onClick:()=>{Vi(),de(),ye(""),window.open("/home","_self")},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Desktop site",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{Ei(),de(),ye(""),window.open("/home","_self")},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Mobile site",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("view-mblog"),de()},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("view-mjlog"),de()},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matter log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("view-diagnostic"),de()},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge diagnostic log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("view-history"),de()},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge system history",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&e.jsxs(C,{onClick:()=>{D("view-shellylog"),de()},children:[e.jsx(z,{children:e.jsx(Te,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(Ct,{}),e.jsxs(C,{onClick:Oe,children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Download",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(lt,{id:"sub-menu-download",anchorEl:c,keepMounted:!0,open:!!c,onClose:Me,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(C,{onClick:()=>{D("download-mbstorage"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-pluginstorage"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge plugins storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-pluginconfig"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge plugins config",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-mblog"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-mjstorage"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matter storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-mjlog"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matter log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-diagnostic"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge diagnostic log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-history"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge system history",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&e.jsxs(C,{onClick:()=>{D("shelly-create-system-log"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Create Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&e.jsxs(C,{onClick:()=>{D("shelly-download-system-log"),Me()},children:[e.jsx(z,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Download Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(Ct,{}),e.jsxs(C,{onClick:Re,children:[e.jsx(z,{children:e.jsx(Rt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(lt,{id:"sub-menu-backup",anchorEl:P,keepMounted:!0,open:!!P,onClose:ve,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(C,{onClick:()=>{D("create-backup"),ve()},children:[e.jsx(z,{children:e.jsx(Rt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Create backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{D("download-backup"),ve()},children:[e.jsx(z,{children:e.jsx(Rt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Download backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(Ct,{}),e.jsxs(C,{onClick:dt,children:[e.jsx(z,{children:e.jsx(Fo,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(lt,{id:"sub-menu-reset",anchorEl:x,keepMounted:!0,open:!!x,onClose:V,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(C,{onClick:()=>{V(),l("Reset the frontend UI","Are you sure you want to reset the frontend UI? This will reset all local settings and reload the page.","reset_frontend",D,ye)},children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset the frontend UI...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{V(),l("Reset all devices and shutdown","Are you sure you want to unregister all devices? This will temporarily remove all devices from the controller and you may loose the controller configuration.","unregister",D,ye)},children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset all devices...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(C,{onClick:()=>{V(),l("Reset commissioning and shutdown","Are you sure you want to reset the commissioning? You will have to manually remove Matterbridge from the controller.","reset",D,ye)},children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset commissioning...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),!f.matterbridgeInformation.readOnly&&e.jsxs(C,{onClick:()=>{V(),l("Factory reset and shutdown","Are you sure you want to factory reset Matterbridge? You will have to manually remove Matterbridge from the controller.","factoryreset",D,ye)},children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Factory reset...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&e.jsxs(C,{onClick:()=>{V(),l("Network reset","Are you sure you want to factory reset the network parameters?","softreset",D,ye)},children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset network...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),f.matterbridgeInformation&&f.matterbridgeInformation.shellyBoard&&e.jsxs(C,{onClick:()=>{V(),l("Factory reset","Are you sure you want to factory reset Matterbridge? You will have to manually remove Matterbridge from the controller.","hardreset",D,ye)},children:[e.jsx(z,{children:e.jsx(Be,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Factory reset...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]})]})]})]})}const ur=r.memo(Ri),Mr=1200,Dr=900;let Lt,$t;function gr(){if(typeof window<"u"){Lt=Math.floor(window.visualViewport?.width??window.innerWidth),$t=Math.floor(window.visualViewport?.height??window.innerHeight);const n=Lt<Mr||$t<Dr;return o&&console.log("Visual viewport (%s) width %i height %i mobile %s",window.visualViewport!==void 0,Lt,$t,n),n}return!1}function _i({children:n}){const{mobile:d,setMobile:l}=r.useContext(Le),{logAutoScroll:i}=r.useContext(xe);return r.useEffect(()=>{function s(){const m=gr();m&&(i.current=!1,localStorage.setItem(te.logAutoScroll,"false")),l(m)}return window.addEventListener("resize",s),l(gr()),()=>window.removeEventListener("resize",s)},[i,l]),o&&console.log("MbfScreen rendering... mobile %s",d),he&&d?e.jsxs("div",{style:{display:"flex",flexDirection:"column",overflow:"visible",margin:"0px",padding:"10px",gap:"10px"},children:[e.jsx(ur,{}),e.jsx("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",margin:"0px",padding:"0px",gap:"10px"},children:n})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",overflow:"hidden",width:d?`${Mr}px`:"calc(100vw - 40px)",height:d?`${Dr}px`:"calc(100vh - 40px)",margin:"0px",padding:"20px",gap:"20px"},children:[e.jsx(ur,{}),e.jsx("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"calc(100% - 60px)",margin:"0px",padding:"0px",gap:"20px"},children:n})]})}let o=!1;const Hi=()=>{o=!o},Oi=!1;let he=localStorage.getItem(te.enableMobile)!=="false";const Ei=()=>{he=!0,localStorage.setItem(te.enableMobile,"true")},Vi=()=>{he=!1,localStorage.setItem(te.enableMobile,"false")};let ct;const Ai=n=>{ct=n};let ht=!1,mr="/",st="/",Vt="/";function Ui({setLoggedIn:n}){const[d,l]=r.useState(""),[i,s]=r.useState(""),m={display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"var(--main-bg-color)"},g={display:"flex",flexDirection:"column",maxWidth:"400px",margin:"0 auto",padding:"20px",gap:"20px",border:"1px solid var(--div-border-color)",borderRadius:"var(--div-border-radius)",boxShadow:"2px 2px 5px var(--div-shadow-color)",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},b={margin:"10px 0",padding:"3px 3px",fontSize:"14px",width:"230px",border:"1px solid var(--main-label-color)",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},t=async j=>{try{const S=await fetch("./api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:j})});if(S.ok){const{valid:w}=await S.json();w?(n(!0),j!==""&&(ct=j)):j!==""&&s("Incorrect password!")}else console.error("Failed to log in:",S.statusText)}catch(S){console.error("Failed to log in:",S)}},T=j=>{j.preventDefault(),t(d)};return t(""),e.jsx("div",{style:m,children:e.jsxs("form",{onSubmit:T,style:g,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h3",{style:{color:"var(--div-text-color)"},children:"Welcome to Matterbridge"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:"20px"},children:[e.jsx("input",{type:"text",name:"username",autoComplete:"username",style:{display:"none"},tabIndex:-1}),e.jsx("input",{type:"password",value:d,onChange:j=>l(j.target.value),style:b,placeholder:"password",autoComplete:"current-password"}),e.jsx("button",{type:"submit",style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",borderColor:"var(--div-bg-color)"},children:"Log in"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",margin:0,height:"30px"},children:i&&e.jsx("p",{style:{color:"red"},children:i})})]})})}function zi(){const[n,d]=r.useState(!1),l=localStorage.getItem(te.frontendTheme)||"dark";o&&console.log('Setting frontend theme "%s"',l),document.body.setAttribute("frontend-theme",l);const i=Fi("--primary-color","#1976d2");o&&console.log('Primary color from CSS "%s"',i);const s=Ni(i);return mr=window.location.href,st=window.location.pathname,Vt=st.includes("/matterbridge/")?"/matterbridge/":st.includes("/api/hassio_ingress/")?st:"/",ht=st.includes("/api/hassio_ingress/"),console.log("Loading App..."),console.log(`- href = "${mr}"`),console.log(`- pathname = "${st}"`),console.log(`- baseName = "${Vt}"`),console.log(`- isIngress = "${ht}"`),n?e.jsx(No,{theme:s,children:e.jsx(Br,{dense:!0,maxSnack:10,preventDuplicate:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(jn,{children:e.jsx(Cn,{children:e.jsx(Er,{basename:Vt,children:e.jsx(_i,{children:e.jsxs(Vr,{children:[e.jsx(Xe,{path:"/",element:e.jsx(Xn,{})}),e.jsx(Xe,{path:"/devices",element:e.jsx(ji,{})}),e.jsx(Xe,{path:"/log",element:e.jsx(wi,{})}),e.jsx(Xe,{path:"/settings",element:e.jsx($i,{})}),e.jsx(Xe,{path:"/test",element:e.jsx(Ti,{})}),e.jsx(Xe,{path:"*",element:e.jsx(Ar,{to:"/"})})]})})})})})})}):e.jsx(Ui,{setLoggedIn:d})}Ur.createRoot(document.getElementById("root")).render(e.jsx(zr.StrictMode,{children:e.jsx(zi,{})}));
