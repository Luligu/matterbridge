import{B as e,y as o,S as nt,U as br,V as vr,X as qe,Y as yr,Z as jr,I as Cr}from"./vendor_node_modules.js";import{u as wr,S as Sr}from"./vendor_notistack.js";import{D as Ne,a as Le,b as $e,B as ie,c as Oe,d as Z,A as kr,I as K,C as Mr,e as Ir,T as O,f as me,M as Dr,g as Ge,h as L,i as Pe,F as Pr,j as bt,k as Nr,l as Ve,m as Ee,n as se,K as Rt,o as Ht,p as jt,L as it,q as Xe,r as st,s as Q,W as tt,t as at,H as lt,u as ee,V as Ot,v as Vt,w as Lr,E as $r,Q as Zt,R as vt,S as Lt,U as Wr,P as Tr,x as Fr,y as Rr,z as Yt,G as Xt,J as yt,N as Hr,O as er,X as Or,Y as Vr,Z as Er,_ as Et,$ as _r,a0 as Ar,a1 as qr,a2 as zr,a3 as Br,a4 as Ur,a5 as Qr,a6 as _t,a7 as Gr,a8 as Kr,a9 as Jr,aa as Zr,ab as Yr,ac as Xr,ad as eo,ae as to,af as ro,ag as oo,ah as no,ai as io,aj as so,ak as ao,al as lo,am as At,an as Ke,ao as tr,ap as je,aq as rr,ar as Ct,as as He,at as co,au as uo,av as po,aw as Re,ax as Ae,ay as go,az as dt,aA as ct,aB as kt,aC as mo,aD as ho}from"./vendor_mui.js";import{I as te,m as qt,a as fo,b as xo,c as zt,d as bo,e as vo,f as yo,g as jo,h as Co,i as wo,j as So,k as ko,l as Mo,n as Io,o as Do,p as Po,q as Bt,r as No,s as Lo,t as $o,u as Wo,v as To,w as Fo,x as Ro,y as Ho,z as Ut,A as Oo,B as Vo}from"./vendor_mdi.js";import{Q as Eo}from"./vendor_qrcode.js";import{F as _o,v as Ao,e as qo,a as zo,g as Bo,b as Uo,c as Qo,d as Mt,A as Go}from"./vendor_rjsf.js";import"./vendor_lodash.js";import"./vendor_emotion.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const p of a)if(p.type==="childList")for(const h of p.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function l(a){const p={};return a.integrity&&(p.integrity=a.integrity),a.referrerPolicy&&(p.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?p.credentials="include":a.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function i(a){if(a.ep)return;a.ep=!0;const p=l(a);fetch(a.href,p)}})();function Ko({open:n,title:d,message:l,onConfirm:i,onCancel:a}){const p=C=>{r&&console.log("Confirmed"),C.preventDefault(),i()},h=C=>{r&&console.log("Canceled"),C.preventDefault(),a()};return e.jsxs(Ne,{open:n,children:[e.jsx(Le,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:d})]})}),e.jsxs($e,{children:[e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",margin:"0",marginBottom:"20px",maxHeight:"350px",maxWidth:"350px"},children:e.jsx("p",{style:{flex:1,margin:"0"},children:l})}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around"},children:[e.jsx(ie,{onClick:p,variant:"contained",color:"primary",size:"small",children:"Confirm"}),e.jsx(ie,{onClick:h,variant:"contained",color:"primary",size:"small",children:"Cancel"})]})]})]})}const Jo=({open:n,output:d,title:l,_command:i,_packageName:a,onInstall:p,onClose:h})=>{const C=o.useRef(null);return o.useEffect(()=>{r&&console.log(`InstallProgressDialog output effect mounted, scrolling to bottom: ${C.current}`),setTimeout(()=>{r&&console.log("Scrolling to bottom:",C.current),C.current?.scrollIntoView({behavior:"smooth"})},0)},[d]),e.jsxs(Ne,{open:n,onClose:(t,D)=>{D==="backdropClick"||D==="escapeKeyDown"||h()},slotProps:{paper:{sx:{width:"70vw",maxWidth:"70vw",height:"70vw",maxHeight:"70vh",overflow:"hidden"}}},children:[e.jsx(Le,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:l})]})}),e.jsxs($e,{dividers:!0,style:{overflow:"hidden",display:"flex",flexDirection:"column",height:400,paddingBottom:0},children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontSize:"16px",fontWeight:"bold",color:"var(--primary-color)"},children:"Process log"}),e.jsxs("ul",{style:{width:"100%",height:"100%",fontFamily:"monospace",fontSize:"14px",padding:"10px",margin:0,marginBottom:"10px",color:"var(--div-text-color)",background:"var(--div-bg-color)",overflow:"auto",listStyle:"none",boxSizing:"border-box",borderRadius:4,border:"4px solid var(--primary-color)",whiteSpace:"pre-wrap",display:"block"},children:[d.split(`
`).map((t,D)=>e.jsx("li",{style:{padding:0,margin:0,wordBreak:"break-all"},children:t},D)),e.jsx("li",{ref:C,style:{padding:0,margin:0}})]})]}),e.jsxs(Oe,{children:[p&&e.jsx(ie,{variant:"contained",onClick:p,children:"Install"}),e.jsx(ie,{onClick:h,children:"Close"})]})]})},ut=[],_e=o.createContext(null);function Zo({children:n}){const[d,l]=o.useState(!1),[i,a]=o.useState(null),{enqueueSnackbar:p,closeSnackbar:h}=wr(),C=o.useCallback(S=>{r&&console.log(`UiProvider closeSnackbarMessage: message ${S}`);const j=ut.findIndex(M=>M.message===S);j!==-1&&(h(ut[j].key),ut.splice(j,1),r&&console.log(`UiProvider closeSnackbarMessage: message ${S} removed from persistMessages`))},[h]),t=o.useCallback((S,j,M)=>{r&&console.log(`UiProvider showSnackbarMessage: message ${S} timeout ${j}`);const V=p(S,{variant:"default",autoHideDuration:j==null||j>0?(j??5)*1e3:null,persist:j===0,content:B=>e.jsx(Z,{sx:{margin:"0",padding:"0",width:"300px",marginRight:"30px"},children:e.jsx(kr,{severity:M??"info",variant:"filled",sx:{color:"#fff",fontWeight:"normal",width:"100%",cursor:"pointer",padding:"0px 10px"},onClick:()=>h(B),action:e.jsx(K,{size:"small",onClick:()=>h(B),sx:{color:"#fff"},children:e.jsx(Mr,{fontSize:"small"})}),children:S},B)},B)});j===0&&(r&&console.log(`UiProvider showSnackbarMessage: message ${S} timeout ${j} - persist key ${V}`),ut.push({message:S,key:V}))},[p,h]),[D,y]=o.useState(!1),[I,H]=o.useState(""),[P,x]=o.useState(""),[_,E]=o.useState(""),v=o.useRef(null),f=o.useRef(null),b=()=>{r&&console.log(`UiProvider handle confirm action ${_}`),y(!1),v.current&&v.current(_)},R=()=>{r&&console.log(`UiProvider handle cancel action ${_}`),y(!1),f.current&&f.current(_)},N=o.useCallback((S,j,M,V,B)=>{r&&console.log(`UiProvider showConfirmCancelDialog for command ${M}`),H(S),x(j),E(M),v.current=V,f.current=B,y(!0)},[]),[k,A]=o.useState(!1),[T,g]=o.useState(""),[s,c]=o.useState(""),[u,F]=o.useState(""),[pe,be]=o.useState(""),oe=o.useCallback((S,j,M)=>{r&&console.log(`UiProvider show install progress for package ${S}`),g(S),c(j),F(M),A(!0)},[]),ye=o.useCallback(S=>{r&&console.log(`UiProvider addInstallProgress: output ${S}`),be(j=>j+S+`
`)},[]),J=o.useCallback(()=>{r&&console.log(`UiProvider exitInstallProgressSuccess: package ${u}`)},[u]),ne=o.useCallback(()=>{r&&console.log(`UiProvider exitInstallProgressError: package ${u}`)},[u]),$=o.useCallback(()=>{r&&console.log("UiProvider hide install progress"),A(!1)},[]),G=()=>{r&&console.log("UiProvider handle install close action"),A(!1),F(""),be("")},W=o.useMemo(()=>({mobile:d,setMobile:l,currentPage:i,setCurrentPage:a,showSnackbarMessage:t,closeSnackbarMessage:C,closeSnackbar:h,showConfirmCancelDialog:N,showInstallProgress:oe,exitInstallProgressSuccess:J,exitInstallProgressError:ne,hideInstallProgress:$,addInstallProgress:ye}),[d,i,l,a,t,C,h,N,oe,J,ne,$,ye]);return e.jsxs(_e.Provider,{value:W,children:[e.jsx(Ko,{open:D,title:I,message:P,onConfirm:b,onCancel:R}),e.jsx(Jo,{open:k,title:T,_command:s,_packageName:u,output:pe,onClose:G}),n]})}const or=o.createContext(null),fe=o.createContext(null);function Yo({children:n}){const[d,l]=o.useState(localStorage.getItem("logFilterLevel")??"info"),[i,a]=o.useState(localStorage.getItem("logFilterSearch")??"*"),[p,h]=o.useState([]),[C,t]=o.useState(1e3),[D,y]=o.useState(!0),[I,H]=o.useState(!1),{showSnackbarMessage:P,closeSnackbarMessage:x,closeSnackbar:_,showInstallProgress:E,hideInstallProgress:v,exitInstallProgressSuccess:f,exitInstallProgressError:b,addInstallProgress:R}=o.useContext(_e),N=o.useRef([]),k=o.useRef(null),A=o.useRef(1),T=o.useRef(Math.floor(Math.random()*999e3)+1e3),g=o.useRef(null),s=o.useRef(null),c=o.useRef(null),u=o.useRef(d),F=o.useRef(i),pe=o.useRef(0),be=o.useRef(null),oe=o.useMemo(()=>window.location.href.replace(/^http/,"ws"),[]),ye=o.useMemo(()=>window.location.href.includes("api/hassio_ingress"),[]),J=100,ne=60,$=50,G=300,W=10;o.useEffect(()=>(r&&console.log("WebSocket messages started counter interval"),be.current=setInterval(()=>{pe.current>0&&(r&&console.log(`WebSocket messages received in the last ${W} seconds: ${pe.current*(60/W)} messages/minute`),pe.current=0)},W*1e3),()=>{r&&console.log("WebSocket messages stopped counter interval"),be.current&&clearInterval(be.current),be.current=null}),[]),o.useEffect(()=>{u.current=d},[d]),o.useEffect(()=>{F.current=i},[i]);const S=o.useCallback(()=>Math.floor(Math.random()*999e3)+1e3,[]),j=o.useCallback(z=>{if(k.current&&k.current.readyState===WebSocket.OPEN)try{r&&console.log(`WebSocket sending message with id ${z.id}:`,z),z.id===void 0&&(z.id=T.current);const m=JSON.stringify(z);k.current.send(m),r&&console.log("WebSocket sent message:",z)}catch(m){r&&console.error(`WebSocket error sending message: ${m}`)}else r&&console.error("WebSocket message not sent, WebSocket not connected:",z)},[]),M=o.useCallback((z,m)=>{h(he=>[...he,{level:z,time:"",name:"",message:m}])},[]),V=o.useCallback((z,m)=>{l(z),a(m),M("WebSocket",`Filtering by log level "${z}" and log search "${m}"`)},[M]),B=o.useCallback((z,m)=>{r&&console.log(`WebSocket addListener id ${m}:`,z),(m==null||isNaN(m)||m===0)&&console.error("WebSocket addListener called without id, listener not added:",z),N.current=[...N.current,{listener:z,id:m}],r&&console.log("WebSocket addListener total listeners:",N.current.length)},[]),ce=o.useCallback(z=>{r&&console.log("WebSocket removeListener:",z),N.current=N.current.filter(m=>m.listener!==z),r&&console.log("WebSocket removeListener total listeners:",N.current.length)},[]),ae=o.useCallback(()=>{oe===""||oe===null||oe===void 0||(M("WebSocket",`Connecting to WebSocket: ${oe}`),k.current=new WebSocket(oe),k.current.onmessage=z=>{I||H(!0),pe.current+=1;try{const m=JSON.parse(z.data);if(m.id===void 0||m.src===void 0||m.dst===void 0){r&&console.error("WebSocket undefined message id/src/dst:",m);return}if(m.src!=="Matterbridge"||m.dst!=="Frontend"){r&&console.error("WebSocket invalid message src/dst:",m);return}if(m.error){r&&console.error("WebSocket error message response:",m);return}if(m.id===T.current&&m.method==="pong"&&m.response==="pong"){r&&console.log(`WebSocket pong response message id ${m.id}:`,m),s.current&&clearTimeout(s.current),s.current=null;return}else if(m.method==="snackbar"&&m.response&&m.response.message){r&&console.log(`WebSocket message id ${m.id} method ${m.method}:`,m),P(m.response.message,m.response.timeout,m.response.severity);return}else if(m.method==="close_snackbar"&&m.response&&m.response.message){r&&console.log(`WebSocket message id ${m.id} method ${m.method}:`,m),x(m.response.message);return}else if(m.method==="log"){if(!m.response||!m.response.level||!m.response.time||!m.response.name||!m.response.message||(m.response.level==="spawn"&&(m.response.name==="Matterbridge:spawn-init"?E(m.response.message,"",""):m.response.name==="Matterbridge:spawn-exit-success"?f():m.response.name==="Matterbridge:spawn-exit-error"?b():R(m.response.message+`
`)),["debug","info","notice","warn","error","fatal"].includes(m.response.level)&&(u.current==="info"&&m.response.level==="debug"||u.current==="notice"&&(m.response.level==="debug"||m.response.level==="info")||u.current==="warn"&&(m.response.level==="debug"||m.response.level==="info"||m.response.level==="notice")||u.current==="error"&&(m.response.level==="debug"||m.response.level==="info"||m.response.level==="notice"||m.response.level==="warn")||u.current==="fatal"&&(m.response.level==="debug"||m.response.level==="info"||m.response.level==="notice"||m.response.level==="warn"||m.response.level==="error")))||F.current!=="*"&&F.current!==""&&!m.response.message.toLowerCase().includes(F.current.toLowerCase())&&!m.response.name.toLowerCase().includes(F.current.toLowerCase())||m.response.name==="Commissioning"&&m.response.message.includes("is uncommissioned"))return;h(ve=>{const de=[...ve,{level:m.response.level,time:m.response.time,name:m.response.name,message:m.response.message}];return de.length>C*2?de.slice(C):de})}else{if(r&&console.log(`WebSocket received message id ${m.id} method ${m.method}:`,m),m.id===0)N.current.forEach(he=>he.listener(m));else{const he=N.current.find(ve=>ve.id===m.id);he?he.listener(m):console.warn(`WebSocket no listener found for message id ${m.id}:`,m)}return}}catch(m){console.error(`WebSocket error parsing message: ${m}`,m instanceof Error?m.stack:null)}},k.current.onopen=()=>{r&&console.log(`WebSocket: Connected to WebSocket: ${oe}`),M("WebSocket",`Connected to WebSocket: ${oe}`),H(!0),_(),A.current=1,c.current=setTimeout(()=>{g.current=setInterval(()=>{j({id:T.current,method:"ping",src:"Frontend",dst:"Matterbridge",params:{}}),s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{r&&console.error(`WebSocketUse: No pong response received from WebSocket: ${oe}`),M("WebSocket",`No pong response received from WebSocket: ${oe}`),H(!1)},1e3*$)},1e3*ne)},1e3*G)},k.current.onclose=()=>{r&&console.error(`WebSocket: Disconnected from WebSocket ${ye?"with Ingress":""}: ${oe}`),M("WebSocket",`Disconnected from WebSocket: ${oe}`),H(!1),_(),v(),c.current&&clearTimeout(c.current),s.current&&clearTimeout(s.current),g.current&&clearInterval(g.current),M("WebSocket",`Reconnecting (attempt ${A.current} of ${J}) to WebSocket${ye?" (Ingress)":""}: ${oe}`),ye?setTimeout(le,5e3):A.current===1?le():A.current<J?setTimeout(le,1e3*A.current):M("WebSocket",`Reconnect attempts exceeded limit of ${J} retries, refresh the page to reconnect to: ${oe}`),A.current=A.current+1},k.current.onerror=z=>{r&&console.error(`WebSocket: WebSocket error connecting to ${oe}:`,z),M("WebSocket",`WebSocket error connecting to ${oe}`)})},[oe]),le=o.useCallback(()=>{r&&console.log(`WebSocket attemptReconnect ${A.current}/${J} to:`,oe),ae()},[ae]);o.useEffect(()=>(ae(),()=>{k.current&&k.current.readyState===WebSocket.OPEN&&k.current.close()}),[ae]);const ge=o.useMemo(()=>({messages:p,maxMessages:C,autoScroll:D,setMessages:h,setLogFilters:V,setMaxMessages:t,setAutoScroll:y}),[p,h,V]),q=o.useMemo(()=>({maxMessages:C,autoScroll:D,logFilterLevel:d,logFilterSearch:i,setMessages:h,setLogFilters:V,setMaxMessages:t,setAutoScroll:y,online:I,retry:A.current,getUniqueId:S,addListener:B,removeListener:ce,sendMessage:j,logMessage:M}),[C,D,h,V,t,y,I,A.current,B,ce,j,M]);return e.jsx(or.Provider,{value:ge,children:e.jsx(fe.Provider,{value:q,children:n})})}function Xo(n){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 296.2 296.2",...n,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"lg1",x1:"16.6",y1:"16.6",x2:"279.6",y2:"279.6",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#00b48d"}),e.jsx("stop",{offset:".1",stopColor:"#3faa77"}),e.jsx("stop",{offset:".3",stopColor:"#234148"}),e.jsx("stop",{offset:".7",stopColor:"#203b44"}),e.jsx("stop",{offset:".9",stopColor:"#ad2e6e"}),e.jsx("stop",{offset:"1",stopColor:"#c81b74"})]}),e.jsxs("linearGradient",{id:"lg2",x1:"31.1",y1:"31.1",x2:"265.1",y2:"265.1",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#00b48d"}),e.jsx("stop",{offset:".2",stopColor:"#285251"}),e.jsx("stop",{offset:".4",stopColor:"#234148"}),e.jsx("stop",{offset:".8",stopColor:"#203b44"}),e.jsx("stop",{offset:".9",stopColor:"#a8316c"}),e.jsx("stop",{offset:"1",stopColor:"#c81b74"})]}),e.jsxs("linearGradient",{id:"lg3",x1:"116.2",y1:"143.9",x2:"139.8",y2:"143.9",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#8bc751"}),e.jsx("stop",{offset:"1",stopColor:"#0db14b"})]}),e.jsx("linearGradient",{id:"lg4",x1:"136.1",y1:"100.8",x2:"159.6",y2:"100.8",xlinkHref:"#lg3"}),e.jsx("linearGradient",{id:"lg5",x1:"155.3",y1:"143.9",x2:"178.9",y2:"143.9",xlinkHref:"#lg3"}),e.jsxs("linearGradient",{id:"lg6",x1:"46.8",y1:"25.7",x2:"89.6",y2:"74.8",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#b1d34a"}),e.jsx("stop",{offset:"1",stopColor:"#50b848"})]})]}),e.jsx("rect",{width:"296.2",height:"296.2",rx:"56.7",ry:"56.7",style:{fill:"url(#lg1)"}}),e.jsx("rect",{x:"16.3",y:"16.3",width:"263.6",height:"263.6",rx:"50.5",ry:"50.5",style:{fill:"url(#lg2)"}}),e.jsx("circle",{cx:"128",cy:"143.9",r:"11.8",style:{fill:"url(#lg3)"}}),e.jsx("circle",{cx:"147.8",cy:"100.8",r:"11.8",style:{fill:"url(#lg4)"}}),e.jsx("path",{d:"m244.6 114.5.4-.5L160 33a17 17 0 0 0-24.7-.5l-86.4 83.3a15 15 0 0 0 9.2 26.9h19.3v-4.7l-13.7-12.7v-.1l83.7-80.8 84.2 81-13.9 12.8v4.5h19.5a15 15 0 0 0 7.4-28.1Z",style:{fill:"url(#lg3)"}}),e.jsx("circle",{cx:"167.1",cy:"143.9",r:"11.8",style:{fill:"url(#lg5)"}}),e.jsx("path",{fill:"#fff",d:"M219 89.3V35.5a10.5 10.5 0 1 0-21 0v33.7l21 20Z"}),e.jsx("path",{d:"M91.4 73.3H83a37 37 0 0 0-14.5-28.4L65 50.2c.1 0 12.6 9 11.7 25.4-5.3-.4-11.2-1.9-16.3-5.3-11.8-7.8-16-23.7-11.9-46 8.7 1.5 34 7 43 22.8 4.1 7.3 4.1 16.1 0 26.2Z",style:{fill:"url(#lg6)"}}),e.jsx("path",{d:"M65.9 80a49.6 49.6 0 0 0 17.8 2.2l16.6-16c1.6-8.3.5-15.7-3.3-22.4C84.6 22 47.8 17.5 46.2 17.4l-3-.4-.6 3c-3.8 18.4-5.9 50.6 23.2 60ZM48.4 24.4c8.7 1.5 34 7 43 22.8 4.1 7.3 4.1 16.1 0 26.2H83a37 37 0 0 0-14.5-28.4l-3.7 5.3c.1 0 12.6 9 11.7 25.4-5.3-.4-11.2-1.9-16.3-5.3-11.9-7.8-16-23.7-11.9-46Z",fill:"#1e5857"}),e.jsx("path",{fill:"#fff",d:"M250.5 90.5a17.4 17.4 0 1 1 0-34.8 17.4 17.4 0 0 1 0 34.8Zm0-22.7a5.4 5.4 0 0 0 0 10.7 5.3 5.3 0 0 0 0-10.7ZM258.8 148.2a15.9 15.9 0 0 0-9.6 28.5c-.8 4.2-5.4 4.6-5.4 4.6h-26v-43l13.6-13-1.8-2-82.2-79-81.2 78.3-2.5 2.6 13.7 13v42.9H53a21.5 21.5 0 1 0 11.7 15h12.6v18.8c0 7.8 6.4 14.1 14.1 14.1h29.3v14.8H64a10.6 10.6 0 0 0-17.7 8 10.6 10.6 0 0 0 17.6 8h157.6a16.3 16.3 0 1 0 0-16h-84.8V229h66.8c7.8 0 14.2-6.3 14.2-14.1v-19.2h27.6c14.3 0 17.8-12.8 18.5-16.6a15.9 15.9 0 0 0-5-30.9ZM43.7 210.8a10.3 10.3 0 1 1 0-20.6 10.3 10.3 0 0 1 0 20.6Zm192 36a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm-77-34.8h-22v-34h22v34Zm8.4-79.8c2.7 0 5.2 1 7.2 2.5v-10.4L188 137s2.6 1.3 4.6 1.3h6.7v68c0 3.2-2.6 5.7-5.7 5.7h-19v-34h1.4a7.5 7.5 0 0 0 0-15H120a7.5 7.5 0 0 0 0 15h.7v34h-19.3a5.7 5.7 0 0 1-5.7-5.6v-68.1h6.7c2 0 4.6-1.3 4.6-1.3l13.7-12.7v10.4a11.7 11.7 0 0 1 16 1.6v-13a14.9 14.9 0 0 0-25-10.8s-.1.2-.1.2l-.5.5-6.9 7H92.5l55-53.2 55.1 53.2h-11.8l-7-7c0-.2-.2-.3-.4-.5l-.2-.2a14.8 14.8 0 0 0-25 10.9v12.9c2.2-2.5 5.3-4.1 8.9-4.1Zm91.7 36.7a4.9 4.9 0 1 1 0-9.7 4.9 4.9 0 0 1 0 9.7Z"})]})}function Me(){const{retry:n}=o.useContext(fe),d=()=>{window.location.reload()};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center",fontSize:"20px",color:"var(--main-text-color)",backgroundColor:"var(--main-bg-color)"},children:[e.jsx(Xo,{style:{height:"128px",width:"128px",margin:"10px",marginBottom:"20px"}}),n<100?e.jsxs(e.Fragment,{children:[e.jsx(Ir,{style:{color:"var(--primary-color)"}}),e.jsx("div",{style:{marginTop:"20px",color:"var(--primary-color)",textAlign:"center"},children:e.jsxs("span",{children:["Reconnecting to Matterbridge ","(attempt "+n+")","..."]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginTop:"20px",color:"var(--primary-color)",textAlign:"center"},children:[e.jsx("span",{children:"Unable to connect to Matterbridge after multiple attempts."}),e.jsx("br",{}),e.jsx("span",{children:"Please check your network connection."}),e.jsx("br",{})]}),e.jsx(ie,{variant:"contained",color:"primary",onClick:d,style:{marginTop:"20px"},children:"Refresh the Page"})]})]})}function en({value:n,maxChars:d}){let l=n;if(n.length>d&&d>3){const i=d-3,a=n.substring(0,Math.ceil(i/2)),p=n.substring(n.length-Math.floor(i/2),n.length);l=`${a} … ${p}`}return n!==l?e.jsx(O,{title:n,placement:"top",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[0,12]}}]}},children:e.jsx("span",{children:l})}):e.jsx("span",{children:l})}function ke({children:n,style:d}){const l={display:"flex",flexDirection:"column",flex:"0 0 auto",width:"100%",overflow:"hidden",margin:"0px",padding:"0px",gap:"0px",backgroundColor:"var(--div-bg-color)",boxShadow:"5px 5px 10px var(--div-shadow-color)",border:"1px solid var(--table-border-color)",borderRadius:"var(--div-border-radius)",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...d},children:n})}function Je({children:n,style:d}){const l={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"30px",borderBottom:"1px solid var(--table-border-color)",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",margin:"0px",padding:"0px",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...d},children:n})}function Ze({children:n,style:d}){const l={color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",fontSize:"16px",fontWeight:"bold",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...d},children:n})}function pt({children:n,style:d}){const l={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"30px",color:"var(--footer-text-color)",backgroundColor:"var(--footer-bg-color)",margin:"0px",padding:"0px",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...d},children:n})}function gt({children:n,style:d}){const l={color:"var(--footer-text-color)",backgroundColor:"var(--footer-bg-color)",fontSize:"14px",fontWeight:"bold",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...d},children:n})}function et({children:n,style:d}){const l={color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",fontSize:"14px",fontWeight:"normal",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...d},children:n})}function rt({children:n,style:d,onClose:l}){const i={display:"flex",flexDirection:"row",margin:"0px",padding:"0px",paddingRight:"10px",gap:"10px"};return e.jsxs("div",{style:{...i,...d},children:[n,bi]})}function tn({systemInfo:n,compact:d}){const{addListener:l,removeListener:i,getUniqueId:a}=o.useContext(fe),[p,h]=o.useState(n),C=o.useRef(a());if(r&&console.log("SystemInfoTable loading with systemInfo:",p,"compact:",d),n&&d&&p.totalMemory&&p.freeMemory){const P=p.totalMemory,x=p.freeMemory;p.freeMemory=`${x} / ${P}`,p.totalMemory=""}if(n&&d&&p.heapTotal&&p.heapUsed){const P=p.heapTotal,x=p.heapUsed;p.heapUsed=`${x} / ${P}`,p.heapTotal=""}if(n&&d&&p.osRelease&&p.osType){const P=p.osType,x=p.osRelease;p.osType=`${P} (${x})`,p.osRelease=""}if(n&&d&&p.osArch&&p.osPlatform){const P=p.osPlatform,x=p.osArch;p.osPlatform=`${P} (${x})`,p.osArch=""}const t=(P,x,_,E,v)=>{h(f=>({...f,totalMemory:P,freeMemory:x,heapTotal:_,heapUsed:E,rss:v}))},D=P=>{h(x=>({...x,cpuUsage:P.toFixed(2)+" %"}))},y=(P,x)=>{h(_=>({..._,systemUptime:P,processUptime:x}))};o.useEffect(()=>{const P=x=>{r&&console.log("SystemInfoTable received WebSocket Message:",x),x.method==="memory_update"&&x.response&&x.response.totalMemory&&x.response.freeMemory&&x.response.heapTotal&&x.response.heapUsed&&x.response.rss?(r&&console.log("SystemInfoTable received memory_update",x),t(x.response.totalMemory,x.response.freeMemory,x.response.heapTotal,x.response.heapUsed,x.response.rss)):x.method==="cpu_update"&&x.response&&x.response.cpuUsage?(r&&console.log("SystemInfoTable received cpu_update",x),D(x.response.cpuUsage)):x.method==="uptime_update"&&x.response&&x.response.systemUptime&&x.response.processUptime&&(r&&console.log("SystemInfoTable received uptime_update",x),y(x.response.systemUptime,x.response.processUptime))};return l(P,C.current),r&&console.log(`SystemInfoTable added WebSocket listener id ${C.current}`),()=>{i(P),r&&console.log("SystemInfoTable removed WebSocket listener")}},[l,i]);const[I,H]=o.useState(!1);return!p||I?null:(r&&console.log("SystemInfoTable rendering..."),e.jsxs(ke,{style:{flex:"0 1 auto",width:"302px",minWidth:"302px"},children:[e.jsxs(Je,{children:[e.jsx(Ze,{children:"System Information"}),e.jsx(rt,{onClose:()=>H(!0)})]}),e.jsx("div",{className:"MbfWindowDivTable",children:e.jsx("table",{style:{border:"none",borderCollapse:"collapse"},children:e.jsx("tbody",{style:{border:"none",borderCollapse:"collapse"},children:Object.entries(p).filter(([P,x])=>x!==void 0&&x!=="").map(([P,x],_)=>e.jsxs("tr",{className:_%2===0?"table-content-even":"table-content-odd",style:{border:"none",borderCollapse:"collapse"},children:[e.jsx("td",{style:{border:"none",borderCollapse:"collapse"},children:P}),e.jsx("td",{style:{border:"none",borderCollapse:"collapse"},children:e.jsx(en,{value:typeof x!="string"?x.toString():x,maxChars:24})})]},P))})})})]}))}const rn=o.memo(tn),Qt={margin:"0px",padding:"0px",color:"var(--div-text-color)",transition:"color 0.2s ease","& svg":{display:"block"},"& svg path":{fill:"var(--div-text-color)",transition:"fill 0.2s ease"},"&:hover":{color:"var(--primary-color)"},"&:hover svg path":{fill:"var(--primary-color)"},"&:focus-visible":{outline:"2px solid var(--primary-color)",outlineOffset:"2px"}},on=n=>{if(!n)return"";const d=n.toString().replace(/[^0-9]/g,"");if(d.length<5)return d;const l=d.slice(0,4),i=d.slice(4,7),a=d.slice(7,11);return[l,i,a].filter(Boolean).join("-")};function nn({id:n}){const{online:d,sendMessage:l,addListener:i,removeListener:a,getUniqueId:p}=o.useContext(fe),[h,C]=o.useState(null),t=o.useRef(null),D=o.useRef(null),y=o.useRef(p()),{showConfirmCancelDialog:I}=o.useContext(_e);r&&console.log(`QRDiv loading with id = "${n}" storeId = "${t.current}" timeout = ${D.current} and  matter:`,h),o.useEffect(()=>{r&&console.log(`QRDiv id effect "${n}"`),t.current=n,D.current&&clearTimeout(D.current),D.current=null,n?(r&&console.log(`QRDiv id effect sending data request for storeId "${n}"`),l({id:y.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:n,server:!0}})):(r&&console.log("QRDiv id effect setting matter to null"),C(null))},[n,l]),o.useEffect(()=>{const v=f=>{r&&console.log("QRDiv received WebSocket Message:",f),f.method==="refresh_required"&&f.response.changed==="matter"&&f.response.matter&&(r&&console.log(`QRDiv received refresh_required: changed=${f.response.changed} for storeId "${f.response.matter.id}":`,f.response.matter),t.current===f.response.matter.id&&(r&&console.log(`QRDiv received refresh_required/matter: setting matter data for storeId "${f.response.matter.id}":`,f.response.matter),D.current&&clearTimeout(D.current),f.response.matter.advertising&&f.response.matter.advertiseTime&&f.response.matter.advertiseTime+9e5<=Date.now()&&(f.response.matter.advertising=!1),C(f.response.matter),f.response.matter.advertising&&(r&&console.log(`QRDiv setting matter advertise timeout for storeId "${f.response.matter.id}":`,f.response.matter.advertiseTime+9e5-Date.now()),D.current=setTimeout(()=>{D.current&&clearTimeout(D.current),r&&console.log(`QRDiv clearing advertising state for storeId "${t.current}" after 15 minutes`),C(b=>b&&{...b,advertising:!1})},f.response.matter.advertiseTime+9e5-Date.now()))))};return i(v,y.current),r&&console.log("QRDiv webSocket effect mounted"),()=>{a(v),D.current&&clearTimeout(D.current),D.current=null,r&&console.log("QRDiv webSocket effect unmounted")}},[i,a]);const H=()=>{r&&console.log(`QRDiv sent matter startCommission for node "${h?.id}"`),h&&l({id:y.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:h.id,startCommission:!0}})},P=()=>{r&&console.log(`QRDiv sent matter stopCommission for node "${h?.id}"`),h&&l({id:y.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:h.id,stopCommission:!0}})},x=()=>{r&&console.log(`QRDiv sent matter advertise for node "${h?.id}"`),h&&l({id:y.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:h.id,advertise:!0}})},_=v=>{r&&console.log(`QRDiv sent matter removeFabric for node "${h?.id}" and fabricIndex ${v}`),h&&l({id:y.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:h.id,removeFabric:v}})},E=async()=>{if(!h||!h.manualPairingCode)return;const v=h.manualPairingCode.toString();try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(v);else{const f=document.createElement("textarea");f.value=v,f.style.position="fixed",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}r&&console.log("Manual pairing code copied to clipboard")}catch(f){console.error("Failed to copy manual pairing code",f)}};return!h||!d?(r&&console.log("QRDiv rendering undefined state"),null):h.online?h.advertising&&h.qrPairingCode&&h.manualPairingCode?(r&&console.log("QRDiv rendering advertising state"),e.jsxs(ke,{style:{alignItems:"center",minWidth:"302px"},children:[e.jsxs(Je,{children:[e.jsx(Ze,{children:"QR pairing code"}),e.jsxs(rt,{children:[e.jsx(K,{"aria-label":"send advertising",size:"small",onClick:x,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(O,{title:"Send again the mDNS advertisement",arrow:!0,children:e.jsx(te,{path:qt,size:"22px"})})}),e.jsx(K,{"aria-label":"stop pairing",size:"small",onClick:P,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(O,{title:"Turn off pairing",arrow:!0,children:e.jsx(te,{path:fo,size:"22px"})})})]})]}),e.jsx(et,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(Eo,{value:h.qrPairingCode,size:256,level:"M",fgColor:"var(--div-text-color)",bgColor:"var(--div-bg-color)",style:{margin:"20px"}}),e.jsxs(pt,{style:{justifyContent:"space-between"},children:[e.jsxs(gt,{style:{fontWeight:"normal",color:"var(--div-text-color)"},children:["Manual pairing code: ",on(h.manualPairingCode)]}),e.jsx(rt,{children:e.jsx(O,{title:"Copy manual pairing code",arrow:!0,children:e.jsx(K,{"aria-label":"copy manual pairing code",size:"small",onClick:E,sx:Qt,children:e.jsx(te,{path:xo,size:.85})})})})]})]})):h.commissioned&&h.fabricInformations&&h.sessionInformations?(r&&console.log("QRDiv rendering commissioned state"),e.jsxs(ke,{style:{alignItems:"center",minWidth:"302px",overflow:"hidden"},children:[e.jsxs(Je,{children:[e.jsx(Ze,{children:"Paired fabrics"}),e.jsxs(rt,{children:[e.jsx(K,{"aria-label":"send advertising",size:"small",onClick:x,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(O,{title:"Send again the mDNS advertisement",arrow:!0,children:e.jsx(te,{path:qt,size:"22px"})})}),e.jsx(K,{"aria-label":"start pairing",size:"small",onClick:H,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(O,{title:"Turn on pairing",arrow:!0,children:e.jsx(te,{path:zt,size:"22px"})})})]})]}),e.jsx(et,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx("div",{className:"MbfWindowBodyColumn",style:{paddingTop:"0px"},children:h.fabricInformations.map((v,f)=>e.jsxs("div",{style:{margin:"0px",padding:"10px",gap:"0px",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",textAlign:"left",fontSize:"14px"},children:[e.jsxs("div",{style:{marginLeft:"20px",marginBottom:"10px",display:"flex",flexDirection:"row",justifyContent:"space-between",gap:"20px",alignItems:"center"},children:[e.jsxs("p",{className:"status-blue",style:{margin:"0px",padding:"3px 10px",width:"200px",fontSize:"14px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},children:["Fabric: ",v.fabricIndex]}),e.jsx(O,{title:"Remove the fabric. You will also need to remove it from the controller.",arrow:!0,children:e.jsx(K,{"aria-label":"remove the fabric",size:"small",onClick:()=>I("Remove fabric","Are you sure you want to remove this fabric? You will also need to remove it from the controller.","RemoveFabric",()=>_(v.fabricIndex),()=>{}),sx:{...Qt,padding:"2px"},children:e.jsx(te,{path:bo,size:1})})})]}),e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Vendor: ",v.rootVendorId," ",v.rootVendorName]}),v.label!==""&&e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Label: ",v.label]}),e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Sessions: ",h.sessionInformations?h.sessionInformations.filter(b=>b.fabric?.fabricIndex===v.fabricIndex&&b.isPeerActive===!0).length:"0"," ","subscriptions: ",h.sessionInformations?h.sessionInformations.filter(b=>b.fabric?.fabricIndex===v.fabricIndex&&b.isPeerActive===!0&&b.numberOfActiveSubscriptions>0).length:"0"]})]},f))}),e.jsx(pt,{style:{justifyContent:"center"},children:e.jsxs(gt,{style:{fontWeight:"normal"},children:["Serial number: ",h.serialNumber]})})]})):!h.commissioned&&!h.advertising?(r&&console.log("QRDiv rendering not commissioned and not advertising state"),e.jsxs(ke,{style:{alignItems:"center",minWidth:"302px"},children:[e.jsx(Je,{children:e.jsx(Ze,{children:"QR pairing code"})}),e.jsx(et,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(ie,{onClick:H,endIcon:e.jsx(te,{path:zt,size:1}),style:{margin:"20px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:"Turn on pairing"}),e.jsx(pt,{style:{justifyContent:"center"},children:e.jsxs(gt,{style:{fontWeight:"normal"},children:["Serial number: ",h.serialNumber]})})]})):(r&&console.log("QRDiv rendering unknown state"),null):(r&&console.log("QRDiv rendering offline state"),e.jsxs(ke,{style:{alignItems:"center",minWidth:"302px"},children:[e.jsx(Je,{style:{height:"30px",justifyContent:"space-between"},children:e.jsx(Ze,{children:"Server node"})}),e.jsx(et,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:t.current}),e.jsx(et,{style:{fontWeight:"bold"},children:"Server offline"}),e.jsx(pt,{style:{justifyContent:"center"},children:e.jsxs(gt,{style:{fontWeight:"normal"},children:["Serial number: ",h.serialNumber]})})]}))}const sn=o.memo(nn);function an(){const{logMessage:n,sendMessage:d,getUniqueId:l}=o.useContext(fe),[i,a]=o.useState("matterbridge-"),[p,h]=o.useState(!1),[C,t]=o.useState(null),D=o.useRef(l()),y=T=>{T.preventDefault(),h(!0)},I=()=>{h(!1)},H=T=>{T.preventDefault(),h(!1);const g=T.dataTransfer.files[0];if(g){n("Plugins",`Installing package ${g.name}. Please wait...`);const s=new FormData;s.append("file",g),s.append("filename",g.name),fetch("./api/uploadpackage",{method:"POST",body:s}).then(c=>c.text()).then(c=>{n("Plugins",`Server response: ${c}`)}).catch(c=>{console.error("Error uploading plugin file:",c),n("Plugins",`Error installing package ${c}`)})}},P=T=>{const g=T.target.files&&T.target.files[0];if(g){n("Plugins",`Uploading package ${g.name}`);const s=new FormData;s.append("file",g),s.append("filename",g.name),fetch("./api/uploadpackage",{method:"POST",body:s}).then(c=>c.text()).then(c=>{n("Plugins",`Server response: ${c}`)}).catch(c=>{console.error("Error uploading plugin file:",c),n("Plugins",`Error uploading package ${c}`)})}},x=()=>{d({id:D.current,sender:"InstallPlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:i,restart:!1}})},_=()=>{document.getElementById("file-upload")?.click()},E=()=>{d({id:D.current,sender:"InstallPlugins",method:"/api/addplugin",src:"Frontend",dst:"Matterbridge",params:{pluginNameOrPath:i}})},v=T=>{T.preventDefault(),d({id:D.current,sender:"InstallPlugins",method:"/api/uninstall",src:"Frontend",dst:"Matterbridge",params:{packageName:i}})},f=T=>{T.preventDefault(),console.log("Right-clicked Upload button")},b=T=>{T.preventDefault(),console.log("Right-clicked Add button")},R=T=>{t(T.currentTarget)},N=T=>{T!==""&&a(T),t(null)},[k,A]=o.useState(!1);return r&&console.log("HomeInstallAddPlugins rendering..."),k?null:e.jsxs(ke,{children:[e.jsxs(Je,{children:[e.jsx(Ze,{children:"Install plugins"}),e.jsx(rt,{onClose:()=>A(!0)})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flex:"1 1 auto",alignItems:"center",justifyContent:"space-between",margin:"0px",padding:"10px",gap:"20px"},onDragOver:y,onDragLeave:I,onDrop:H,children:[e.jsx(me,{value:i,onChange:T=>{a(T.target.value)},size:"small",id:"plugin-name",label:"Plugin name or plugin path",variant:"outlined",fullWidth:!0}),e.jsx(K,{onClick:R,children:e.jsx(Dr,{})}),e.jsxs(Ge,{id:"simple-menu",anchorEl:C,keepMounted:!0,open:!!C,onClose:()=>N(""),children:[e.jsx(L,{onClick:()=>N("matterbridge-zigbee2mqtt"),children:"matterbridge-zigbee2mqtt"}),e.jsx(L,{onClick:()=>N("matterbridge-somfy-tahoma"),children:"matterbridge-somfy-tahoma"}),e.jsx(L,{onClick:()=>N("matterbridge-shelly"),children:"matterbridge-shelly"}),e.jsx(L,{onClick:()=>N("matterbridge-hass"),children:"matterbridge-hass"}),e.jsx(L,{onClick:()=>N("matterbridge-webhooks"),children:"matterbridge-webhooks"}),e.jsx(L,{onClick:()=>N("matterbridge-bthome"),children:"matterbridge-bthome"}),e.jsx(L,{onClick:()=>N("matterbridge-test"),children:"matterbridge-test"}),e.jsx(L,{onClick:()=>N("matterbridge-example-accessory-platform"),children:"matterbridge-example-accessory-platform"}),e.jsx(L,{onClick:()=>N("matterbridge-example-dynamic-platform"),children:"matterbridge-example-dynamic-platform"}),e.jsx(L,{onClick:()=>N("matterbridge-eve-door"),children:"matterbridge-eve-door"}),e.jsx(L,{onClick:()=>N("matterbridge-eve-motion"),children:"matterbridge-eve-motion"}),e.jsx(L,{onClick:()=>N("matterbridge-eve-energy"),children:"matterbridge-eve-energy"}),e.jsx(L,{onClick:()=>N("matterbridge-eve-weather"),children:"matterbridge-eve-weather"}),e.jsx(L,{onClick:()=>N("matterbridge-eve-room"),children:"matterbridge-eve-room"})]}),e.jsx(O,{title:"Install or update a plugin from npm",children:e.jsxs(ie,{onClick:x,onContextMenu:v,endIcon:e.jsx(Pe,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Install"]})}),e.jsx(O,{title:"Upload and install a plugin from a tarball",children:e.jsxs(ie,{onClick:_,onContextMenu:f,endIcon:e.jsx(Pr,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Upload"]})}),e.jsx(O,{title:"Add an installed plugin",children:e.jsxs(ie,{onClick:E,onContextMenu:b,endIcon:e.jsx(bt,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Add"]})}),e.jsx("input",{id:"file-upload",type:"file",accept:".tgz",style:{display:"none"},onChange:P})]})]})}const ln=o.memo(an);function ze({status:n,enabledText:d="Enabled",disabledText:l=void 0,tooltipText:i=void 0,onClick:a}){if(n===void 0)return null;{const p=e.jsx("div",{className:n?"status-enabled":"status-disabled",style:{cursor:"default"},onClick:a,children:n?d:l??d});return i!==void 0?e.jsx(O,{title:i,children:p}):p}}function dn(n,d,l){const i=n?.[l],a=d?.[l];return i==null&&a==null?0:i==null?-1:a==null?1:typeof i=="boolean"&&typeof a=="boolean"?i===a?0:i?1:-1:typeof i=="number"&&typeof a=="number"?i-a:String(i).localeCompare(String(a))}function cn({name:n,title:d,columns:l,rows:i,getRowKey:a,footerLeft:p,footerRight:h,onRowClick:C}){const t=o.useRef(new WeakMap),D=o.useRef(1),y=g=>{if(typeof a=="string"&&g&&g[a]!=null)return g[a];if(typeof a=="function"){const u=a(g);if(u!=null)return u}const s=l?.[0]?.id;if(s&&g&&g[s]!=null)return g[s];console.warn(`MbfTable(${n}): using fallback stable row key; consider providing getRowKey prop for better React performance`);let c=t.current.get(g);return c||(c=`rk_${D.current++}`,t.current.set(g,c)),c},[I,H]=o.useState(localStorage.getItem(`${n}_table_order_by`)||null),[P,x]=o.useState(localStorage.getItem(`${n}_table_order`)||null),[_,E]=o.useState(!1),[v,f]=o.useState(()=>{try{const g=localStorage.getItem(`${n}_column_visibility`);if(g)return JSON.parse(g)}catch{}return{}}),b=o.useMemo(()=>{const g={};for(const s of l)s.hidden||(g[s.id]=s.required?!0:v[s.id]!==!1);return g},[l,v]),R=o.useMemo(()=>{if(!I||!P)return i;const g=l.find(c=>c.id===I);if(!g||g.noSort)return i;const s=i.map((c,u)=>({el:c,index:u}));return s.sort((c,u)=>{let F;return typeof g.comparator=="function"?F=g.comparator(c.el,u.el):F=dn(c.el,u.el,I),F!==0?P==="asc"?F:-F:c.index-u.index}),s.map(c=>c.el)},[i,I,P,l]),N=g=>{if(I!==g||!I){H(g),x("asc"),localStorage.setItem(`${n}_table_order_by`,g),localStorage.setItem(`${n}_table_order`,"asc");return}if(P==="asc"){x("desc"),localStorage.setItem(`${n}_table_order`,"desc");return}H(null),x(null),localStorage.removeItem(`${n}_table_order_by`),localStorage.removeItem(`${n}_table_order`)},k=()=>{E(!_)},A=g=>{f(s=>{const c=l.find(pe=>pe.id===g);if(c&&c.required)return s;const u=b[g]!==!1,F={...s};u?F[g]=!1:delete F[g];try{localStorage.setItem(`${n}_column_visibility`,JSON.stringify(F))}catch{}return F})},T=()=>{f({});try{localStorage.removeItem(`${n}_column_visibility`)}catch{}E(!1)};return r&&console.log(`Rendering table ${n}${I&&P?` ordered by ${I}:${P}`:""}`),e.jsxs("div",{style:{display:"flex",flexDirection:"column",margin:"0",padding:"0",gap:"0",width:"100%",flex:"1 1 auto",height:"100%",minHeight:0,overflow:"hidden"},children:[e.jsxs(Ne,{open:_,onClose:(g,s)=>{s==="backdropClick"||s==="escapeKeyDown"||k()},disableEscapeKeyDown:!0,disableRestoreFocus:!0,children:[e.jsx(Le,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:`Configure ${n} columns`})]})}),e.jsx($e,{children:e.jsx(Nr,{children:l.filter(g=>!g.hidden).map(g=>e.jsx(Ve,{control:e.jsx(Ee,{disabled:!!g.required,checked:g.required?!0:b[g.id]!==!1,onChange:()=>A(g.id)}),label:g.label},g.id))})}),e.jsxs(Oe,{children:[e.jsx(ie,{onClick:T,children:"Reset"}),e.jsx(ie,{variant:"contained",onClick:g=>{if(g?.currentTarget&&typeof g.currentTarget.blur=="function")try{g.currentTarget.blur()}catch{}const s=document.activeElement;if(s&&s instanceof HTMLElement&&typeof s.blur=="function")try{s.blur()}catch{}k()},children:"Close"})]})]}),e.jsxs("div",{className:"MbfWindowHeader",style:{height:"30px",minHeight:"30px",justifyContent:"space-between",borderBottom:"none"},children:[e.jsx("p",{className:"MbfWindowHeaderText",children:n}),d&&e.jsx("p",{className:"MbfWindowHeaderText",children:d}),e.jsx("div",{className:"MbfWindowHeaderFooterIcons",children:e.jsx(K,{onClick:g=>{if(g?.currentTarget?.blur)try{g.currentTarget.blur()}catch{}k()},"aria-label":"Configure Columns",style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},children:e.jsx(O,{title:`Configure ${n} columns`,children:e.jsx(te,{path:vo,size:"20px",color:"var(--header-text-color)"})})})})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",flex:"1 1 auto",minHeight:0,width:"100%",overflow:"auto",margin:"0px",padding:"0px",gap:"0"},children:e.jsxs("table",{"aria-label":`${n} table`,style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{position:"sticky",top:0,zIndex:10,border:"none",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color"},children:e.jsx("tr",{style:{height:"30px",minHeight:"30px"},children:l.map(g=>{if(g.hidden||!g.required&&b[g.id]===!1)return null;const s=!g.noSort,c=s&&I===g.id&&!!P;return e.jsxs("th",{onClick:s?()=>N(g.id):void 0,style:{margin:"0",padding:"5px 10px",position:"sticky",top:0,minWidth:g.minWidth,maxWidth:g.maxWidth,textAlign:g.align||"left",cursor:s?"pointer":"default",border:"none",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",whiteSpace:g.maxWidth?"nowrap":void 0,overflow:g.maxWidth?"hidden":void 0,textOverflow:g.maxWidth?"ellipsis":void 0},"aria-sort":s?c?P==="asc"?"ascending":"descending":"none":void 0,children:[g.label,c&&e.jsxs("span",{style:{marginLeft:6},children:[P==="asc"&&e.jsx(te,{path:yo,size:"15px"}),P==="desc"&&e.jsx(te,{path:jo,size:"15px"})]})]},g.id)})})}),e.jsx("tbody",{children:R.map((g,s)=>{const c=y(g);return e.jsx("tr",{className:s%2===0?"table-content-even":"table-content-odd",onClick:C?u=>C(g,c,u):void 0,style:{height:"30px",minHeight:"30px",border:"none",borderCollapse:"collapse",cursor:C?"pointer":void 0},children:l.map(u=>{if(u.hidden||!u.required&&b[u.id]===!1)return null;const F=g[u.id];return e.jsx("td",{style:{border:"none",borderCollapse:"collapse",textAlign:u.align||"left",padding:"5px 10px",margin:"0",maxWidth:u.maxWidth,whiteSpace:u.maxWidth?"nowrap":void 0,overflow:u.maxWidth?"hidden":void 0,textOverflow:u.maxWidth?"ellipsis":void 0},children:typeof u.render=="function"?u.render(F,c,g,u):typeof F=="boolean"?e.jsx(Ee,{checked:F,disabled:!0,size:"small",sx:{m:0,p:0,color:"var(--table-text-color)","&.Mui-disabled":{color:"var(--table-text-color)",opacity:.7}}}):u.format&&typeof F=="number"?u.format(F):F!=null?String(F):null},u.id)})},c)})})]})}),(p||h)&&e.jsxs("div",{className:"MbfWindowFooter",style:{height:"30px",minHeight:"30px",justifyContent:"space-between",border:"none"},children:[e.jsx("p",{className:"MbfWindowFooterText",style:{fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)"},children:p}),e.jsx("p",{className:"MbfWindowFooterText",style:{fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)"},children:h})]})]})}function un(n){return o.memo(n)}const wt=un(cn);function Gt(n){return n.id!==0&&n.src==="Matterbridge"&&n.dst==="Frontend"}const Be={fontSize:"16px",fontWeight:"bold",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},Ue={fontSize:"12px",fontWeight:"normal",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},pn={fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)",backgroundColor:"var(--div-bg-color)"},gn={fontSize:"16px",fontWeight:"bold",backgroundColor:"var(--div-bg-color)"},Te={padding:"0px",margin:"0px"},mn="5px 10px 5px 10px",mt={},xe={},ht={},ft={};let Qe=[],It=[];const hn=({open:n,onClose:d,plugin:l})=>{const{sendMessage:i,addListener:a,removeListener:p,getUniqueId:h}=o.useContext(fe),C=o.useRef(h()),[t,D]=o.useState(l.configJson),[y,I]=o.useState(null),[H,P]=o.useState({"ui:submitButtonOptions":{submitText:"Confirm"},"ui:globalOptions":{orderable:!0}}),[x,_]=o.useState("");let E={};o.useEffect(()=>{const S=j=>{j.src==="Matterbridge"&&j.dst==="Frontend"&&(Gt(j)&&j.id===C.current&&j.method==="/api/select/devices"&&j.response&&(r&&console.log(`ConfigPluginDialog (id: ${j.id}) received ${j.response.length} /api/select/devices:`,j.response),Qe=j.response),Gt(j)&&j.id===C.current&&j.method==="/api/select/entities"&&j.response&&(r&&console.log(`ConfigPluginDialog (id: ${j.id}) received ${j.response.length} /api/select/entities:`,j.response),It=j.response))};return a(S,C.current),r&&console.log("ConfigPluginDialog added WebSocket listener id:",C.current),t&&y&&y.properties&&(Object.keys(y.properties).forEach(j=>{Object.keys(y.properties[j]).forEach(M=>{M.startsWith("ui:")&&(H[j]={},H[j][M]=y.properties[j][M],delete y.properties[j][M])})}),P(H)),l.name&&l.configJson&&l.schemaJson&&(D(l.configJson),I(l.schemaJson),i({id:C.current,sender:"ConfigPlugin",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name}}),i({id:C.current,sender:"ConfigPlugin",method:"/api/select/entities",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name}}),r&&console.log('HomePlugins sent "/api/select/devices" and "/api/select/entities" for plugin:',l.name)),()=>{p(S),r&&console.log("ConfigPluginDialog removed WebSocket listener")}},[a,t,l,p,y,i,H]);const v=(S,j)=>{E=S.formData},f=S=>{r&&console.log("ConfigPluginDialog handleSaveChanges:",S.formData),D(S.formData),l.configJson=S.formData,l.restartRequired=!0,i({id:C.current,sender:"ConfigPlugin",method:"/api/savepluginconfig",src:"Frontend",dst:"Matterbridge",params:{pluginName:S.formData.name,formData:S.formData}}),d()};function b(S){const{id:j,label:M,onKeyChange:V,onDropPropertyClick:B,disabled:ce,schema:ae,children:le,registry:ge,readonly:q,required:z}=S,{templates:m}=ge,{RemoveButton:he}=m.ButtonTemplates;if(!(Go in ae))return e.jsx(Z,{sx:{display:"flex",flexDirection:"column",flexGrow:1,padding:0,margin:0,border:"none"},children:le});const de=({target:Y})=>V(Y&&Y.value);return e.jsxs(Z,{sx:{display:"flex",flexDirection:"row",flexGrow:1,padding:0,margin:0,border:"none"},children:[e.jsx(me,{id:`${j}-key`,name:`${j}-key`,required:z,disabled:ce||q,defaultValue:M,onBlur:q?void 0:de,type:"text",variant:"outlined",sx:{width:"250px",minWidth:"250px",maxWidth:"250px",marginRight:"20px"}}),e.jsx(Z,{sx:{flex:1},children:le}),e.jsx(he,{disabled:ce||q,onClick:B(M),registry:ge})]})}function R(S){const{children:j,description:M,displayLabel:V,errors:B,help:ce,hidden:ae,registry:le,uiSchema:ge}=S,q=Uo(ge),z=Qo("WrapIfAdditionalTemplate",le,q);return ae?e.jsx("div",{style:{display:"none"},children:j}):e.jsx(Z,{sx:{display:"flex",flexDirection:"column",flexGrow:1,padding:0,margin:0,border:"none"},children:e.jsxs(z,{...S,children:[V===!0&&M,j,B,ce]})})}function N(S){const{description:j}=S;return j?e.jsx(se,{sx:Ue,children:j}):null}function k(S){const{required:j,title:M}=S;return M?e.jsx(Z,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:e.jsxs(se,{sx:Be,children:["Title ",M," ",j&&e.jsx("mark",{children:"***"})]})}):null}function A(S){const{help:j}=S;return j?e.jsx(Z,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:e.jsx(se,{sx:pn,children:j})}):null}function T(S){const{errors:j}=S;return j?e.jsxs(Z,{sx:{padding:"10px",margin:"10px",border:"1px solid grey"},children:[e.jsx(se,{color:"error",sx:gn,children:"Please fix the following errors:"}),e.jsx(Xe,{children:j.map((M,V)=>e.jsxs(Lr,{children:[e.jsx(Q,{children:e.jsx($r,{color:"error"})}),e.jsx(ee,{primary:M.stack})]},V))})]}):null}function g(S){const{errors:j}=S;return j?e.jsx(Z,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:j.map((M,V)=>e.jsxs(se,{color:"error",variant:"body2",sx:{marginLeft:1},children:["This field ",M]},V))}):null}function s(S){const{id:j,name:M,_schema:V,_uiSchema:B,value:ce,options:ae,label:le,type:ge,placeholder:q,required:z,disabled:m,readonly:he,autofocus:ve,onChange:de,onChangeOverride:Y,onBlur:re,onFocus:Ie,_rawErrors:De,_hideError:Ye,_registry:w,_formContext:X}=S,we=({target:{value:Se}})=>de(Se===""?ae.emptyValue:Se),Fe=({target:Se})=>re(j,Se&&Se.value),ot=({target:Se})=>Ie(j,Se&&Se.value);return e.jsx(Z,{sx:{padding:"0px",margin:"0px"},children:e.jsx(me,{id:j,name:j,label:q&&q!==""?le:void 0,variant:"outlined",placeholder:q&&q!==""?q:le,required:z,disabled:m||he,autoFocus:ve,value:ce||ce===0?ce:"",type:ge,autoComplete:ge==="password"?"current-password":M,onChange:Y||we,onBlur:Fe,onFocus:ot,fullWidth:!0})})}function c(S){return console.log("ArrayFieldTitleTemplate:",S),null}function u(S){return console.log("ArrayFieldDescriptionTemplate:",S),null}function F(S){return console.log("ArrayFieldItemTemplate:",S),null}function pe(S){const{canAdd:j,onAddClick:M,schema:V,title:B}=S,[ce,ae]=o.useState(!1),[le,ge]=o.useState(!1),[q,z]=o.useState(!1),[m,he]=o.useState(""),ve=w=>{he(w.target.value)},de=()=>{r&&console.log("ArrayFieldTemplate: handleDialogDeviceToggle filter:",m,"selectDevices:",Qe),ae(!ce)},Y=()=>{r&&console.log("ArrayFieldTemplate: handleDialogEntityToggle filter:",m,"selectEntities:",It),ge(!le)},re=()=>{r&&console.log("ArrayFieldTemplate: handleDialogDeviceEntityToggle filter:",m,"selectDevices:",Qe),z(!q)},Ie=w=>{ae(!1),V.selectFrom==="serial"?V.items.default=w.serial:V.selectFrom==="name"&&(V.items.default=w.name),M()},De=w=>{ge(!1),V.selectEntityFrom==="name"?V.items.default=w.name:V.selectEntityFrom==="description"&&(V.items.default=w.description),M()},Ye=w=>{z(!1),V.selectDeviceEntityFrom==="name"?V.items.default=w.name:V.selectDeviceEntityFrom==="description"&&(V.items.default=w.description),M()};return e.jsxs(Z,{sx:{margin:"0px",padding:"5px 10px 5px 10px",border:"1px solid grey"},children:[B&&e.jsxs(Z,{sx:{margin:"0px",padding:"0px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[B&&e.jsx(se,{sx:Be,children:B}),j&&e.jsxs(Z,{sx:{margin:"0px",padding:"0px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[V.selectFrom&&e.jsx(O,{title:"Add a device from the list",children:e.jsx(K,{onClick:de,size:"small",color:"primary",sx:Te,children:e.jsx(it,{})})}),V.selectEntityFrom&&e.jsx(O,{title:"Add an entity from the list",children:e.jsx(K,{onClick:Y,size:"small",color:"primary",sx:Te,children:e.jsx(it,{})})}),V.selectDeviceEntityFrom&&e.jsx(O,{title:"Add a device entity from the list",children:e.jsx(K,{onClick:re,size:"small",color:"primary",sx:Te,children:e.jsx(it,{})})}),e.jsx(O,{title:"Add a new item",children:e.jsx(K,{onClick:M,size:"small",color:"primary",sx:Te,children:e.jsx(bt,{})})})]})]}),V.description&&e.jsx(se,{sx:Ue,children:V.description}),S.items.map(w=>e.jsxs(Z,{sx:{margin:"2px 0px",padding:"0px",display:"flex",alignItems:"center"},children:[e.jsx(Z,{sx:{flexGrow:1,marginRight:"10px"},children:w.children}),e.jsx(K,{disabled:!w.hasMoveUp,onClick:w.onReorderClick(w.index,w.index-1),size:"small",color:"primary",sx:Te,children:e.jsx(Ht,{})}),e.jsx(K,{disabled:!w.hasMoveDown,onClick:w.onReorderClick(w.index,w.index+1),size:"small",color:"primary",sx:Te,children:e.jsx(Rt,{})}),e.jsx(K,{onClick:w.onDropIndexClick(w.index),size:"small",color:"primary",sx:Te,children:e.jsx(jt,{})})]},w.index)),e.jsxs(Ne,{open:ce,onClose:de,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Le,{children:"Select a device"}),e.jsxs($e,{children:[e.jsxs(Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(se,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(me,{fullWidth:!0,variant:"outlined",value:m,onChange:ve,placeholder:"Enter serial or name"})]}),e.jsx(Xe,{dense:!0,children:Qe.filter(w=>w.serial.toLowerCase().includes(m.toLowerCase())||w.name.toLowerCase().includes(m.toLowerCase())).map((w,X)=>e.jsxs(st,{onClick:()=>Ie(w),sx:mt,children:[w.icon==="wifi"&&e.jsx(Q,{children:e.jsx(tt,{style:xe})}),w.icon==="ble"&&e.jsx(Q,{children:e.jsx(at,{style:xe})}),w.icon==="hub"&&e.jsx(Q,{children:e.jsx(lt,{style:xe})}),e.jsx(ee,{primary:w.name,secondary:w.serial,primaryTypographyProps:{style:ht},secondaryTypographyProps:{style:ft}})]},X))})]}),e.jsx(Oe,{children:e.jsx(ie,{onClick:de,children:"Close"})})]}),e.jsxs(Ne,{open:le,onClose:Y,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Le,{children:"Select an entity"}),e.jsxs($e,{children:[e.jsxs(Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(se,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(me,{fullWidth:!0,variant:"outlined",value:m,onChange:ve,placeholder:"Enter name or description"})]}),e.jsx(Xe,{dense:!0,children:It.filter(w=>w.name.toLowerCase().includes(m.toLowerCase())||w.description.toLowerCase().includes(m.toLowerCase())).map((w,X)=>e.jsxs(st,{onClick:()=>De(w),sx:mt,children:[w.icon==="wifi"&&e.jsx(Q,{children:e.jsx(tt,{style:xe})}),w.icon==="ble"&&e.jsx(Q,{children:e.jsx(at,{style:xe})}),w.icon==="hub"&&e.jsx(Q,{children:e.jsx(lt,{style:xe})}),w.icon==="component"&&e.jsx(Q,{children:e.jsx(Ot,{style:xe})}),w.icon==="matter"&&e.jsx(Q,{children:e.jsx(Vt,{style:xe})}),e.jsx(ee,{primary:w.name,secondary:w.description,primaryTypographyProps:{style:ht},secondaryTypographyProps:{style:ft}})]},X))})]}),e.jsx(Oe,{children:e.jsx(ie,{onClick:Y,children:"Close"})})]}),e.jsxs(Ne,{open:q,onClose:re,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsxs(Le,{children:["Select an entity for ",B]}),e.jsx($e,{children:e.jsx(Xe,{dense:!0,children:Qe.filter(w=>w.serial===B||w.name===B).map(w=>w.entities?.map((X,we)=>e.jsxs(st,{onClick:()=>Ye(X),sx:mt,children:[X.icon==="wifi"&&e.jsx(Q,{children:e.jsx(tt,{style:xe})}),X.icon==="ble"&&e.jsx(Q,{children:e.jsx(at,{style:xe})}),X.icon==="hub"&&e.jsx(Q,{children:e.jsx(lt,{style:xe})}),X.icon==="component"&&e.jsx(Q,{children:e.jsx(Ot,{style:xe})}),X.icon==="matter"&&e.jsx(Q,{children:e.jsx(Vt,{style:xe})}),e.jsx(ee,{primary:X.name,secondary:X.description,primaryTypographyProps:{style:ht},secondaryTypographyProps:{style:ft}})]},we)))})}),e.jsx(Oe,{children:e.jsx(ie,{onClick:re,children:"Close"})})]})]})}function be(S){const{onAddClick:j,schema:M,properties:V,title:B,description:ce}=S,[ae,le]=o.useState(!1),[ge,q]=o.useState(""),z=Y=>{q(Y.target.value)},m=()=>{le(!ae)},he=Y=>{r&&console.log(`ObjectFieldTemplate: handleSelectValue value "${Y.serial}" for schema "${M.selectFrom}"`),le(!1);let re="";M.selectFrom==="serial"?re=Y.serial:M.selectFrom==="name"&&(re=Y.name),_(re),r&&console.log(`ObjectFieldTemplate: handleSelectValue newkey "${re}"`),j(M)()},ve=()=>{j(M)()},de=!M.additionalProperties;return r&&console.log(`ObjectFieldTemplate: isRoot ${de} newkey "${x}"`),!de&&x!==""&&(r&&console.log("ObjectFieldTemplate: newkey",x,"properties",V),V.forEach(Y=>{if(Y.name==="newKey"&&Y.content.key==="newKey"&&Y.content.props.name==="newKey"&&Y.content.props.onKeyChange&&x!==""){r&&console.log("ObjectFieldTemplate: newkey onKeyChange",x);const re=x;_(""),Y.content.props.onKeyChange(re)}})),e.jsxs(Z,{sx:{margin:"0px",padding:de?"10px":"5px 10px 0px 10px",border:de?"none":"1px solid grey"},children:[M.title&&de&&e.jsx(Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px",marginBottom:"10px"},children:e.jsx(se,{sx:Be,children:M.title})}),B&&!de&&e.jsxs(Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px"},children:[e.jsx(se,{sx:Be,children:B}),e.jsxs(Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px"},children:[M.selectFrom&&e.jsx(O,{title:"Add a device from the list",children:e.jsx(K,{onClick:m,size:"small",color:"primary",sx:Te,children:e.jsx(it,{})})}),e.jsx(O,{title:"Add a new item",children:e.jsx(K,{onClick:ve,size:"small",color:"primary",sx:Te,children:e.jsx(bt,{})})})]})]}),M.description&&e.jsx(Z,{sx:{padding:"0px",margin:"0px",marginBottom:"10px"},children:e.jsx(se,{sx:Ue,children:M.description})}),V.map(({content:Y,name:re,hidden:Ie})=>!Ie&&e.jsxs(Z,{sx:{margin:"0px",marginBottom:"10px",padding:["object","array","boolean"].includes(M.properties[re].type)?"0px":mn,border:["object","array","boolean"].includes(M.properties[re].type)?"none":"1px solid grey"},children:[!["object","array","boolean"].includes(M.properties[re].type)&&e.jsx(se,{sx:Be,children:re}),e.jsx(Z,{sx:{flexGrow:1,padding:"0px",margin:"0px"},children:Y})]},re)),e.jsxs(Ne,{open:ae,onClose:m,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Le,{children:"Select a device"}),e.jsxs($e,{children:[e.jsxs(Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(se,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(me,{fullWidth:!0,variant:"outlined",value:ge,onChange:z,placeholder:"Enter serial or name"})]}),e.jsx(Xe,{dense:!0,children:Qe.filter(Y=>Y.serial.toLowerCase().includes(ge.toLowerCase())||Y.name.toLowerCase().includes(ge.toLowerCase())).map((Y,re)=>e.jsxs(st,{onClick:()=>he(Y),sx:mt,children:[Y.icon==="wifi"&&e.jsx(Q,{children:e.jsx(tt,{style:xe})}),Y.icon==="ble"&&e.jsx(Q,{children:e.jsx(at,{style:xe})}),Y.icon==="hub"&&e.jsx(Q,{children:e.jsx(lt,{style:xe})}),e.jsx(ee,{primary:Y.name,secondary:Y.serial,primaryTypographyProps:{style:ht},secondaryTypographyProps:{style:ft}})]},re))})]}),e.jsx(Oe,{children:e.jsx(ie,{onClick:m,children:"Close"})})]})]})}function oe(S){const{uiSchema:j}=S,{submitText:M,norender:V}=Bo(j);return V?null:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",margin:"10px",padding:"0px",gap:"20px"},children:[e.jsx(ie,{type:"submit",variant:"contained",color:"primary",children:M}),e.jsx(ie,{variant:"contained",color:"primary",onClick:d,children:"Cancel"})]})}function ye(S){const{className:j,disabled:M,onClick:V,registry:B,style:ce,uiSchema:ae,...le}=S;return e.jsx(O,{title:"Remove the item",children:e.jsx(K,{disabled:M,size:"small",color:"primary",onClick:V,children:e.jsx(jt,{})})})}function J(S){const{className:j,disabled:M,onClick:V,registry:B,uiSchema:ce,...ae}=S;return e.jsx(O,{title:"Add an item",children:e.jsx(K,{size:"small",color:"primary",onClick:V,children:e.jsx(bt,{})})})}function ne(S){const{disabled:j,onClick:M,registry:V,style:B,uiSchema:ce,...ae}=S;return e.jsx(O,{title:"Move up the item",children:e.jsx(K,{size:"small",color:"primary",onClick:M,children:e.jsx(Ht,{})})})}function $(S){const{disabled:j,onClick:M,registry:V,style:B,uiSchema:ce,...ae}=S;return e.jsx(O,{title:"Move down the item",children:e.jsx(K,{size:"small",color:"primary",onClick:M,children:e.jsx(Rt,{})})})}function G(S){const{id:j,name:M,value:V,schema:B,readonly:ce,onChange:ae}=S,[le,ge]=o.useState(),q=m=>{r&&console.log(`CheckboxWidget ${M} onChangeField:`,m),ge(m&&m!==""?m:void 0)},z=()=>{r&&console.log(`CheckboxWidget onClick plugin="${l.name}" action="${M}" value="${le}"`),i({id:C.current,sender:"ConfigPlugin",method:"/api/action",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name,action:M,value:le,formData:E,id:j}}),B.buttonClose===!0?d():B.buttonSave===!0&&f({formData:t})};return B.buttonText&&B.description?e.jsxs(Z,{sx:{margin:"0px",padding:"10px",border:"1px solid grey",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(se,{sx:Ue,children:B.description}),e.jsx(ie,{variant:"contained",color:"primary",onClick:()=>z(),children:B.buttonText})]}):B.buttonField&&B.description?e.jsxs(Z,{sx:{margin:"0px",padding:"10px",gap:"20px",border:"1px solid grey",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(se,{sx:Ue,children:B.description}),e.jsx(me,{id:M+"-input",name:M,label:B.textLabel,placeholder:B.textPlaceholder,onChange:m=>q(m.target.value),sx:{width:"250px",minWidth:"250px",maxWidth:"250px"}}),e.jsx(ie,{id:M+"-button",variant:"contained",color:"primary",disabled:le===void 0,onClick:()=>z(),children:B.buttonField})]}):e.jsxs(Z,{sx:{margin:"0px",padding:"5px 10px",border:"1px solid grey"},children:[M&&e.jsxs(Z,{sx:{margin:"0px",padding:"0px",gap:"10px",display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(se,{sx:Be,children:M}),e.jsx(Ee,{checked:V,readOnly:ce,onChange:()=>ae(!V),sx:{padding:"0px",margin:"0px"}})]}),B.description&&e.jsx(se,{sx:Ue,children:B.description})]})}function W({schema:S,id:j,name:M,options:V,label:B,hideLabel:ce,required:ae,disabled:le,placeholder:ge,readonly:q,value:z,multiple:m,autofocus:he,onChange:ve,onBlur:de,onFocus:Y,errorSchema:re,rawErrors:Ie=[],registry:De,uiSchema:Ye,hideError:w,formContext:X,...we}){const{enumOptions:Fe,enumDisabled:ot,emptyValue:Se}=V;m=typeof m>"u"?!1:!!m;const $t=m?[]:"",Wt=typeof z>"u"||m&&z.length<1||!m&&z===$t,lr=({target:{value:We}})=>ve(Mt(We,Fe,Se)),dr=({target:We})=>de(j,Mt(We&&We.value,Fe,Se)),cr=({target:We})=>Y(j,Mt(We&&We.value,Fe,Se)),Tt=qo(z,Fe,m),{InputLabelProps:ur,SelectProps:pr,autocomplete:gr,...mr}=we,hr=!m&&S.default===void 0;return e.jsxs(me,{id:j,name:j,value:!Wt&&typeof Tt<"u"?Tt:$t,required:ae,disabled:le||q,autoFocus:he,autoComplete:gr,placeholder:ge,error:Ie.length>0,onChange:lr,onBlur:dr,onFocus:cr,...mr,select:!0,InputLabelProps:{...ur,shrink:!Wt},SelectProps:{...pr,multiple:m},"aria-describedby":zo(j),children:[hr&&e.jsx(L,{value:"",children:ge}),Array.isArray(Fe)&&Fe.map(({value:We,label:fr},Ft)=>{const xr=Array.isArray(ot)&&ot.indexOf(We)!==-1;return e.jsx(L,{value:String(Ft),disabled:xr,children:fr},Ft)})]})}return r&&console.log("ConfigPluginDialog rendering..."),!n||!y||!t?null:e.jsxs(Ne,{open:n,onClose:d,slotProps:{paper:{sx:{maxWidth:"800px"}}},children:[e.jsx(Le,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h3",{children:"Matterbridge plugin configuration"})]})}),e.jsx($e,{style:{padding:"0px",margin:"0px",width:"800px",height:"600px",overflow:"auto"},children:e.jsx(_o,{schema:y,formData:t,uiSchema:H,validator:Ao,templates:{FieldTemplate:R,BaseInputTemplate:s,TitleFieldTemplate:k,DescriptionFieldTemplate:N,FieldHelpTemplate:A,FieldErrorTemplate:g,ErrorListTemplate:T,WrapIfAdditionalTemplate:b,ArrayFieldTitleTemplate:c,ArrayFieldDescriptionTemplate:u,ArrayFieldItemTemplate:F,ArrayFieldTemplate:pe,ObjectFieldTemplate:be,ButtonTemplates:{SubmitButton:oe,RemoveButton:ye,AddButton:J,MoveUpButton:ne,MoveDownButton:$}},widgets:{CheckboxWidget:G,SelectWidget:W},onChange:v,onSubmit:f})})]})};function nr(n){if(r&&console.log(`getQRColor (id: ${n?.id}) received matter:`,n??"undefined"),n===void 0||!n.online||!n.qrPairingCode&&!n.manualPairingCode&&!n.fabricInformations&&!n.sessionInformations)return"red";if(n.commissioned===!1&&n.qrPairingCode&&n.manualPairingCode)return"var(--primary-color)";let d=0,l=0;for(const i of n.sessionInformations??[])i.fabric&&i.isPeerActive===!0&&d++,i.numberOfActiveSubscriptions>0&&(l+=i.numberOfActiveSubscriptions);return n.commissioned===!0&&n.fabricInformations&&n.sessionInformations&&(d===0||l===0)?"var(--secondary-color)":"var(--div-text-color)"}function fn({storeId:n,setStoreId:d}){const{online:l,sendMessage:i,addListener:a,removeListener:p,getUniqueId:h}=o.useContext(fe),{showConfirmCancelDialog:C}=o.useContext(_e),t=o.useRef(h()),[D,y]=o.useState(null),[I,H]=o.useState(null),[P,x]=o.useState([]),_=[{label:"Name",id:"name",required:!0,render:($,G,W,S)=>e.jsx(O,{title:"Open the plugin homepage",children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>g(W),children:W.name})})},{label:"Description",id:"description",render:($,G,W,S)=>e.jsx(O,{title:"Open the plugin homepage",children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>g(W),children:W.description})})},{label:"Version",id:"version",render:($,G,W,S)=>e.jsxs(e.Fragment,{children:[W.latestVersion!==void 0&&W.latestVersion!==W.version&&I&&!I.readOnly&&e.jsx(O,{title:"New plugin stable version available, click to install",children:e.jsxs("span",{className:"status-warning",style:{marginRight:"10px"},onClick:()=>R(W),children:["Update to v.",W.latestVersion]})}),W.version.includes("-dev-")&&W.devVersion!==void 0&&W.devVersion!==W.version&&I&&!I.readOnly&&e.jsx(O,{title:"New plugin dev version available, click to install",children:e.jsxs("span",{className:"status-warning",style:{marginRight:"10px"},onClick:()=>N(W),children:["Update to new dev v.",W.devVersion.split("-dev-")[0]]})}),e.jsx(O,{title:"Plugin version",children:e.jsx("span",{children:W.version})})]})},{label:"Author",id:"author",render:($,G,W,S)=>e.jsx(e.Fragment,{children:W.author?W.author.replace("https://github.com/",""):"Unknown"})},{label:"Type",id:"type",render:($,G,W,S)=>e.jsx(e.Fragment,{children:W.type?W.type.replace("Platform",""):"Unknown"})},{label:"Devices",id:"registeredDevices"},{label:"Actions",id:"actions",required:!0,noSort:!0,render:($,G,W,S)=>e.jsxs("div",{style:{margin:"0px",padding:"0px",gap:"4px",display:"flex",flexDirection:"row"},children:[I&&I.bridgeMode==="childbridge"&&!W.error&&W.enabled&&e.jsx(O,{title:"Shows the QRCode or the fabrics",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0",padding:"0",width:"19px",height:"19px",color:nr(W.matter)},onClick:()=>{W.matter?.id&&d(W.matter?.id)},size:"small",children:e.jsx(Zt,{})})}),I&&I.bridgeMode==="childbridge"&&!W.error&&W.enabled&&e.jsx(O,{title:"Restart the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0",padding:"0",width:"19px",height:"19px"},onClick:()=>A(W),size:"small",children:e.jsx(vt,{})})}),e.jsx(O,{title:"Plugin config",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{disabled:W.restartRequired===!0,style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>ye(W),size:"small",children:e.jsx(Lt,{})})}),I&&!I.readOnly&&e.jsx(O,{title:"Remove the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>{v("Remove plugin","Are you sure? This will also remove all devices and configuration from the controller.","remove",W)},size:"small",children:e.jsx(jt,{})})}),W.enabled?e.jsx(O,{title:"Disable the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>{v("Disable plugin","Are you sure? This will also remove all devices and configuration from the controller.","disable",W)},size:"small",children:e.jsx(Wr,{})})}):e.jsx(e.Fragment,{}),W.enabled?e.jsx(e.Fragment,{}):e.jsx(O,{title:"Enable the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>T(W),size:"small",children:e.jsx(Tr,{})})}),e.jsx(O,{title:"Open the plugin help",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>c(W),size:"small",children:e.jsx(Fr,{})})}),e.jsx(O,{title:"Open the plugin version history",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>u(W),size:"small",children:e.jsx(Rr,{})})}),I&&!I.readOnly&&e.jsx(O,{title:"Sponsor the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{style:{margin:"0",padding:"0",width:"19px",height:"19px",color:"#b6409c"},onClick:()=>s(W),size:"small",children:e.jsx(Yt,{})})})]})},{label:"Status",id:"status",required:!0,noSort:!0,render:($,G,W,S)=>e.jsx("div",{style:{display:"flex",flexDirection:"row",flex:"1 1 auto",margin:"0",padding:"0",gap:"5px",width:"auto",maxWidth:"max-content"},children:W.error?e.jsx(e.Fragment,{children:e.jsx(ze,{status:!1,enabledText:"Error",disabledText:"Error",tooltipText:"The plugin is in error state. Check the log!"})}):e.jsx(e.Fragment,{children:W.enabled===!1?e.jsx(e.Fragment,{children:e.jsx(ze,{status:W.enabled,enabledText:"Enabled",disabledText:"Disabled",tooltipText:"Whether the plugin is enable or disabled"})}):e.jsx(e.Fragment,{children:W.loaded&&W.started&&W.configured?e.jsx(e.Fragment,{children:e.jsx(ze,{status:W.loaded,enabledText:"Running",tooltipText:"Whether the plugin is running"})}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{status:W.loaded,enabledText:"Loaded",tooltipText:"Whether the plugin has been loaded"}),e.jsx(ze,{status:W.started,enabledText:"Started",tooltipText:"Whether the plugin started"}),e.jsx(ze,{status:W.configured,enabledText:"Configured",tooltipText:"Whether the plugin has been configured"})]})})})})}];o.useEffect(()=>{const $=G=>{r&&console.log("HomePlugins received WebSocket Message:",G),G.method==="refresh_required"&&G.response.changed==="plugins"?(r&&console.log(`HomePlugins received refresh_required: changed=${G.response.changed} and sending /api/plugins request`),i({id:t.current,sender:"HomePlugins",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})):G.method==="refresh_required"&&G.response.changed==="matter"?(r&&console.log(`HomePlugins received refresh_required: changed=${G.response.changed} and setting matter id ${G.response.matter?.id}`),x(W=>{const S=W.findIndex(M=>M.matter?.id===G.response.matter?.id);if(S<0)return r&&console.log(`HomePlugins received refresh_required: changed=${G.response.changed} and matter id ${G.response.matter?.id} not found`),W;r&&console.log(`HomePlugins received refresh_required: changed=${G.response.changed} set matter id ${G.response.matter?.id}`);const j=[...W];return j[S]={...j[S],matter:G.response.matter},j})):G.method==="refresh_required"&&G.response.changed==="settings"&&(r&&console.log(`HomePlugins received refresh_required: changed=${G.response.changed} and sending /api/settings request`),i({id:t.current,sender:"HomePlugins",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})),G.id===t.current&&G.method==="/api/settings"?(r&&console.log(`HomePlugins (id: ${G.id}) received settings:`,G.response),y(G.response.systemInformation),H(G.response.matterbridgeInformation)):G.id===t.current&&G.method==="/api/plugins"&&(r&&console.log(`HomePlugins (id: ${G.id}) received ${G.response.length} plugins:`,G.response),x(G.response))};return a($,t.current),r&&console.log("HomePlugins added WebSocket listener id:",t.current),()=>{p($),r&&console.log("HomePlugins removed WebSocket listener")}},[a,p,i]),o.useEffect(()=>{l&&(r&&console.log("HomePlugins sending api requests"),i({id:t.current,sender:"HomePlugins",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),i({id:t.current,sender:"HomePlugins",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[l,i]);const E=o.useRef(null),v=($,G,W,S)=>{r&&console.log(`handleActionWithConfirmCancel ${W} ${S.name}`),E.current=S,C($,G,W,f,b)},f=$=>{r&&console.log(`handleConfirm action confirmed ${$} ${E.current?.name}`),$==="remove"&&E.current?k(E.current):$==="disable"&&E.current&&T(E.current),E.current=null},b=$=>{r&&console.log(`handleCancel action canceled ${$} ${E.current?.name}`),E.current=null},R=$=>{r&&console.log("handleUpdatePlugin plugin:",$.name),i({id:t.current,sender:"HomePlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:$.name,restart:!1}})},N=$=>{r&&console.log("handleUpdateDevPlugin plugin:",$.name),i({id:t.current,sender:"HomePlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:$.name+"@dev",restart:!1}})},k=$=>{r&&console.log("handleRemovePlugin plugin:",$.name),i({id:t.current,sender:"HomePlugins",method:"/api/removeplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:$.name}})},A=$=>{r&&console.log("handleRestartPlugin plugin:",$.name),i({id:t.current,sender:"HomePlugins",method:"/api/restartplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:$.name}})},T=$=>{r&&console.log("handleEnableDisablePlugin plugin:",$.name,"enabled:",$.enabled),$.enabled===!0?($.enabled=!1,i({id:t.current,sender:"HomePlugins",method:"/api/disableplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:$.name}})):($.enabled=!0,i({id:t.current,sender:"HomePlugins",method:"/api/enableplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:$.name}}))},g=$=>{r&&console.log(`handleHomepagePlugin plugin: ${$.name} homepage: ${$.homepage}`),$.homepage&&window.open($.homepage,"_blank")},s=$=>{r&&console.log("handleSponsorPlugin plugin:",$.name,"funding:",$.funding),$.funding&&window.open($.funding,"_blank")},c=$=>{r&&console.log("handleHelpPlugin plugin:",$.name,"help:",$.help),$.help&&window.open($.help,"_blank")},u=$=>{r&&console.log("handleChangelogPlugin plugin:",$.name,"changelog:",$.changelog),$.changelog&&window.open($.changelog,"_blank")},[F,pe]=o.useState(),[be,oe]=o.useState(!1),ye=$=>{r&&console.log("handleConfigPlugin plugin:",$.name),i({id:t.current,sender:"HomePlugins",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:$.name}}),i({id:t.current,sender:"HomePlugins",method:"/api/select/entities",src:"Frontend",dst:"Matterbridge",params:{plugin:$.name}}),pe($),J()},J=()=>{oe(!0)},ne=()=>{oe(!1)};return r&&console.log("HomePlugins rendering..."),l?e.jsxs("div",{className:"MbfWindowDiv",style:{margin:"0",padding:"0",gap:"0",width:"100%",flex:"0 0 auto",overflow:"hidden"},children:[F&&e.jsx(hn,{open:be,onClose:ne,plugin:F}),e.jsx(wt,{name:"Plugins",columns:_,rows:P,footerRight:"",footerLeft:""})]}):e.jsx(Me,{})}const xn=o.memo(fn),bn=n=>`${n.pluginName}::${n.serial}`;function vn({storeId:n,setStoreId:d}){const{online:l,sendMessage:i,addListener:a,removeListener:p,getUniqueId:h}=o.useContext(fe),[C,t]=o.useState(!1),[D,y]=o.useState(!0),[I,H]=o.useState(null),[P,x]=o.useState([]),[_,E]=o.useState([]),[v,f]=o.useState([]),[b,R]=o.useState([]),N=o.useRef(h()),k=[{label:"Plugin",id:"pluginName"},{label:"Name",id:"name",required:!0},{label:"Serial",id:"serial"},{label:"Availability",id:"availability",render:(g,s,c,u)=>c.reachable===!0?"Online":c.reachable===!1?e.jsx("span",{style:{color:"red"},children:"Offline"}):"",comparator:(g,s)=>{const c=g.reachable===!0?1:g.reachable===!1?0:-1,u=s.reachable===!0?1:s.reachable===!1?0:-1;return c-u}},{label:"Power",id:"powerSource",render:(g,s,c,u)=>c.powerSource==="ac"||c.powerSource==="dc"?e.jsx(Xt,{fontSize:"small",sx:{color:"var(--primary-color)"}}):c.powerSource==="ok"?e.jsx(yt,{fontSize:"small",sx:{color:"green"}}):c.powerSource==="warning"?e.jsx(yt,{fontSize:"small",sx:{color:"yellow"}}):c.powerSource==="critical"?e.jsx(yt,{fontSize:"small",sx:{color:"red"}}):e.jsx("span",{})},{label:"Url",id:"configUrl"},{label:"Actions",id:"selected",required:!0,render:(g,s,c,u)=>e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[c.matter!==void 0?e.jsx(O,{title:"Show the QRCode or the fabrics",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{onClick:()=>d(n===c.matter?.id?I?.matterbridgeInformation.bridgeMode==="bridge"?"Matterbridge":null:c.matter?.id||null),"aria-label":"Show the QRCode",sx:{margin:0,padding:0,color:nr(c.matter)},children:e.jsx(Zt,{fontSize:"small"})})}):e.jsx("div",{style:{width:"20px",height:"20px"}}),c.configUrl?e.jsx(O,{title:"Open the configuration page",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(K,{onClick:()=>window.open(c.configUrl,"_blank"),"aria-label":"Open config url",sx:{margin:0,padding:0},children:e.jsx(Lt,{fontSize:"small"})})}):e.jsx("div",{style:{width:"20px",height:"20px"}}),c.selected!==void 0?e.jsx(O,{title:"Select/unselect the device",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Ee,{checked:c.selected,onChange:F=>T(F,c),sx:{margin:"0",marginLeft:"8px",padding:"0"},size:"small"})}):e.jsx("div",{style:{width:"20px",height:"20px"}})]})}],A=o.useCallback(g=>{g.selected=void 0;const s=P.find(F=>F.name===g.pluginName);if(!s)return console.error(`HomeDevices isSelected: plugin ${g.pluginName} not found for device ${g.name} `),g.selected;const c=s.schemaJson?.properties?.whiteList?.selectFrom;let u=s.configJson.postfix;return u===""&&(u=void 0),s.hasWhiteList===!0&&s.hasBlackList===!0&&c&&(g.selected=!0,c==="serial"&&s.configJson.whiteList&&s.configJson.whiteList.length>0&&s.configJson.whiteList.includes(u?g.serial.replace("-"+u,""):g.serial)&&(g.selected=!0),c==="serial"&&s.configJson.whiteList&&s.configJson.whiteList.length>0&&!s.configJson.whiteList.includes(u?g.serial.replace("-"+u,""):g.serial)&&(g.selected=!1),c==="serial"&&s.configJson.blackList&&s.configJson.blackList.length>0&&s.configJson.blackList.includes(u?g.serial.replace("-"+u,""):g.serial)&&(g.selected=!1),c==="name"&&s.configJson.whiteList&&s.configJson.whiteList.length>0&&s.configJson.whiteList.includes(g.name)&&(g.selected=!0),c==="name"&&s.configJson.whiteList&&s.configJson.whiteList.length>0&&!s.configJson.whiteList.includes(g.name)&&(g.selected=!1),c==="name"&&s.configJson.blackList&&s.configJson.blackList.length>0&&s.configJson.blackList.includes(g.name)&&(g.selected=!1)),g.selected},[P]);o.useEffect(()=>{const g=s=>{if(r&&console.log("HomeDevices received WebSocket Message:",s),s.method==="refresh_required"&&s.response.changed!=="matter"?(r&&console.log(`HomeDevices received refresh_required: changed=${s.response.changed} and sending /api/plugins request`),i({id:N.current,sender:"HomeDevices",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})):s.method==="refresh_required"&&s.response.changed==="matter"?(r&&console.log(`HomeDevices received refresh_required: changed=${s.response.changed} and setting matter id ${s.response.matter?.id}`),R(c=>{const u=c.findIndex(pe=>pe.name.replaceAll(" ","")===s.response.matter?.id);if(u<0)return r&&console.debug(`HomeDevices: matter id ${s.response.matter?.id} not found`),c;const F=[...c];return F[u]={...F[u],matter:s.response.matter},r&&console.log(`HomeDevices received refresh_required: changed=${s.response.changed} and set matter id ${s.response.matter?.id}`),F})):s.method==="restart_required"?(r&&console.log("HomeDevices received restart_required"),t(!0)):s.method==="restart_not_required"?(r&&console.log("HomeDevices received restart_not_required"),t(!1)):s.method==="state_update"&&s.response.plugin&&s.response.serialNumber&&s.response.cluster.includes("BasicInformation")&&s.response.attribute==="reachable"&&(r&&console.log(`HomeDevices updating device reachability for plugin ${s.response.plugin} serial ${s.response.serialNumber} value ${s.response.value}`),E(c=>{const u=c.findIndex(F=>F.pluginName===s.response.plugin&&F.serial===s.response.serialNumber);return u<0?(r&&console.warn(`HomeDevices: device to update not found for plugin ${s.response.plugin} serial ${s.response.serialNumber}`),c):(c[u]={...c[u],reachable:s.response.value},[...c])})),s.id===N.current&&s.method==="/api/settings")r&&console.log(`HomeDevices (id: ${s.id}) received settings:`,s.response),H(s.response),t(s.response.matterbridgeInformation.restartRequired||s.response.matterbridgeInformation.fixedRestartRequired);else if(s.id===N.current&&s.method==="/api/plugins"){if(r&&console.log(`HomeDevices (id: ${s.id}) received ${s.response?.length} plugins:`,s.response),s.response){let c=!0;for(const u of s.response)u.enabled===!0&&(u.loaded!==!0||u.started!==!0||u.error===!0)&&(c=!1);if(!c)return;r&&console.log("HomeDevices reset plugins, devices and selectDevices"),y(!1),x(s.response),E([]),f([]),i({id:N.current,sender:"HomeDevices",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}}),r&&console.log("HomeDevices sent /api/devices");for(const u of s.response)u.enabled===!0&&u.loaded===!0&&u.started===!0&&u.error!==!0&&(i({id:N.current,sender:"HomeDevices",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:u.name}}),r&&console.log(`HomeDevices sent /api/select/devices for plugin: ${u.name}`))}}else if(s.id===N.current&&s.method==="/api/devices"){if(r&&console.log(`HomeDevices (id: ${s.id}) received ${s.response?.length} devices:`,s.response),s.response){for(const c of s.response)c.selected=A(c);E(s.response)}}else s.id===N.current&&s.method==="/api/select/devices"&&(r&&console.log(`HomeDevices (id: ${s.id}) received ${s.response?.length} selectDevices for plugin ${s.response&&s.response.length>0?s.response[0].pluginName:"without select devices"}:`,s.response),s.response&&s.response.length>0&&f(c=>{const u=c.filter(pe=>pe.pluginName!==s.response[0].pluginName),F=s.response.map(pe=>({...pe,selected:A(pe)}));return[...u,...F]}))};return a(g,N.current),r&&console.log(`HomeDevices added WebSocket listener id ${N.current}`),()=>{p(g),r&&console.log("HomeDevices removed WebSocket listener")}},[P,a,p,i,A]),o.useEffect(()=>{if(_.length===0&&v.length===0){R([]);return}r&&console.log(`HomeDevices mixing devices (${_.length}) and selectDevices (${v.length})`);const g=[];for(const s of _)g.push(s);for(const s of v)_.find(c=>c.pluginName===s.pluginName&&c.serial.includes(s.serial))||g.push(s);g.length>0&&(R(g),r&&console.log(`HomeDevices mixed ${g.length} devices and selectDevices`))},[P,_,v,R]),o.useEffect(()=>{l&&(r&&console.log("HomeDevices sending /api/settings and /api/plugins requests"),i({id:N.current,sender:"HomeDevices",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),i({id:N.current,sender:"HomeDevices",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[l,i]);const T=(g,s)=>{r&&console.log(`handleCheckboxChange: checkbox changed to ${g.target.checked} for device ${s.name} serial ${s.serial}`),_.findIndex(c=>c.pluginName===s.pluginName&&c.serial===s.serial)<0?(r&&console.warn(`handleCheckboxChange: device ${s.name} serial ${s.serial} not found in devices, trying in mixedDevices`),R(c=>{const u=c.findIndex(F=>F.pluginName===s.pluginName&&F.serial===s.serial);return u<0?(console.error(`handleCheckboxChange: device ${s.name} serial ${s.serial} not found in mixedDevices`),c):(c[u]={...c[u],selected:g.target.checked},[...c])})):E(c=>{const u=c.findIndex(F=>F.pluginName===s.pluginName&&F.serial===s.serial);return u<0?(console.error(`handleCheckboxChange: device ${s.name} serial ${s.serial} not found in devices`),c):(c[u]={...c[u],selected:g.target.checked},[...c])}),g.target.checked?i({id:N.current,sender:"HomeDevices",method:"/api/command",src:"Frontend",dst:"Matterbridge",params:{command:"selectdevice",plugin:s.pluginName,serial:s.serial,name:s.name}}):i({id:N.current,sender:"HomeDevices",method:"/api/command",src:"Frontend",dst:"Matterbridge",params:{command:"unselectdevice",plugin:s.pluginName,serial:s.serial,name:s.name}})};return r&&console.log("HomeDevices rendering..."),l?e.jsx("div",{className:"MbfWindowDiv",style:{margin:"0",padding:"0",gap:"0",width:"100%",flex:"1 1 auto",overflow:"hidden"},children:e.jsx(wt,{name:"Devices",getRowKey:bn,rows:b,columns:k,footerLeft:D?"Waiting for the plugins to fully load...":`Registered devices: ${_.length.toString()}/${b.length.toString()}`,footerRight:C?"Restart required":""})}):e.jsx(Me,{})}const yn=o.memo(vn);function St({children:n,style:d,name:l}){const{setCurrentPage:i}=o.useContext(_e);i(l),r&&console.log(`MbfPage: current page set to ${l}`);const a={display:"flex",flexDirection:"column",width:"100%",height:"100%",margin:"0px",padding:"0px",gap:"20px"};return e.jsx("div",{style:{...a,...d},children:n})}const jn=()=>"ontouchstart"in window||typeof window.DocumentTouch<"u"&&document instanceof window.DocumentTouch?(r&&console.log("WebSocketLogs detectTouchscreen = true"),!0):(r&&console.log("WebSocketLogs detectTouchscreen = false"),!1);function Cn(){const{messages:n,autoScroll:d}=o.useContext(or),[l,i]=o.useState(!1),a=o.useRef(null),p=o.useMemo(()=>jn(),[]),h=y=>i(!0),C=y=>i(!1);o.useEffect(()=>{r&&console.log(`WebSocketLogs autoScroll: ${d} isHovering: ${l}`),d&&!l&&!p&&a.current?.scrollIntoView({behavior:"smooth"})},[n,l,d,p]);const t=y=>{switch(y.toLowerCase()){case"debug":return"gray";case"info":return"#267fb7";case"notice":return"green";case"warn":return"#e9db18";case"error":return"red";case"fatal":return"#ff0000";case"spawn":return"#ff00d0";default:return"#5c0e91"}},D=y=>{switch(y.toLowerCase()){case"warn":return"black";default:return"white"}};return e.jsx("div",{style:{margin:"0px",padding:"0px"},children:e.jsxs("ul",{style:{margin:"0px",padding:"0px"},onMouseEnter:h,onMouseLeave:C,children:[n.map((y,I)=>e.jsxs("li",{style:{wordWrap:"break-word",maxHeight:"200px",overflow:"hidden"},children:[e.jsx("span",{style:{marginRight:"5px",padding:"1px 5px",backgroundColor:t(y.level),color:D(y.level),fontSize:"12px",borderRadius:"3px",textAlign:"center"},children:y.level}),y.time&&e.jsx("span",{style:{marginRight:"3px",color:"#505050"},children:"["+y.time+"]"}),y.name&&e.jsx("span",{style:{marginRight:"3px",color:"#09516d"},children:"["+y.name+"]"}),e.jsx("span",{style:{color:"var(--main-log-color)"},children:y.message})]},I)),e.jsx("div",{ref:a})]})})}const ir=o.memo(Cn);function wn(){const{logFilterLevel:n,logFilterSearch:d,autoScroll:l,online:i}=o.useContext(fe);return r&&console.log("HomeLogs rendering..."),i?e.jsxs("div",{className:"MbfWindowDiv",style:{flex:"1 1 auto",width:"100%",overflow:"hidden"},children:[e.jsxs("div",{className:"MbfWindowHeader",style:{height:"30px",minHeight:"30px",justifyContent:"space-between"},children:[e.jsx("p",{className:"MbfWindowHeaderText",children:"Logs"}),e.jsx("div",{className:"MbfWindowHeaderText",style:{display:"flex",justifyContent:"space-between"},children:e.jsxs("span",{style:{fontWeight:"normal",fontSize:"12px",marginTop:"2px"},children:['Filter: logger level "',n,'" and search "',d,'" Scroll: ',l?"auto":"manual"]})})]}),e.jsx("div",{style:{flex:"1 1 auto",margin:"0px",padding:"10px",overflow:"auto"},children:e.jsx(ir,{})})]}):e.jsx(Me,{})}const Sn=o.memo(wn);function kn(){const{online:n}=o.useContext(fe);return r&&console.log("HomeBrowserRefresh rendering..."),n?e.jsxs(ke,{children:[e.jsx("div",{className:"MbfWindowHeader",children:e.jsx("p",{className:"MbfWindowHeaderText",children:"Frontend Update"})}),e.jsxs("div",{className:"MbfWindowBody",style:{flexDirection:"row",justifyContent:"space-between"},children:[e.jsx("h4",{style:{margin:0},children:"The frontend has been updated. You are viewing an outdated web UI. Please refresh the page now."}),e.jsx("div",{children:e.jsx(ie,{onClick:()=>window.location.reload(),endIcon:e.jsx(Hr,{}),style:{marginLeft:"10px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Refresh"})})]})]}):e.jsx(Me,{})}const Mn=o.memo(kn);function In({changelog:n}){const{online:d}=o.useContext(fe);return r&&console.log("HomeShowChangelog rendering..."),d?e.jsxs(ke,{children:[e.jsx("div",{className:"MbfWindowHeader",children:e.jsx("p",{className:"MbfWindowHeaderText",children:"Matterbridge Update"})}),e.jsxs("div",{className:"MbfWindowBody",style:{flexDirection:"row",justifyContent:"space-between"},children:[e.jsx("h4",{style:{margin:0},children:"Matterbridge has been updated."}),e.jsxs("div",{children:[e.jsx(ie,{onClick:()=>window.open(n,"_blank"),endIcon:e.jsx(er,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Changelog"}),e.jsx(ie,{onClick:()=>window.location.reload(),endIcon:e.jsx(Or,{}),style:{marginLeft:"10px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Close"})]})]})]}):e.jsx(Me,{})}const Dn=o.memo(In);function Pn(){const[n,d]=o.useState(null),[l,i]=o.useState(null),[a,p]=o.useState([]),[h]=o.useState(localStorage.getItem("homePagePlugins")!=="false"),[C,t]=o.useState(localStorage.getItem("homePageMode")??"devices"),[D,y]=o.useState(""),[I,H]=o.useState(!1),[P,x]=o.useState(!1),[_,E]=o.useState(null),{addListener:v,removeListener:f,online:b,sendMessage:R,getUniqueId:N}=o.useContext(fe),k=o.useRef(N());return o.useEffect(()=>{const A=T=>{r&&console.log("Home received WebSocket Message:",T),T.method==="refresh_required"&&T.response.changed==="settings"&&(r&&console.log(`Home received refresh_required: changed=${T.response.changed} and sending /api/settings request`),E(null),p([]),R({id:k.current,sender:"Home",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),R({id:k.current,sender:"Home",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})),T.method==="/api/settings"&&T.id===k.current&&(r&&console.log("Home received settings:",T.response),d(T.response.systemInformation),i(T.response.matterbridgeInformation),T.response.matterbridgeInformation.matterbridgeVersion&&y(`https://github.com/Luligu/matterbridge/blob/${T.response.matterbridgeInformation.matterbridgeVersion.includes("-dev-")?"dev":"main"}/CHANGELOG.md`),localStorage.getItem("frontendVersion")===null&&T.response.matterbridgeInformation.frontendVersion?localStorage.setItem("frontendVersion",T.response.matterbridgeInformation.frontendVersion):T.response.matterbridgeInformation.frontendVersion!==localStorage.getItem("frontendVersion")&&T.response.matterbridgeInformation.frontendVersion&&(localStorage.setItem("frontendVersion",T.response.matterbridgeInformation.frontendVersion),x(!0)),localStorage.getItem("matterbridgeVersion")===null?localStorage.setItem("matterbridgeVersion",T.response.matterbridgeInformation.matterbridgeVersion):T.response.matterbridgeInformation.matterbridgeVersion!==localStorage.getItem("matterbridgeVersion")&&(localStorage.setItem("matterbridgeVersion",T.response.matterbridgeInformation.matterbridgeVersion),H(!0)),T.response.matterbridgeInformation.shellyBoard&&(localStorage.getItem("homePageMode")||(localStorage.setItem("homePageMode","devices"),t("devices")))),T.method==="/api/plugins"&&T.id===k.current&&(r&&console.log("Home received plugins:",T.response),p(T.response))};return v(A,k.current),r&&console.log(`Home added WebSocket listener id ${k.current}`),()=>{f(A),r&&console.log("Home removed WebSocket listener")}},[v,f,R]),o.useEffect(()=>{if(r&&console.log(`Home storeId effect with storeId ${_}`),l?.bridgeMode==="bridge"&&!_&&(r&&console.log("Home storeId effect set storeId to Matterbridge"),E("Matterbridge")),l?.bridgeMode==="childbridge"&&!_&&a){for(const A of a)if(A.matter?.id){r&&console.log(`Home storeId effect set storeId to ${A.matter.id}`),E(A.matter.id);break}}},[l,a,_]),o.useEffect(()=>{b&&(r&&console.log("Home online effect, sending /api/settings and /api/plugins requests"),R({id:k.current,sender:"Home",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),R({id:k.current,sender:"Home",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[b,R]),r&&console.log("Home rendering..."),!b||!n||!l?e.jsx(Me,{}):e.jsxs(St,{name:"Home",style:{flexDirection:"row"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"302px",minWidth:"302px",gap:"20px"},children:[e.jsx(sn,{id:_}),e.jsx(rn,{systemInfo:n,compact:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",gap:"20px"},children:[P&&e.jsx(Mn,{}),I&&e.jsx(Dn,{changelog:D}),h&&!l.readOnly&&e.jsx(ln,{}),h&&e.jsx(xn,{storeId:_,setStoreId:E}),C==="devices"&&e.jsx(yn,{storeId:_,setStoreId:E}),C==="logs"&&e.jsx(Sn,{})]})]})}const Nn=o.memo(Pn),xt=!1,Kt={display:"flex",gap:"2px",justifyContent:"space-evenly",width:"100%",height:"40px"},Ln={margin:"0",padding:"0",fontSize:"36px",fontWeight:"medium",color:"var(--primary-color)"},$n={margin:"0",padding:"0",fontSize:"20px",fontWeight:"medium",color:"var(--div-text-color)",textAlign:"center"},Jt={margin:"0",padding:"0",paddingBottom:"2px",fontSize:"16px",fontWeight:"medium",color:"var(--div-text-color)",textAlign:"center"},Wn={display:"flex",gap:"2px",justifyContent:"center",width:"100%",height:"18px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},Tn={margin:"0",padding:"0",fontSize:"12px",fontWeight:"normal",color:"var(--div-text-color)"},Fn={display:"flex",justifyContent:"center",width:"100%",height:"52px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},Rn={margin:"0",padding:"0",fontSize:"14px",fontWeight:"bold",color:"var(--div-text-color)"},Hn={display:"flex",gap:"4px",justifyContent:"center",width:"100%",height:"15px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},Dt={margin:"0",padding:"0px 4px",borderRadius:"5px",textAlign:"center",fontSize:"12px",fontWeight:"normal",color:"var(--secondary-color)"},On=[256,257,268,269],Vn=[266,267],En=[259,260,261,271,272],_n=[256,257,268,269,266,267,259,260,261,272];function U({icon:n,iconColor:d,cluster:l,value:i,unit:a,prefix:p}){return r&&console.log(`Render cluster "${l.clusterName}.${l.attributeName}" value(${typeof i}-${isNaN(i)}) "${i}" unit "${a}"`),p=p??!1,e.jsxs(Z,{sx:Kt,children:[n&&o.cloneElement(n,{key:`${l.clusterId}-${l.attributeId}-icon`,sx:{...Ln,color:d??"var(--primary-color)"}}),e.jsxs(Z,{sx:{...Kt,gap:"4px",alignContent:"center",alignItems:"end",justifyContent:"center"},children:[a&&p===!0&&e.jsx(se,{sx:Jt,children:a},`${l.clusterId}-${l.attributeId}-unit`),e.jsx(se,{sx:$n,children:i==null||typeof i=="number"&&isNaN(i)||i==="NaN"?"---":i},`${l.clusterId}-${l.attributeId}-value`),a&&p===!1&&e.jsx(se,{sx:Jt,children:a},`${l.clusterId}-${l.attributeId}-unit`)]},`${l.clusterId}-${l.attributeId}-valueunitbox`)]},`${l.clusterId}-${l.attributeId}-box`)}function An({device:n,endpoint:d,id:l,deviceType:i,clusters:a}){const p=["Unknown","Good","Fair","Moderate","Poor","VeryPoor","Ext.Poor"];let h="";r&&console.log(`Device "${n.name}" endpoint "${d}" id "${l}" deviceType "0x${i.toString(16).padStart(4,"0")}" clusters (${a?.length})`);const C=a.find(t=>t.clusterName==="Descriptor"&&t.attributeName==="tagList")?.attributeLocalValue;if(C){let t="";C.map(D=>{D.label&&(t+=D.label+" ")}),h=t.trim()}if(i===17&&a.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="batVoltage").map(t=>h=`${t.attributeLocalValue} mV`),_n.includes(i)&&a.filter(t=>t.clusterName==="LevelControl"&&t.attributeName==="currentLevel").map(t=>h=`Level ${t.attributeValue}`),i===514&&a.filter(t=>t.clusterName==="WindowCovering"&&t.attributeName==="currentPositionLiftPercent100ths").map(t=>h=`Position ${t.attributeLocalValue/100}%`),i===769&&a.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="occupiedHeatingSetpoint").map(t=>h=`Heat ${t.attributeLocalValue/100}°C `),i===769&&a.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="occupiedCoolingSetpoint").map(t=>h=h+`Cool ${t.attributeLocalValue/100}°C`),i===118&&a.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="coState").map(t=>h=`${t.attributeLocalValue===0?"No CO detected":"CO alarm!"}`),i===1296&&a.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="voltage").map(t=>h=`${t.attributeLocalValue/1e3} V, `),i===1296&&a.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="activeCurrent").map(t=>h=h+`${t.attributeLocalValue/1e3} A, `),i===1296&&a.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="activePower").map(t=>h=h+`${t.attributeLocalValue/1e3} W`),i===39){const t=a.find(y=>y.clusterName==="ModeSelect"&&y.attributeName==="currentMode")?.attributeLocalValue;h=a.find(y=>y.clusterName==="ModeSelect"&&y.attributeName==="supportedModes")?.attributeLocalValue?.find(y=>y.mode===t)?.label||"Unknown"}if(i===116){const t=a.find(y=>y.clusterName==="RvcRunMode"&&y.attributeName==="currentMode")?.attributeLocalValue;h=a.find(y=>y.clusterName==="RvcRunMode"&&y.attributeName==="supportedModes")?.attributeLocalValue?.find(y=>y.mode===t)?.label||"Unknown"}return e.jsxs("div",{className:"MbfWindowDiv",style:{margin:"0px",padding:"5px",width:"150px",height:"150px",borderColor:"var(--div-bg-color)",borderRadius:"5px",justifyContent:"space-between"},children:[i===19&&a.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(U,{icon:t.attributeLocalValue===!0?e.jsx(tt,{}):e.jsx(Vr,{}),iconColor:t.attributeLocalValue===!0?"green":"red",cluster:t,value:t.attributeLocalValue===!0?"Online":"Offline"})),i===17&&a.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="batPercentRemaining").map(t=>e.jsx(U,{icon:e.jsx(yt,{}),cluster:t,value:t.attributeLocalValue/2,unit:"%"})),i===17&&a.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="wiredCurrentType").map(t=>e.jsx(U,{icon:e.jsx(Xt,{}),cluster:t,value:t.attributeLocalValue===0?"AC":"DC"})),i===1293&&a.filter(t=>t.clusterName==="DeviceEnergyManagement"&&t.attributeName==="esaState").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Co,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Offline":"Online"})),On.includes(i)&&a.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(U,{icon:e.jsx(Er,{}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),Vn.includes(i)&&a.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(U,{icon:e.jsx(te,{path:wo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),En.includes(i)&&a.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(U,{icon:e.jsx(te,{path:So,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),i===115&&a.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(U,{icon:e.jsx(te,{path:ko,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===124&&a.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Mo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===117&&a.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Io,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===123&&a.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(U,{icon:e.jsx(Et,{}),cluster:t,value:"Oven"})),i===112&&a.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(U,{icon:e.jsx(_r,{}),cluster:t,value:"Fridge"})),i===113&&a.filter(t=>t.clusterName==="TemperatureControl"&&t.attributeName==="selectedTemperatureLevel").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Do,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===121&&a.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(U,{icon:e.jsx(Et,{}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===122&&a.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="fanMode").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Po,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===120&&a.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Bt,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Cooktop"})),i===119&&a.filter(t=>t.clusterName==="TemperatureControl"&&t.attributeName==="selectedTemperatureLevel").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Bt,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===514&&a.filter(t=>t.clusterName==="WindowCovering"&&t.attributeName==="currentPositionLiftPercent100ths").map(t=>e.jsx(U,{icon:e.jsx(Ar,{}),cluster:t,value:t.attributeLocalValue/100,unit:"%"})),i===769&&a.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="localTemperature").map(t=>e.jsx(U,{icon:e.jsx(te,{path:No,size:"40px",color:"var(--primary-color)"}),cluster:t,value:(t.attributeLocalValue??0)/100,unit:"°C"})),i===10&&a.filter(t=>t.clusterName==="DoorLock"&&t.attributeName==="lockState").map(t=>e.jsx(U,{icon:t.attributeValue==="1"?e.jsx(qr,{}):e.jsx(zr,{}),cluster:t,value:t.attributeValue==="1"?"Locked":"Unlocked"})),i===43&&a.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="percentCurrent").map(t=>e.jsx(U,{icon:e.jsx(Br,{}),cluster:t,value:t.attributeValue,unit:"%"})),i===15&&a.filter(t=>t.clusterName==="Switch"&&t.attributeName==="currentPosition").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Lo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeValue,unit:"pos",prefix:!0})),i===39&&a.filter(t=>t.clusterName==="ModeSelect"&&t.attributeName==="currentMode").map(t=>e.jsx(U,{icon:e.jsx(Ur,{}),cluster:t,value:t.attributeValue,unit:"Mode",prefix:!0})),i===771&&a.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(U,{icon:e.jsx(Qr,{}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),i===45&&a.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="percentCurrent").map(t=>e.jsx(U,{icon:e.jsx(_t,{}),cluster:t,value:t.attributeValue,unit:"%"})),i===114&&a.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="localTemperature").map(t=>e.jsx(U,{icon:e.jsx(_t,{}),cluster:t,value:(t.attributeLocalValue??0)/100,unit:"°C"})),i===67&&a.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(U,{icon:e.jsx(Gr,{}),cluster:t,value:t.attributeLocalValue===!0?"Leak":"No leak"})),i===65&&a.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(U,{icon:e.jsx(Kr,{}),cluster:t,value:t.attributeLocalValue===!0?"Freeze":"No freeze"})),i===68&&a.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(U,{icon:e.jsx(Jr,{}),cluster:t,value:t.attributeLocalValue===!0?"Rain":"No rain"})),i===116&&a.filter(t=>t.clusterName==="RvcRunMode"&&t.attributeName==="currentMode").map(t=>e.jsx(U,{icon:e.jsx(te,{path:$o,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeValue,unit:"Run mode",prefix:!0})),i===1292&&a.filter(t=>t.clusterName==="EnergyEvse"&&t.attributeName==="state").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Wo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Free":"In use"})),i===1295&&a.filter(t=>t.clusterName==="WaterHeaterManagement"&&t.attributeName==="tankPercentage").map(t=>e.jsx(U,{icon:e.jsx(te,{path:To,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Tank "+(t.attributeLocalValue??0)+"%"})),i===777&&a.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="featureMap").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Fo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"HeatPump"})),i===23&&a.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="featureMap").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Ro,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Solar"})),i===24&&a.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="featureMap").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Ho,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Inverter"})),i===118&&a.find(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="featureMap"&&t.attributeLocalValue.smokeAlarm===!0)&&a.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="smokeState").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Ut,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"No smoke":"Smoke!"})),i===118&&a.find(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="featureMap"&&t.attributeLocalValue.smokeAlarm===!1)&&a.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="coState").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Ut,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"No Co":"Co!"})),i===66&&a.filter(t=>t.clusterName==="ValveConfigurationAndControl"&&t.attributeName==="currentState").map(t=>e.jsx(U,{icon:e.jsx(Zr,{}),cluster:t,value:t.attributeLocalValue===0?"Closed":"Opened"})),i===44&&a.filter(t=>t.clusterName==="AirQuality"&&t.attributeName==="airQuality").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Oo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:p[t.attributeLocalValue??0]})),i===770&&a.filter(t=>t.clusterName==="TemperatureMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(U,{icon:e.jsx(Yr,{}),cluster:t,value:t.attributeLocalValue/100,unit:"°C"})),i===775&&a.filter(t=>t.clusterName==="RelativeHumidityMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(U,{icon:e.jsx(te,{path:Vo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue/100,unit:"%"})),i===774&&a.filter(t=>t.clusterName==="FlowMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(U,{icon:e.jsx(Xr,{}),cluster:t,value:t.attributeLocalValue,unit:"l/h"})),i===773&&a.filter(t=>t.clusterName==="PressureMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(U,{icon:e.jsx(eo,{}),cluster:t,value:t.attributeLocalValue,unit:"hPa"})),i===21&&a.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(U,{icon:t.attributeValue==="true"?e.jsx(to,{}):e.jsx(ro,{}),cluster:t,value:t.attributeValue==="true"?"Closed":"Opened"})),i===263&&a.filter(t=>t.clusterName==="OccupancySensing"&&t.attributeName==="occupancy").map(t=>e.jsx(U,{icon:t.attributeValue==="{ occupied: true }"?e.jsx(oo,{}):e.jsx(no,{}),cluster:t,value:t.attributeValue==="{ occupied: true }"?"Occupied":"Unocc."})),i===262&&a.filter(t=>t.clusterName==="IlluminanceMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(U,{icon:e.jsx(io,{}),cluster:t,value:Math.round(Math.pow(10,t.attributeLocalValue/1e4)),unit:"lx"})),i===1296&&a.filter(t=>t.clusterName==="ElectricalEnergyMeasurement"&&t.attributeName==="cumulativeEnergyImported").map(t=>e.jsx(U,{icon:e.jsx(so,{}),cluster:t,value:Math.round(t.attributeLocalValue?.energy/1e6),unit:"kwh"})),e.jsx(Z,{sx:Wn,children:e.jsx(se,{sx:Tn,children:h})}),e.jsx(Z,{sx:Fn,children:e.jsx(se,{sx:Rn,children:n.name})}),e.jsxs(Z,{sx:Hn,children:[r&&e.jsx(se,{sx:Dt,children:d}),e.jsx(se,{sx:Dt,children:l}),r&&e.jsxs(se,{sx:Dt,children:["0x",i.toString(16).padStart(4,"0")]})]})]})}function qn({filter:n}){const{online:d,sendMessage:l,addListener:i,removeListener:a,getUniqueId:p}=o.useContext(fe),[h,C]=o.useState([]),[t,D]=o.useState({}),[y,I]=o.useState({}),[H,P]=o.useState({}),x=o.useRef(p()),_=o.useCallback(f=>{(r||xt)&&console.log(`DevicesIcons received state_update "${f.response.cluster}.${f.response.attribute}" for "${f.response.id}:${f.response.number}": "${f.response.value}"`,f.response);const b=h.find(N=>N.pluginName===f.response.plugin&&N.serial===f.response.serialNumber);if(!b){(r||xt)&&console.warn(`DevicesIcons updater device of plugin "${f.response.plugin}" serial "${f.response.serialNumber}" number "${f.response.number}" id "${f.response.id}" not found in devices(${h.length})`);return}const R=H[b.serial]?.find(N=>N.endpoint===f.response.number.toString()&&N.clusterName===f.response.cluster&&N.attributeName===f.response.attribute);if(!R){(r||xt)&&console.warn(`DevicesIcons updater device "${b.name}" serial "${b.serial}" cluster "${f.response.cluster}" attribute "${f.response.attribute}" not found in clusters(${H[b.serial]?.length})`);return}R.attributeValue=String(f.response.value),R.attributeLocalValue=f.response.value,P({...H}),(r||xt)&&console.log(`DevicesIcons updated "${R.clusterName}.${R.attributeName}" for device "${b.name}" serial "${b.serial}" to "${R.attributeValue}"`)},[H,h]),E=o.useCallback(f=>{if(r&&console.log(`DevicesIcons received for device "${f.response.deviceName}" serial "${f.response.serialNumber}" deviceTypes (${f.response.deviceTypes.length}) "${f.response.deviceTypes.join(",")}" clusters (${f.response.clusters.length}):`,f.response),f.response.clusters.length===0)return;const b=f.response.serialNumber;t[b]=[],y[b]=f.response.deviceTypes,H[b]=[];for(const R of f.response.clusters)t[b].find(N=>N.endpoint===R.endpoint)||t[b].push({endpoint:R.endpoint,id:R.id,deviceTypes:R.deviceTypes}),!["FixedLabel","Identify","Groups","PowerTopology"].includes(R.clusterName)&&H[b].push(R);D({...t}),I({...y}),P({...H}),r&&console.log(`DevicesIcons endpoints for "${b}":`,t[b]),r&&console.log(`DevicesIcons deviceTypes for "${b}":`,y[b]),r&&console.log(`DevicesIcons clusters for "${b}":`,H[b])},[H,y,t]);o.useEffect(()=>{const f=b=>{if(r&&console.log("DevicesIcons received WebSocket Message:",b),b.method==="refresh_required")r&&console.log(`DevicesIcons received refresh_required: changed=${b.response.changed} and sending api requests`),l({id:x.current,sender:"DevicesIcons",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}});else if(b.method==="state_update"&&b.response)_(b);else if(b.method==="/api/devices"&&b.response){r&&console.log(`DevicesIcons received ${b.response.length} devices:`,b.response),C(b.response),D({}),I({}),P({});for(const R of b.response)r&&console.log("DevicesIcons sending /api/clusters"),l({id:x.current,sender:"DevicesIcons",method:"/api/clusters",src:"Frontend",dst:"Matterbridge",params:{plugin:R.pluginName,endpoint:R.endpoint||0}})}else b.method==="/api/clusters"&&b.response&&E(b)};return i(f,x.current),r&&console.log("DevicesIcons WebSocket effect mounted"),()=>{a(f),r&&console.log("DevicesIcons WebSocket effect unmounted")}},[h]),o.useEffect(()=>(r&&console.log("DevicesIcons useEffect online mounting"),d&&(r&&console.log("DevicesIcons useEffect online sending api requests"),l({id:x.current,sender:"DevicesIcons",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}})),r&&console.log("DevicesIcons useEffect online mounted"),()=>{r&&console.log("DevicesIcons useEffect online unmounted")}),[d,l]);const v=o.memo(An);return r&&console.log("DevicesIcons rendering..."),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",paddingBottom:"5px",gap:"20px",width:"100%",overflow:"auto"},children:h.filter(f=>f.name.toLowerCase().includes(n)||f.serial.toLowerCase().includes(n)).map(f=>t[f.serial]&&t[f.serial].map(b=>b.deviceTypes.map(R=>e.jsx(v,{device:f,endpoint:b.endpoint,id:b.id,deviceType:R,clusters:H[f.serial].filter(N=>N.endpoint===b.endpoint)},`${f.pluginName}-${f.uniqueId}-${b.endpoint}-${b.id}-${R.toString()}`))))})}const zn=o.memo(qn),Bn=[{label:"Plugin name",id:"pluginName",required:!0},{label:"Device type",id:"type"},{label:"Endpoint",id:"endpoint",align:"right"},{label:"Name",id:"name",required:!0},{label:"Serial number",id:"serial"},{label:"Unique ID",id:"uniqueId"},{label:"Url",id:"configUrl"},{label:"Config",id:"configButton",noSort:!0,render:(n,d,l,i)=>l.configUrl?e.jsx(K,{onClick:()=>window.open(l.configUrl,"_blank"),"aria-label":"Open Config",sx:{margin:0,padding:0},children:e.jsx(Lt,{fontSize:"small"})}):null},{label:"Cluster",id:"cluster"}],Un=[{label:"Endpoint",id:"endpoint",required:!0},{label:"Id",id:"id"},{label:"Device Types",id:"deviceTypes",render:(n,d,l,i)=>Array.isArray(n)?e.jsx(e.Fragment,{children:n.map(a=>`0x${a.toString(16).padStart(4,"0")}`).join(", ")}):e.jsx(e.Fragment,{children:n})},{label:"Cluster Name",id:"clusterName",required:!0},{label:"Cluster ID",id:"clusterId"},{label:"Attribute Name",id:"attributeName",required:!0},{label:"Attribute ID",id:"attributeId"},{label:"Attribute Value",id:"attributeValue",required:!0,render:(n,d,l,i)=>e.jsx(O,{title:String(n),componentsProps:{tooltip:{sx:{fontSize:"14px",fontWeight:"normal",color:"#ffffff",backgroundColor:"var(--primary-color)"}}},children:e.jsx("div",{style:{maxWidth:"500px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(n)})})}],Qn=n=>`${n.pluginName}::${n.uniqueId}`,Gn=n=>`${n.endpoint}::${n.clusterName}::${n.attributeName}`;function Kn({filter:n}){const{online:d,sendMessage:l,addListener:i,removeListener:a,getUniqueId:p}=o.useContext(fe),[h,C]=o.useState([]),[t,D]=o.useState(h),[y,I]=o.useState([]),[H,P]=o.useState(0),[x,_]=o.useState(null),[E,v]=o.useState(null),[f,b]=o.useState(null),[R,N]=o.useState(null),k=o.useRef(p()),A=o.useRef(t),T=o.useCallback(s=>{r&&console.log(`DevicesTable received state_update "${s.response.cluster}.${s.response.attribute}" for "${s.response.id}:${s.response.number}": "${s.response.value}"`,s.response);const c=A.current.find(u=>u.pluginName===s.response.plugin&&u.uniqueId===s.response.uniqueId);if(!c){r&&console.warn(`DevicesTable updater device of plugin "${s.response.plugin}" serial "${s.response.serialNumber}" not found in filteredDevicesRef.current`);return}if(x&&E&&c.pluginName===x&&c.uniqueId===R&&s.response.number.toString()===E){const u=y.find(F=>F.endpoint===s.response.number.toString()&&F.clusterName===s.response.cluster&&F.attributeName===s.response.attribute);if(!u){r&&console.warn(`DevicesTable updater cluster ${s.response.cluster}.${s.response.attribute} for device "${c.name}" serial "${c.serial}" not found in clusters`);return}u.attributeValue=String(s.response.value),u.attributeLocalValue=s.response.value,I([...y]),r&&console.log(`DevicesTable updated attribute ${u.clusterName}.${u.attributeName} for device "${c.name}" serial "${c.serial}" to "${u.attributeValue}"`)}},[y,E,x,R]);o.useEffect(()=>{const s=c=>{if(r&&console.log("DevicesTable received WebSocket Message:",c),c.method==="refresh_required"&&c.response.changed==="devices")r&&console.log(`DevicesTable received refresh_required: changed=${c.response.changed} and sending /api/devices request`),l({id:k.current,sender:"DevicesTable",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}});else if(c.method==="state_update"&&c.response)T(c);else if(c.method==="/api/devices")r&&console.log(`DevicesTable received ${c.response.length} devices:`,c.response),C(c.response);else if(c.method==="/api/clusters"){r&&console.log(`DevicesTable received ${c.response.clusters.length} clusters for plugin ${c.response.plugin}:`,c.response),I(c.response.clusters);const u={};for(const F of c.response.clusters)r&&console.log("Cluster:",F.endpoint),u[F.endpoint]?u[F.endpoint]++:u[F.endpoint]=1;P(Object.keys(u).length)}};return i(s,k.current),r&&console.log("DevicesTable added WebSocket listener"),()=>{a(s),r&&console.log("DevicesTable removed WebSocket listener")}},[l,i,a,T]),o.useEffect(()=>{d&&(r&&console.log("DevicesTable sending api requests with id ",k.current),l({id:k.current,sender:"DevicesTable",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),l({id:k.current,sender:"DevicesTable",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}),l({id:k.current,sender:"DevicesTable",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}}))},[d,l]),o.useEffect(()=>{x&&E&&(r&&console.log("DevicesTable sending /api/clusters"),l({id:k.current,sender:"DevicesTable",method:"/api/clusters",src:"Frontend",dst:"Matterbridge",params:{plugin:x,endpoint:Number(E)}}))},[x,E,l]),o.useEffect(()=>{if(n===""){D(h),A.current=h;return}const s=h.filter(c=>c.name.toLowerCase().includes(n)||c.serial.toLowerCase().includes(n));D(s),A.current=s},[h,n]);const g=s=>{if(s.uniqueId===R){N(null),_(null),v(null),b(null);return}N(s.uniqueId),_(s.pluginName),v(s.endpoint?s.endpoint.toString():null),b(s.name)};return r&&console.log("DevicesTable rendering..."),d?e.jsxs("div",{style:{display:"flex",flexDirection:"column",margin:"0px",padding:"0px",gap:"20px",width:"100%",overflow:"hidden"},children:[e.jsx("div",{className:"MbfWindowDiv",style:{margin:"0px",padding:"0px",gap:"0px",width:"100%",maxHeight:`${x&&E?"30%":"100%"}`,flex:"1 1 auto",overflow:"hidden"},children:e.jsx(wt,{name:"Registered devices",getRowKey:Qn,onRowClick:g,rows:t,columns:Bn,footerLeft:`Total devices: ${t.length.toString()}`})}),x&&E&&e.jsx("div",{className:"MbfWindowDiv",style:{margin:"0px",padding:"0px",gap:"0px",width:"100%",height:"70%",maxHeight:"70%",flex:"1 1 auto",overflow:"hidden"},children:e.jsx(wt,{name:"Clusters",title:f||"",getRowKey:Gn,rows:y,columns:Un,footerLeft:`Total child endpoints: ${H-1}`})})]}):e.jsx(Me,{})}const Jn=o.memo(Kn);function Zn(){const{online:n}=o.useContext(fe),[d,l]=o.useState(""),[i,a]=o.useState("icon");o.useEffect(()=>{const C=localStorage.getItem("devicesFilter");C&&l(C)},[]),o.useEffect(()=>{const C=localStorage.getItem("devicesViewMode");C&&a(C)},[]);const p=C=>{l(C.target.value.toLowerCase()),localStorage.setItem("devicesFilter",C.target.value.toLowerCase())},h=C=>{a(C),localStorage.setItem("devicesViewMode",C)};return r&&console.log("Devices rendering..."),n?e.jsxs(St,{name:"Devices",children:[e.jsxs("div",{className:"MbfWindowBodyRow",style:{justifyContent:"space-between",padding:0,gap:"20px",width:"100%",height:"45px",minHeight:"45px",maxHeight:"45px"},children:[e.jsxs(Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(se,{sx:{fontSize:"16px",fontWeight:"normal",color:"var(--div-text-color)",marginLeft:"5px",whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(me,{variant:"outlined",value:d,onChange:p,placeholder:"Enter the device name or serial number",sx:{width:"320px"},InputProps:{style:{backgroundColor:"var(--main-bg-color)"}}})]}),e.jsxs(Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(se,{sx:{fontSize:"16px",fontWeight:"normal",color:"var(--div-text-color)",marginLeft:"5px",whiteSpace:"nowrap"},children:"View mode:"}),e.jsx(K,{onClick:()=>h("table"),"aria-label":"Table View",disabled:i==="table",children:e.jsx(O,{title:"Table View",children:e.jsx(ao,{style:{color:i==="table"?"var(--main-icon-color)":"var(--primary-color)"}})})}),e.jsx(K,{onClick:()=>h("icon"),"aria-label":"Icon View",disabled:i==="icon",children:e.jsx(O,{title:"Icon View (beta)",children:e.jsx(lo,{style:{color:i==="icon"?"var(--main-icon-color)":"var(--primary-color)"}})})})]})]}),i==="table"&&e.jsx(Jn,{filter:d}),i==="icon"&&e.jsx(zn,{filter:d})]}):e.jsx(Me,{})}const Yn=o.memo(Zn);function Xn(){const[n,d]=o.useState(localStorage.getItem("logFilterLevel")??"info"),[l,i]=o.useState(localStorage.getItem("logFilterSearch")??"*"),[a,p]=o.useState(localStorage.getItem("logAutoScroll")!=="false"),{setMessages:h,setLogFilters:C,online:t,setAutoScroll:D}=o.useContext(fe),y=x=>{d(x.target.value),C(x.target.value,l),localStorage.setItem("logFilterLevel",x.target.value),r&&console.log("handleChangeLevel called with value:",x.target.value)},I=x=>{i(x.target.value),C(n,x.target.value),localStorage.setItem("logFilterSearch",x.target.value),r&&console.log("handleChangeSearch called with value:",x.target.value)},H=x=>{p(x.target.checked),D(x.target.checked),localStorage.setItem("logAutoScroll",x.target.value?"true":"false"),r&&console.log("handleAutoScrollChange called with value:",x.target.checked)},P=()=>{r&&console.log("handleClearLogsClick called"),h([])};return r&&console.log("Logs rendering..."),t?e.jsxs(St,{name:"Logs",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",margin:"0px",padding:"0px",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx(At,{id:"select-level",style:{color:"var(--div-text-color)"},children:"Filter log by level:"}),e.jsxs(Ke,{style:{height:"30px",backgroundColor:"var(--main-bg-color)"},labelId:"select-level",id:"debug-level",value:n,onChange:y,children:[e.jsx(L,{value:"debug",children:"Debug"}),e.jsx(L,{value:"info",children:"Info"}),e.jsx(L,{value:"notice",children:"Notice"}),e.jsx(L,{value:"warn",children:"Warn"}),e.jsx(L,{value:"error",children:"Error"}),e.jsx(L,{value:"fatal",children:"Fatal"})]}),e.jsx(At,{id:"search",style:{color:"var(--div-text-color)"},children:"Filter log by text:"}),e.jsx(me,{style:{width:"300px"},size:"small",id:"logsearch",variant:"outlined",value:l,onChange:I,InputProps:{style:{height:"30px",padding:"0 0px",backgroundColor:"var(--main-bg-color)"}}}),e.jsx(Ve,{control:e.jsx(Ee,{checked:a,onChange:H}),label:"Auto scroll",style:{color:"var(--div-text-color)"}})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:e.jsx(O,{title:"Clear the logs",children:e.jsx(ie,{onClick:P,endIcon:e.jsx(jt,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Clear"})})})]}),e.jsx("div",{style:{flex:"1",overflow:"auto",margin:"0px",padding:"0px"},children:e.jsx(ir,{})})]}):e.jsx(Me,{})}const ei=o.memo(Xn),ti=({open:n,ip:d,onClose:l,onSave:i})=>{const a=d?d.split(".").slice(0,3).join(".")+".1":"",[p,h]=o.useState("dhcp"),[C,t]=o.useState({ip:d??"",subnet:"255.255.255.0",gateway:a,dns:a}),D=H=>P=>{t({...C,[H]:P.target.value})},y=()=>{l()},I=()=>{i({type:p,...C}),l()};return e.jsxs(Ne,{open:n,onClose:(H,P)=>{P==="backdropClick"||P==="escapeKeyDown"||l()},maxWidth:"sm",style:{maxWidth:"550px",margin:"auto"},children:[e.jsx(Le,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:"Network Configuration"})]})}),e.jsxs($e,{dividers:!0,children:[e.jsxs(tr,{component:"fieldset",fullWidth:!0,children:[e.jsx(je,{component:"legend",children:"Select IP Configuration"}),e.jsxs(rr,{row:!0,value:p,onChange:H=>h(H.target.value),children:[e.jsx(Ve,{value:"dhcp",control:e.jsx(Ct,{}),label:"DHCP"}),e.jsx(Ve,{value:"static",control:e.jsx(Ct,{}),label:"Static"})]})]}),p==="static"&&e.jsxs(He,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(He,{size:6,children:e.jsx(me,{label:"IP Address",fullWidth:!0,value:C.ip,onChange:D("ip")})}),e.jsx(He,{size:6,children:e.jsx(me,{label:"Subnet Mask",fullWidth:!0,value:C.subnet,onChange:D("subnet")})}),e.jsx(He,{size:6,children:e.jsx(me,{label:"Gateway",fullWidth:!0,value:C.gateway,onChange:D("gateway")})}),e.jsx(He,{size:6,children:e.jsx(me,{label:"DNS Server",fullWidth:!0,value:C.dns,onChange:D("dns")})})]})]}),e.jsxs(Oe,{children:[e.jsx(ie,{onClick:y,children:"Cancel"}),e.jsx(ie,{variant:"contained",onClick:I,children:"Save"})]})]})},ri=({open:n,onClose:d,onSave:l})=>{const[i,a]=o.useState(""),[p,h]=o.useState(""),C=P=>{a(P.target.value)},t=P=>{h(P.target.value)},D=i.length>0&&i===p,y=()=>{d()},I=()=>{D&&(l(i),d())},H=()=>{l(""),d()};return e.jsxs(Ne,{open:n,onClose:(P,x)=>{x==="backdropClick"||x==="escapeKeyDown"||d()},maxWidth:"sm",style:{maxWidth:"500px",margin:"auto"},disableEscapeKeyDown:!0,children:[e.jsx(Le,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:"Change Password"})]})}),e.jsx($e,{dividers:!0,children:e.jsx(tr,{component:"fieldset",fullWidth:!0,sx:{margin:0,padding:0,gap:"20px"},children:e.jsxs(He,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(He,{size:12,children:e.jsx(me,{type:"password",autoComplete:"new-password",label:"New Password",size:"small",variant:"outlined",fullWidth:!0,value:i,onChange:C})}),e.jsx(He,{size:12,children:e.jsx(me,{type:"password",autoComplete:"new-password",label:"Confirm Password",size:"small",variant:"outlined",fullWidth:!0,value:p,onChange:t,error:p!==""&&i!==p,helperText:p!==""&&i!==p?"Passwords do not match":""})})]})})}),e.jsxs(Oe,{children:[e.jsx(ie,{onClick:y,children:"Cancel"}),e.jsx(ie,{variant:"contained",onClick:I,disabled:!D,children:"Change"}),e.jsx(ie,{variant:"contained",onClick:H,children:"Reset"})]})]})},ue=500;function oi(){const{online:n,addListener:d,removeListener:l,sendMessage:i,getUniqueId:a}=o.useContext(fe),[p,h]=o.useState(null),[C,t]=o.useState(null),D=o.useRef(a());return o.useEffect(()=>{const y=I=>{r&&console.log("Settings received WebSocket Message:",I),I.method==="refresh_required"&&I.response.changed==="settings"?(r&&console.log(`Settings received refresh_required: changed=${I.response.changed} and sending /api/settings request`),i({id:D.current,sender:"Settings",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):I.method==="/api/settings"&&(r&&console.log("Settings received /api/settings:",I.response),h(I.response.matterbridgeInformation),t(I.response.systemInformation))};return d(y,D.current),r&&console.log("Settings added WebSocket listener"),()=>{l(y),r&&console.log("Settings removed WebSocket listener")}},[d,l,i]),o.useEffect(()=>{n&&(r&&console.log("Settings received online"),i({id:D.current,sender:"Settings",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}))},[n,i]),r&&console.log("Settings rendering..."),!n||!p||!C?e.jsx(Me,{}):e.jsx(St,{name:"Settings",children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"20px",width:"100%"},children:[e.jsx(ni,{matterbridgeInfo:p,systemInfo:C}),e.jsx(ii,{matterbridgeInfo:p}),e.jsx(si,{matterbridgeInfo:p}),e.jsx(ai,{systemInfo:C})]})})}function ni({matterbridgeInfo:n,systemInfo:d}){const{sendMessage:l,getUniqueId:i}=o.useContext(fe),[a,p]=o.useState("bridge"),[h,C]=o.useState("Info"),[t,D]=o.useState(!1),[y,I]=o.useState("dark"),[H,P]=o.useState(localStorage.getItem("homePagePlugins")!=="false"),[x,_]=o.useState(localStorage.getItem("homePageMode")??"devices"),[E,v]=o.useState(localStorage.getItem("virtualMode")??"outlet"),f=o.useRef(i()),[b,R]=o.useState(!1),N=()=>R(!1),k=J=>{r&&console.log("handleSaveNetConfig called with config:",J),l({id:f.current,sender:"Settings",method:"/api/shellynetconfig",src:"Frontend",dst:"Matterbridge",params:J})},[A,T]=o.useState(!1),g=()=>T(!1),s=J=>{r&&console.log("handleSaveChangePassword called with password:",J),l({id:f.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setpassword",value:J}})};o.useEffect(()=>{n&&(p(n.bridgeMode==="bridge"?"bridge":"childbridge"),C(n.loggerLevel.charAt(0).toUpperCase()+n.loggerLevel.slice(1)),D(n.fileLogger),v(n.virtualMode))},[n]),o.useEffect(()=>{const J=localStorage.getItem("frontendTheme");J&&I(J)},[]);const c=J=>{r&&console.log("handleChangeBridgeMode called with value:",J.target.value),p(J.target.value),l({id:f.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setbridgemode",value:J.target.value}})},u=J=>{r&&console.log("handleChangeMbLoggerLevel called with value:",J.target.value),C(J.target.value),l({id:f.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmbloglevel",value:J.target.value}})},F=J=>{r&&console.log("handleLogOnFileMbChange called with value:",J.target.checked),D(J.target.checked),l({id:f.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmblogfile",value:J.target.checked}})},pe=J=>{const ne=J.target.value;r&&console.log("handleChangeTheme called with value:",ne),I(ne),localStorage.setItem("frontendTheme",ne),document.body.setAttribute("frontend-theme",ne)},be=J=>{const ne=J.target.checked;r&&console.log("handleChangeHomePagePlugins called with value:",ne),P(ne),localStorage.setItem("homePagePlugins",ne?"true":"false")},oe=J=>{const ne=J.target.value;r&&console.log("handleChangeHomePageMode called with value:",ne),_(ne),localStorage.setItem("homePageMode",ne)},ye=J=>{const ne=J.target.value;r&&console.log("handleChangeVirtualMode called with value:",ne),v(ne),localStorage.setItem("virtualMode",ne),l({id:f.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setvirtualmode",value:ne}})};return!n||!d?null:e.jsxs(ke,{style:{width:`${ue}px`,maxWidth:`${ue}px`},children:[e.jsx("div",{className:"MbfWindowHeader",children:e.jsx("p",{className:"MbfWindowHeaderText",children:"Matterbridge settings"})}),e.jsx(ti,{open:b,ip:d.ipv4Address,onClose:N,onSave:k}),e.jsx(ri,{open:A,onClose:g,onSave:s}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px",flex:"0 0 auto"},children:e.jsxs(Z,{sx:{gap:"10px",margin:"0px",padding:"10px",width:`${ue-20}px`,backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"matterbridgeInfo-mode",children:"Matterbridge mode:"}),e.jsxs(rr,{row:!0,name:"mode-buttons-group",value:a,onChange:c,children:[e.jsx(Ve,{value:"bridge",control:e.jsx(Ct,{}),label:"Bridge",disabled:n.readOnly===!0}),e.jsx(Ve,{value:"childbridge",control:e.jsx(Ct,{}),label:"Childbridge",disabled:n.readOnly===!0})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"mblogger-level-label",children:"Logger level:"}),e.jsxs(Ke,{style:{height:"30px"},labelId:"mblogger-level-label",id:"mblogger-level",value:h,onChange:u,children:[e.jsx(L,{value:"Debug",children:"Debug"}),e.jsx(L,{value:"Info",children:"Info"}),e.jsx(L,{value:"Notice",children:"Notice"}),e.jsx(L,{value:"Warn",children:"Warn"}),e.jsx(L,{value:"Error",children:"Error"}),e.jsx(L,{value:"Fatal",children:"Fatal"})]}),e.jsx(Ve,{style:{padding:"0px",margin:"0px"},control:e.jsx(Ee,{checked:t,onChange:F,name:"logOnFileMb"}),label:"Log on file:",labelPlacement:"start"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"frontend-theme-label",children:"Frontend theme:"}),e.jsxs(Ke,{style:{height:"30px"},labelId:"frontend-theme-label",id:"frontend-theme",value:y,onChange:pe,children:[e.jsx(L,{value:"classic",children:"Classic"}),e.jsx(L,{value:"light",children:"Light"}),e.jsx(L,{value:"dark",children:"Dark"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"frontend-home-plugin-label",children:"Home page plugins:"}),e.jsx(Ee,{checked:H,onChange:be,name:"showPlugins"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"frontend-home-label",children:"Home page bottom panel:"}),e.jsxs(Ke,{style:{height:"30px"},labelId:"frontend-home-label",id:"frontend-home",value:x,onChange:oe,children:[e.jsx(L,{value:"logs",children:"Logs"}),e.jsx(L,{value:"devices",children:"Devices"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"10px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"frontend-virtual-label",children:"Virtual devices:"}),e.jsxs(Ke,{style:{height:"30px"},labelId:"frontend-virtual-label",id:"frontend-virtual",value:E,onChange:ye,children:[e.jsx(L,{value:"disabled",children:"Disabled"}),e.jsx(L,{value:"outlet",children:"Outlet"}),e.jsx(L,{value:"light",children:"Light"}),e.jsx(L,{value:"switch",children:"Switch"}),e.jsx(L,{value:"mounted_switch",children:"Mounted Switch"})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"20px"},children:e.jsx(ie,{variant:"contained",color:"primary",onClick:()=>T(!0),children:"Change password"})}),n.shellyBoard&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"20px"},children:e.jsx(ie,{variant:"contained",color:"primary",onClick:()=>R(!0),children:"Configure IP"})})]})})]})}function ii({matterbridgeInfo:n}){const{sendMessage:d,getUniqueId:l}=o.useContext(fe),[i,a]=o.useState("Info"),[p,h]=o.useState(!1),[C,t]=o.useState(""),[D,y]=o.useState(""),[I,H]=o.useState(""),[P,x]=o.useState(""),[_,E]=o.useState(""),[v,f]=o.useState(""),b=o.useRef(l());o.useEffect(()=>{n&&(a(["Debug","Info","Notice","Warn","Error","Fatal"][n.matterLoggerLevel]),h(n.matterFileLogger),t(n.matterMdnsInterface||""),y(n.matterIpv4Address||""),H(n.matterIpv6Address||""),x(n.matterPort?n.matterPort.toString():""),E(n.matterDiscriminator?n.matterDiscriminator.toString():""),f(n.matterPasscode?n.matterPasscode.toString():""))},[n]);const R=u=>{r&&console.log("handleChangeMjLoggerLevel called with value:",u.target.value),a(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmjloglevel",value:u.target.value}})},N=u=>{r&&console.log("handleLogOnFileMjChange called with value:",u.target.checked),h(u.target.checked),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmjlogfile",value:u.target.checked}})},k=u=>{r&&console.log("handleChangeMdnsInterface called with value:",u.target.value),t(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmdnsinterface",value:u.target.value}})},A=u=>{r&&console.log("handleChangeIpv4Address called with value:",u.target.value),y(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setipv4address",value:u.target.value}})},T=u=>{r&&console.log("handleChangeIpv6Address called with value:",u.target.value),H(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setipv6address",value:u.target.value}})},g=u=>{r&&console.log("handleChangeMatterPort called with value:",u.target.value),x(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterport",value:u.target.value}})},s=u=>{r&&console.log("handleChangeMatterDiscriminator called with value:",u.target.value),E(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterdiscriminator",value:u.target.value}})},c=u=>{r&&console.log("handleChangemMatterPasscode called with value:",u.target.value),f(u.target.value),d({id:b.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterpasscode",value:u.target.value}})};return n?e.jsxs(ke,{style:{width:`${ue}px`,maxWidth:`${ue}px`},children:[e.jsx("div",{className:"MbfWindowHeader",children:e.jsx("p",{className:"MbfWindowHeaderText",children:"Matter settings"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px",flex:"0 0 auto"},children:e.jsxs(Z,{sx:{gap:"20px",margin:"0px",padding:"10px",width:`${ue-20}px`,backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px"},id:"mjdebug-info",children:"Logger level:"}),e.jsxs(Ke,{style:{height:"30px"},labelId:"select-mjlevel",id:"mjdebug-level",value:i,onChange:R,children:[e.jsx(L,{value:"Debug",children:"Debug"}),e.jsx(L,{value:"Info",children:"Info"}),e.jsx(L,{value:"Notice",children:"Notice"}),e.jsx(L,{value:"Warn",children:"Warn"}),e.jsx(L,{value:"Error",children:"Error"}),e.jsx(L,{value:"Fatal",children:"Fatal"})]}),e.jsx(Ve,{style:{padding:"0px",margin:"0px"},control:e.jsx(Ee,{checked:p,onChange:N,name:"logOnFileMj"}),label:"Log on file:",labelPlacement:"start"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Mdns interface:"}),e.jsx(me,{value:C,onChange:k,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Ipv4 address:"}),e.jsx(me,{value:D,onChange:A,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Ipv6 address:"}),e.jsx(me,{value:I,onChange:T,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning port:"}),e.jsx(me,{value:P,onChange:g,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning discriminator:"}),e.jsx(me,{value:_,onChange:s,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",gap:"15px"},children:[e.jsx(je,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning passcode:"}),e.jsx(me,{value:v,onChange:c,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]})]})})]}):null}function si({matterbridgeInfo:n}){return n?e.jsxs(ke,{style:{width:`${ue}px`,maxWidth:`${ue}px`},children:[e.jsx("div",{className:"MbfWindowHeader",children:e.jsx("p",{className:"MbfWindowHeaderText",children:"Matterbridge info"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px",flex:"0 0 auto"},children:e.jsxs(Z,{sx:{gap:"10px",margin:"0px",padding:"10px",width:"400px",backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsx(Ce,{value:n.matterbridgeVersion,label:"Current Version",width:ue}),e.jsx(Ce,{value:n.matterbridgeLatestVersion,label:"Latest Version",width:ue}),e.jsx(Ce,{value:n.homeDirectory,label:"Home Directory",width:ue}),e.jsx(Ce,{value:n.rootDirectory,label:"Root Directory",width:ue}),e.jsx(Ce,{value:n.matterbridgeDirectory,label:"Matterbridge Storage Directory",width:ue}),e.jsx(Ce,{value:n.matterbridgePluginDirectory,label:"Matterbridge Plugin Directory",width:ue}),e.jsx(Ce,{value:n.globalModulesDirectory,label:"Global Module Directory",width:ue})]})})]}):null}function ai({systemInfo:n}){return n?e.jsxs(ke,{style:{width:`${ue}px`,maxWidth:`${ue}px`},children:[e.jsx("div",{className:"MbfWindowHeader",children:e.jsx("p",{className:"MbfWindowHeaderText",children:"System info"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px",flex:"0 0 auto"},children:e.jsxs(Z,{sx:{gap:"10px",margin:"0px",padding:"10px",width:"400px",backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsx(Ce,{value:n.interfaceName,label:"Interface name",width:ue}),e.jsx(Ce,{value:n.macAddress,label:"MAC Address",width:ue}),e.jsx(Ce,{value:n.ipv4Address,label:"IPv4 Address",width:ue}),e.jsx(Ce,{value:n.ipv6Address,label:"IPv6 Address",width:ue}),e.jsx(Ce,{value:n.nodeVersion,label:"Node Version",width:ue}),e.jsx(Ce,{value:n.hostname,label:"Hostname",width:ue}),e.jsx(Ce,{value:n.user,label:"User",width:ue})]})})]}):null}function Ce({value:n,label:d,width:l}){return e.jsx(me,{focused:!0,value:n,size:"small",label:d,variant:"standard",sx:{width:l?`${l-20}px`:"400px"},InputProps:{readOnly:!0,sx:{color:"var(--div-text-color)","&:before":{borderBottomColor:"var(--main-label-color)"},"&:after":{borderBottomColor:"var(--main-label-color)"}}},InputLabelProps:{sx:{marginTop:"3px",color:"var(--main-label-color)","&.Mui-focused":{color:"var(--main-label-color)"}}}})}const li=o.memo(oi);function di(){const{online:n,sendMessage:d,addListener:l,removeListener:i,getUniqueId:a}=o.useContext(fe),{showSnackbarMessage:p}=o.useContext(_e),[h,C]=o.useState(null),[t,D]=o.useState([]),[y,I]=o.useState([]),[H,P]=o.useState(null),[x,_]=o.useState({cpuUsage:0}),[E,v]=o.useState({totalMemory:"",freeMemory:"",heapTotal:"",heapUsed:"",external:"",arrayBuffers:"",rss:""}),[f,b]=o.useState({systemUptime:"",processUptime:""}),R=o.useRef(a());return r&&console.log("Test uniqueId:",R),o.useEffect(()=>{r&&console.log("Test useEffect WebSocketMessage mounting");const N=k=>{if(k.method==="restart_required")r&&console.log("Test received restart_required"),p("Restart required",0);else if(k.method==="refresh_required")r&&console.log(`Test received refresh_required: changed=${k.response.changed} and sending api requests`),p("Refresh required",0),d({id:R.current,method:"/api/settings",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}}),d({id:R.current,method:"/api/plugins",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}}),d({id:R.current,method:"/api/devices",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}});else if(k.method==="memory_update")r&&console.log("Test received memory_update",k),v(k.response);else if(k.method==="cpu_update")r&&console.log("Test received cpu_update",k),_(k.response);else if(k.method==="uptime_update")r&&console.log("Test received uptime_update",k),b(k.response);else if(k.method==="/api/settings"&&k.response)r&&console.log("Test received /api/settings:",k.response),p("Test received /api/settings",0),C(k.response);else if(k.method==="/api/plugins"&&k.response)r&&console.log(`Test received ${k.response.length} plugins:`,k.response),p("Test received /api/plugins",0),D(k.response);else if(k.method==="/api/devices"&&k.response){r&&console.log(`Test received ${k.response.length} devices:`,k.response),p("Test received /api/devices",0),I(k.response);for(const A of k.response)r&&console.log("Test sending /api/clusters for device:",A.pluginName,A.name,A.endpoint),d({id:R.current,method:"/api/clusters",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{plugin:A.pluginName,endpoint:A.endpoint||0}})}else k.method==="/api/clusters"&&k.response&&(r&&console.log(`Test received ${k.response.clusters.length} clusters for device ${k.response.deviceName} endpoint ${k.response.id}:${k.response.number}:`,k),p(`Test received /api/clusters for ${k.response.plugin}::${k.response.deviceName}`,0),P(k.response))};return l(N,R.current),r&&console.log("Test useEffect WebSocketMessage mounted"),()=>{r&&console.log("Test useEffect WebSocketMessage unmounting"),i(N),r&&console.log("Test useEffect WebSocketMessage unmounted")}},[l,i,d,p]),o.useEffect(()=>(r&&console.log("Test useEffect online mounting"),n&&r&&console.log("Test useEffect online received online"),r&&console.log("Test useEffect online mounted"),()=>{r&&console.log("Test useEffect online unmounted")}),[n,d,p]),r&&console.log("Test rendering..."),n?e.jsx("div",{className:"MbfPageDiv",style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",width:"100%"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"256px",width:"256px",margin:"10px"}}),e.jsx("p",{children:"Welcome to the Test page of the Matterbridge frontend"})]})}):e.jsx(Me,{})}const ci=o.memo(di);function ui(n,d){r&&console.log("getCssVariable:",n,"defaultValue",d);const l=getComputedStyle(document.body).getPropertyValue(n).trim();return l||console.error("getCssVariable: undefined",l),l||d}function pi(n){return co({palette:{primary:{main:n},action:{disabled:"var(--main-label-color)"},text:{disabled:"var(--main-label-color)"}},typography:{fontFamily:"Roboto, Helvetica, Arial, sans-serif"},components:{MuiDialog:{styleOverrides:{paper:{color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",border:"2px solid var(--div-border-color)",borderRadius:"var(--div-border-radius)",boxShadow:"2px 2px 5px var(--div-shadow-color)"}}},MuiTooltip:{defaultProps:{placement:"top-start",arrow:!0}},MuiButton:{styleOverrides:{root:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)","&:hover":{backgroundColor:"var(--main-button-bg-color)"},"&.Mui-disabled":{color:"var(--main-button-color)",backgroundColor:"var(--main-grey-color)"}},contained:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},outlined:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},text:{color:"var(--main-button-color)"}},defaultProps:{variant:"contained",size:"small"}},MuiIconButton:{styleOverrides:{root:{color:"var(--main-icon-color)","&:hover .MuiSvgIcon-root":{color:"var(--primary-color)"}}}},MuiCheckbox:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-checked":{color:"var(--primary-color)"}}}},MuiTextField:{defaultProps:{size:"small",variant:"outlined",fullWidth:!0}},MuiOutlinedInput:{styleOverrides:{root:{backgroundColor:"var(--div-bg-color)","& .MuiOutlinedInput-notchedOutline":{borderColor:"var(--main-label-color)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"var(--main-text-color)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"var(--primary-color)"},padding:"0px"},input:{color:"var(--div-text-color)",padding:"4px 8px"}}},MuiInputLabel:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-focused":{color:"var(--primary-color)"}}}},MuiFormLabel:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-focused":{color:"var(--main-label-color)"}}}},MuiFormControl:{styleOverrides:{root:{color:"var(--main-grey-color)"}}},MuiRadio:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-checked":{color:"var(--primary-color)"}}}},MuiSelect:{styleOverrides:{root:{backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)",height:"30px","&:hover":{borderColor:"var(--main-text-color)"},"&.Mui-focused":{borderColor:"var(--primary-color)"}}}},MuiMenu:{styleOverrides:{paper:{backgroundColor:"var(--main-menu-bg-color)",padding:"0px",margin:"0px"},list:{padding:"0px"}}},MuiMenuItem:{styleOverrides:{root:{color:"var(--main-menu-color)",backgroundColor:"var(--main-menu-bg-color)","&:hover":{backgroundColor:"var(--main-menu-hover-color)"},"&.Mui-selected":{color:"var(--main-menu-color)",backgroundColor:"var(--main-menu-bg-color)"},"&.Mui-selected:hover":{backgroundColor:"var(--main-menu-hover-color)"}}}},MuiListItemButton:{styleOverrides:{root:{cursor:"pointer","&:hover":{backgroundColor:"var(--main-bg-color)"}}}},MuiListItemIcon:{styleOverrides:{root:{color:"var(--div-text-color)"}}},MuiListItemText:{styleOverrides:{primary:{fontSize:"16px",fontWeight:"bold",color:"var(--div-text-color)"},secondary:{fontSize:"14px",fontWeight:"normal",color:"var(--div-text-color)"}}}}})}function gi(){const{mobile:n,showSnackbarMessage:d,showConfirmCancelDialog:l}=o.useContext(_e),{online:i,sendMessage:a,logMessage:p,addListener:h,removeListener:C,getUniqueId:t}=o.useContext(fe),[D,y]=o.useState(!1),[I,H]=o.useState(!1),[P,x]=o.useState(!1),[_,E]=o.useState(!1),[v,f]=o.useState(null),b=o.useRef(t()),[R,N]=o.useState(null),[k,A]=o.useState(null),[T,g]=o.useState(null),[s,c]=o.useState(null),[u,F]=o.useState(null),pe=()=>{window.open("https://www.buymeacoffee.com/luligugithub","_blank")},be=()=>{window.open("https://github.com/Luligu/matterbridge/blob/main/README.md","_blank")},oe=()=>{v?.matterbridgeInformation.matterbridgeVersion.includes("-dev-")?window.open("https://github.com/Luligu/matterbridge/blob/dev/CHANGELOG.md","_blank"):window.open("https://github.com/Luligu/matterbridge/blob/main/CHANGELOG.md","_blank")},ye=()=>{window.open("https://discord.gg/QX58CDe6hd","_blank")},J=()=>{window.open("https://github.com/Luligu/matterbridge","_blank")},ne=()=>{a({id:b.current,sender:"Header",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:"matterbridge",restart:!0}})},$=()=>{a({id:b.current,sender:"Header",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:"matterbridge@dev",restart:!0}})},G=()=>{a({id:b.current,sender:"Header",method:"/api/checkupdates",src:"Frontend",dst:"Matterbridge",params:{}})},W=()=>{r&&console.log("Header: handleShellySystemUpdateClick"),p("Matterbridge","Installing system updates..."),a({id:b.current,sender:"Header",method:"/api/shellysysupdate",src:"Frontend",dst:"Matterbridge",params:{}})},S=()=>{r&&console.log("Header: handleShellyMainUpdateClick"),p("Matterbridge","Installing software updates..."),a({id:b.current,sender:"Header",method:"/api/shellymainupdate",src:"Frontend",dst:"Matterbridge",params:{}})},j=()=>{r&&console.log("Header: handleShellyCreateSystemLog"),a({id:b.current,sender:"Header",method:"/api/shellycreatesystemlog",src:"Frontend",dst:"Matterbridge",params:{}})},M=()=>{r&&console.log("Header: handleShellyDownloadSystemLog"),p("Matterbridge","Downloading Shelly system log..."),d("Downloading Shelly system log...",5),window.location.href="./api/shellydownloadsystemlog"},V=()=>{v?.matterbridgeInformation.restartMode===""?a({id:b.current,sender:"Header",method:"/api/restart",src:"Frontend",dst:"Matterbridge",params:{}}):a({id:b.current,sender:"Header",method:"/api/shutdown",src:"Frontend",dst:"Matterbridge",params:{}})},B=()=>{a({id:b.current,sender:"Header",method:"/api/shutdown",src:"Frontend",dst:"Matterbridge",params:{}})},ce=()=>{a({id:b.current,sender:"Header",method:"/api/reboot",src:"Frontend",dst:"Matterbridge",params:{}})},ae=()=>{a({id:b.current,sender:"Header",method:"/api/softreset",src:"Frontend",dst:"Matterbridge",params:{}})},le=()=>{a({id:b.current,sender:"Header",method:"/api/hardreset",src:"Frontend",dst:"Matterbridge",params:{}})},ge=w=>{N(w.currentTarget)},q=w=>{r&&console.log("Header: handleMenuClose",w),N(null),w==="download-mblog"?(p("Matterbridge","Downloading matterbridge log..."),d("Downloading matterbridge log...",5),window.location.href="./api/download-mblog"):w==="download-mjlog"?(p("Matterbridge","Downloading matter log..."),d("Downloading matter log...",5),window.location.href="./api/download-mjlog"):w==="view-mblog"?(p("Matterbridge","Loading matterbridge log..."),d("Loading matterbridge log...",5),window.location.href="./api/view-mblog"):w==="view-mjlog"?(p("Matterbridge","Loading matter log..."),d("Loading matter log...",5),window.location.href="./api/view-mjlog"):w==="view-shellylog"?(p("Matterbridge","Loading shelly system log..."),d("Loading shelly system log...",5),window.location.href="./api/shellyviewsystemlog"):w==="download-mbstorage"?(p("Matterbridge","Downloading matterbridge storage..."),d("Downloading matterbridge storage...",5),window.location.href="./api/download-mbstorage"):w==="download-pluginstorage"?(p("Matterbridge","Downloading matterbridge plugins storage..."),d("Downloading matterbridge plugins storage...",5),window.location.href="./api/download-pluginstorage"):w==="download-pluginconfig"?(p("Matterbridge","Downloading matterbridge plugins config..."),d("Downloading matterbridge plugins config...",5),window.location.href="./api/download-pluginconfig"):w==="download-mjstorage"?(p("Matterbridge","Downloading matter storage..."),d("Downloading matter storage...",5),window.location.href="./api/download-mjstorage"):w==="download-backup"?(p("Matterbridge","Downloading backup..."),d("Downloading backup...",10),window.location.href="./api/download-backup"):w==="update"?ne():w==="updatedev"?$():w==="updatecheck"?G():w==="shelly-sys-update"?W():w==="shelly-main-update"?S():w==="shelly-create-system-log"?j():w==="shelly-download-system-log"?M():w==="softreset"?ae():w==="hardreset"?le():w==="restart"?V():w==="shutdown"?B():w==="reboot"?ce():w==="create-backup"?a({id:b.current,sender:"Header",method:"/api/create-backup",src:"Frontend",dst:"Matterbridge",params:{}}):w==="unregister"?a({id:b.current,sender:"Header",method:"/api/unregister",src:"Frontend",dst:"Matterbridge",params:{}}):w==="reset"?a({id:b.current,sender:"Header",method:"/api/reset",src:"Frontend",dst:"Matterbridge",params:{}}):w==="factoryreset"&&a({id:b.current,sender:"Header",method:"/api/factoryreset",src:"Frontend",dst:"Matterbridge",params:{}})},z=w=>{r&&console.log("Header: handleMenuCloseCancel:",w),N(null)},m=w=>{A(w.currentTarget)},he=()=>{A(null)},ve=w=>{g(w.currentTarget)},de=()=>{g(null)},Y=w=>{c(w.currentTarget)},re=()=>{c(null)},Ie=w=>{F(w.currentTarget)},De=()=>{F(null)},Ye=()=>{xi(),r&&console.log("Matterbridge logo clicked: debug is now",r)};return o.useEffect(()=>{const w=X=>{r&&console.log("Header received WebSocket Message:",X),X.method==="/api/settings"&&X.id===b.current?(r&&console.log("Header received settings:",X.response),f(X.response),y(X.response.matterbridgeInformation.restartRequired||X.response.matterbridgeInformation.fixedRestartRequired),H(X.response.matterbridgeInformation.fixedRestartRequired),x(X.response.matterbridgeInformation.updateRequired)):X.method==="refresh_required"&&X.response.changed==="settings"?(r&&console.log(`Header received refresh_required: changed=${X.response.changed} and sending /api/settings request`),a({id:b.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):X.method==="restart_required"?(r&&console.log(`Header received restart_required with fixed: ${X.response.fixed}`),y(!0),X.response.fixed===!0&&H(!0)):X.method==="restart_not_required"?(r&&console.log("Header received restart_not_required"),y(!1)):X.method==="update_required"?(r&&console.log("Header received update_required"),X.response.devVersion===!0?E(!0):x(!0),a({id:b.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):X.method==="shelly_sys_update"?(r&&console.log("Header received WS_ID_SHELLY_SYS_UPDATE:"),f(we=>we?{matterbridgeInformation:{...we.matterbridgeInformation,shellySysUpdate:X.response.available},systemInformation:we.systemInformation}:null)):X.method==="shelly_main_update"&&(r&&console.log("Header received WS_ID_SHELLY_MAIN_UPDATE:"),f(we=>we?{matterbridgeInformation:{...we.matterbridgeInformation,shellyMainUpdate:X.response.available},systemInformation:we.systemInformation}:null))};return h(w,b.current),r&&console.log(`Header added WebSocket listener id ${b.current}`),()=>{C(w),r&&console.log("Header removed WebSocket listener")}},[h,C,a,d]),o.useEffect(()=>{i&&(r&&console.log("Header sending /api/settings requests"),a({id:b.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}))},[i,a]),r&&console.log("Header rendering... mobile %s",n),!i||!v?null:e.jsxs("div",{className:"header",style:{},children:[e.jsxs("div",{className:"sub-header",children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"30px"},onClick:Ye}),e.jsx("h2",{style:{fontSize:"22px",color:"var(--main-icon-color)",margin:"0px"},children:"Matterbridge"}),e.jsxs("nav",{children:[e.jsx(nt,{to:"/",className:"nav-link",children:"Home"}),e.jsx(nt,{to:"/devices",className:"nav-link",children:"Devices"}),e.jsx(nt,{to:"/log",className:"nav-link",children:"Logs"}),e.jsx(nt,{to:"/settings",className:"nav-link",children:"Settings"})]})]}),e.jsxs("div",{className:"sub-header",children:[!v.matterbridgeInformation.readOnly&&P&&e.jsx(O,{title:"New Matterbridge version available, click to install",children:e.jsxs("span",{className:"status-warning",onClick:ne,children:["Update to v.",v.matterbridgeInformation.matterbridgeLatestVersion]})}),!v.matterbridgeInformation.readOnly&&_&&e.jsx(O,{title:"New Matterbridge dev version available, click to install",children:e.jsxs("span",{className:"status-warning",onClick:$,children:["Update to new dev v.",v.matterbridgeInformation.matterbridgeDevVersion.split("-dev-")[0]]})}),!v.matterbridgeInformation.readOnly&&e.jsx(O,{title:"Matterbridge version, click to see the changelog",children:e.jsxs("span",{className:"status-information",onClick:oe,children:["v.",v.matterbridgeInformation.matterbridgeVersion]})}),v.matterbridgeInformation.shellyBoard&&e.jsx("img",{src:"Shelly.svg",alt:"Shelly Icon",style:{height:"30px",padding:"0px",margin:"0px",marginRight:"30px"}}),v.matterbridgeInformation.bridgeMode!==""&&v.matterbridgeInformation.readOnly===!1?e.jsx(O,{title:"Bridge mode",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:v.matterbridgeInformation.bridgeMode})}):null,v.matterbridgeInformation.restartMode!==""&&v.matterbridgeInformation.readOnly===!1?e.jsx(O,{title:"Restart mode",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:v.matterbridgeInformation.restartMode})}):null,v.matterbridgeInformation.profile&&v.matterbridgeInformation.profile!==""&&v.matterbridgeInformation.readOnly===!1?e.jsx(O,{title:"Current profile",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:v.matterbridgeInformation.profile})}):null]}),e.jsxs("div",{className:"sub-header",style:{gap:"5px"},children:[v.matterbridgeInformation.readOnly===!1?e.jsx(O,{title:"Matterbridge discord group",children:e.jsx("img",{src:"discord.svg",alt:"Discord Logo",style:{cursor:"pointer",height:"25px"},onClick:ye})}):null,v.matterbridgeInformation.readOnly===!1?e.jsx(O,{title:"Give a star to Matterbridge",children:e.jsx(K,{style:{color:"#FFD700",margin:"0",padding:"0"},onClick:J,children:e.jsx(uo,{})})}):null,v.matterbridgeInformation.readOnly===!1?e.jsx(O,{title:"Sponsor Matterbridge",children:e.jsx(K,{style:{color:"#b6409c",margin:"0",padding:"0"},onClick:pe,children:e.jsx(Yt,{})})}):null,e.jsx(O,{title:"Matterbridge help",children:e.jsx(K,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:be,children:e.jsx(po,{})})}),e.jsx(O,{title:"Matterbridge changelog",children:e.jsx(K,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:oe,children:e.jsx(er,{})})}),v.matterbridgeInformation&&!v.matterbridgeInformation.readOnly&&e.jsx(O,{title:"Update matterbridge to latest version",children:e.jsx(K,{style:{color:P?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:ne,children:e.jsx(Re,{})})}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&v.matterbridgeInformation.shellySysUpdate&&e.jsx(O,{title:"Shelly system update",children:e.jsx(K,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:W,children:e.jsx(Re,{})})}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&v.matterbridgeInformation.shellyMainUpdate&&e.jsx(O,{title:"Shelly software update",children:e.jsx(K,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:S,children:e.jsx(Re,{})})}),e.jsx(O,{title:"Restart matterbridge",children:e.jsx(K,{style:{color:D||I?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:V,children:e.jsx(vt,{})})}),v.matterbridgeInformation.restartMode===""?e.jsx(O,{title:"Shut down matterbridge",children:e.jsx(K,{style:{color:D||I?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:B,children:e.jsx(Ae,{})})}):null,e.jsx(O,{title:"Download, backup and more",children:e.jsx(K,{onClick:ge,children:e.jsx(go,{style:{color:"var(--main-icon-color)"}})})}),e.jsxs(Ge,{id:"command-menu",anchorEl:R,keepMounted:!0,open:!!R,onClose:()=>q(""),children:[v.matterbridgeInformation&&!v.matterbridgeInformation.readOnly&&e.jsxs(L,{onClick:()=>q("update"),children:[e.jsx(Q,{children:e.jsx(Re,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Install latest stable",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&!v.matterbridgeInformation.readOnly&&e.jsxs(L,{onClick:()=>q("updatedev"),children:[e.jsx(Q,{children:e.jsx(Re,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Install latest dev",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&!v.matterbridgeInformation.readOnly&&e.jsxs(L,{onClick:()=>q("updatecheck"),children:[e.jsx(Q,{children:e.jsx(Re,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Check for updates",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&v.matterbridgeInformation.shellySysUpdate&&e.jsxs(L,{onClick:()=>q("shelly-sys-update"),children:[e.jsx(Q,{children:e.jsx(Re,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shelly system update",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&v.matterbridgeInformation.shellyMainUpdate&&e.jsxs(L,{onClick:()=>q("shelly-main-update"),children:[e.jsx(Q,{children:e.jsx(Re,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shelly software update",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>q("restart"),children:[e.jsx(Q,{children:e.jsx(vt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Restart",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation.restartMode===""?e.jsxs(L,{onClick:()=>q("shutdown"),children:[e.jsx(Q,{children:e.jsx(Ae,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shutdown",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}):null,v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&e.jsxs(L,{onClick:()=>{l("Reboot","Are you sure you want to reboot the Shelly board?","reboot",q,z)},children:[e.jsx(Q,{children:e.jsx(vt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reboot...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsx(dt,{}),e.jsxs(L,{onClick:ve,children:[e.jsx(Q,{children:e.jsx(ct,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"View",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(Ge,{id:"sub-menu-view",anchorEl:T,keepMounted:!0,open:!!T,onClose:de,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(L,{onClick:()=>{q("view-mblog"),de()},children:[e.jsx(Q,{children:e.jsx(ct,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("view-mjlog"),de()},children:[e.jsx(Q,{children:e.jsx(ct,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matter log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&e.jsxs(L,{onClick:()=>{q("view-shellylog"),de()},children:[e.jsx(Q,{children:e.jsx(ct,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(dt,{}),e.jsxs(L,{onClick:Y,children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Download",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(Ge,{id:"sub-menu-download",anchorEl:s,keepMounted:!0,open:!!s,onClose:re,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(L,{onClick:()=>{q("download-mbstorage"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("download-pluginstorage"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge plugins storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("download-pluginconfig"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge plugins config",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("download-mblog"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matterbridge log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("download-mjstorage"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matter storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("download-mjlog"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Matter log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&e.jsxs(L,{onClick:()=>{q("shelly-create-system-log"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Create Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&e.jsxs(L,{onClick:()=>{q("shelly-download-system-log"),re()},children:[e.jsx(Q,{children:e.jsx(Pe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Download Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(dt,{}),e.jsxs(L,{onClick:m,children:[e.jsx(Q,{children:e.jsx(kt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(Ge,{id:"sub-menu-backup",anchorEl:k,keepMounted:!0,open:!!k,onClose:he,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(L,{onClick:()=>{q("create-backup"),he()},children:[e.jsx(Q,{children:e.jsx(kt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Create backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{q("download-backup"),he()},children:[e.jsx(Q,{children:e.jsx(kt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Download backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(dt,{}),e.jsxs(L,{onClick:Ie,children:[e.jsx(Q,{children:e.jsx(mo,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(Ge,{id:"sub-menu-reset",anchorEl:u,keepMounted:!0,open:!!u,onClose:De,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(L,{onClick:()=>{De(),l("Reset all devices and shutdown","Are you sure you want to unregister all devices? This will temporarily remove all devices from the controller and you may loose the controller configuration.","unregister",q,z)},children:[e.jsx(Q,{children:e.jsx(Ae,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset all devices...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(L,{onClick:()=>{De(),l("Reset commissioning and shutdown","Are you sure you want to reset the commissioning? You will have to manually remove Matterbridge from the controller.","reset",q,z)},children:[e.jsx(Q,{children:e.jsx(Ae,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset commissioning...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),!v.matterbridgeInformation.readOnly&&e.jsxs(L,{onClick:()=>{De(),l("Factory reset and shutdown","Are you sure you want to factory reset Matterbridge? You will have to manually remove Matterbridge from the controller.","factoryreset",q,z)},children:[e.jsx(Q,{children:e.jsx(Ae,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Factory reset...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&e.jsxs(L,{onClick:()=>{De(),l("Network reset","Are you sure you want to factory reset the network parameters?","softreset",q,z)},children:[e.jsx(Q,{children:e.jsx(Ae,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Reset network...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),v.matterbridgeInformation&&v.matterbridgeInformation.shellyBoard&&e.jsxs(L,{onClick:()=>{De(),l("Factory reset","Are you sure you want to factory reset Matterbridge? You will have to manually remove Matterbridge from the controller.","hardreset",q,z)},children:[e.jsx(Q,{children:e.jsx(Ae,{style:{color:"var(--main-icon-color)"}})}),e.jsx(ee,{primary:"Factory reset...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]})]})]})]})}const mi=o.memo(gi),sr=1200,ar=800;let Pt,Nt;function hi(){if(typeof window<"u"){Pt=Math.floor(window.visualViewport?.width??window.innerWidth),Nt=Math.floor(window.visualViewport?.height??window.innerHeight);const n=Pt<sr||Nt<ar;return r&&console.log("Visual viewport width %i height %i mobile %s",Pt,Nt,n),n}return!1}function fi({children:n}){const{mobile:d,setMobile:l}=o.useContext(_e);return o.useEffect(()=>{function i(){l(hi())}return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[l]),r&&console.log("MbfScreen rendering... mobile %s",d),e.jsxs("div",{style:{display:"flex",flexDirection:"column",overflow:"hidden",width:d?`${sr}px`:"calc(100vw - 40px)",height:d?`${ar}px`:"calc(100vh - 40px)",margin:"0px",padding:"20px",gap:"20px"},children:[e.jsx(mi,{}),e.jsx("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"calc(100% - 60px)",margin:"0px",padding:"0px",gap:"20px"},children:n})]})}let r=!1;const xi=()=>{r=!r},bi=!1;function vi({setLoggedIn:n}){const[d,l]=o.useState(""),[i,a]=o.useState(""),p={display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"var(--main-bg-color)"},h={display:"flex",flexDirection:"column",maxWidth:"400px",margin:"0 auto",padding:"20px",gap:"20px",border:"1px solid var(--div-border-color)",borderRadius:"var(--div-border-radius)",boxShadow:"2px 2px 5px var(--div-shadow-color)",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},C={margin:"10px 0",padding:"3px 3px",fontSize:"14px",width:"230px",border:"1px solid var(--main-label-color)",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},t=async y=>{try{const I=await fetch("./api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:y})});if(I.ok){const{valid:H}=await I.json();H?n(!0):y!==""&&a("Incorrect password!")}else console.error("Failed to log in:",I.statusText)}catch(I){console.error("Failed to log in:",I)}},D=y=>{y.preventDefault(),t(d)};return t(""),e.jsx("div",{style:p,children:e.jsxs("form",{onSubmit:D,style:h,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"64px",width:"64px"}}),e.jsx("h3",{style:{color:"var(--div-text-color)"},children:"Welcome to Matterbridge"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:"20px"},children:[e.jsx("input",{type:"text",name:"username",autoComplete:"username",style:{display:"none"},tabIndex:-1}),e.jsx("input",{type:"password",value:d,onChange:y=>l(y.target.value),style:C,placeholder:"password",autoComplete:"current-password"}),e.jsx("button",{type:"submit",style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",borderColor:"var(--div-bg-color)"},children:"Log in"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",margin:0,height:"30px"},children:i&&e.jsx("p",{style:{color:"red"},children:i})})]})})}function yi(){const[n,d]=o.useState(!1),l=localStorage.getItem("frontendTheme")||"dark";r&&console.log('Setting frontend theme "%s"',l),document.body.setAttribute("frontend-theme",l);const i=ui("--primary-color","#1976d2");r&&console.log('Primary color from CSS "%s"',i);const a=pi(i),p=window.location.pathname.includes("/matterbridge/")?"/matterbridge":window.location.href.includes("/api/hassio_ingress/")?window.location.pathname:"/";return r&&(console.log("Loading App..."),console.log(`- with href = "${window.location.href}"`),console.log(`- pathname = "${window.location.pathname}"`),console.log(`- baseName = "${p}"`)),n?e.jsx(ho,{theme:a,children:e.jsx(Sr,{dense:!0,maxSnack:10,preventDuplicate:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(Zo,{children:e.jsx(Yo,{children:e.jsx(br,{basename:p,children:e.jsx(fi,{children:e.jsxs(vr,{children:[e.jsx(qe,{path:"/",element:e.jsx(Nn,{})}),e.jsx(qe,{path:"/devices",element:e.jsx(Yn,{})}),e.jsx(qe,{path:"/log",element:e.jsx(ei,{})}),e.jsx(qe,{path:"/settings",element:e.jsx(li,{})}),e.jsx(qe,{path:"/test",element:e.jsx(ci,{})}),e.jsx(qe,{path:"*",element:e.jsx(yr,{to:"/"})})]})})})})})})}):e.jsx(vi,{setLoggedIn:d})}jr.createRoot(document.getElementById("root")).render(e.jsx(Cr.StrictMode,{children:e.jsx(yi,{})}));
