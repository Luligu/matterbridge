<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Matterbridge</title>
  <link rel="icon" type="image/svg+xml" href="https://matterbridge.io/assets/matterbridge.svg">
  <style>
    body {
      font-family: Roboto, Arial, 'Helvetica Neue', sans-serif;
      line-height: 1.6;
      margin: 40px;
    }
    h1, h2, h3 {
      font-family: 'Roboto Slab', Roboto, Arial, 'Helvetica Neue', sans-serif;
      color: #263238;
      scroll-margin-top: 90px;
      margin-top: 2.5rem;
      margin-bottom: 1rem;
    }
    h1 {
      font-size: 2.4rem;
      font-weight: 700;
      letter-spacing: -0.01em;
      position: relative;
      padding-bottom: 1.1rem;
    }
    h2 {
      font-size: 1.8rem;
      font-weight: 600;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.35rem;
      color: #41535b;
    }
    h3 {
      font-size: 1.10rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #455a64;
    }
    pre {
      background: #e4e7ec;
      color: #000000;
      padding: 10px 56px 10px 10px;
      border-radius: 0.5rem;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 0.875rem;
      margin: 10px 20px 10px 0px;
      position: relative;
    }
    .copy-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      padding: 0;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #eee;
      color: #333;
      position: absolute;
      top: 8px;
      right: 8px;
      transition: color 0.2s ease;
    }
    .copy-btn svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }
    .copy-btn.copied {
      color: #1b5e20;
    }

    table {
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th,
    td {
      border: 1px solid #e0e0e0;
      padding: 0.4rem 0.6rem;
      text-align: left;
      vertical-align: top;
    }
  </style>
</head>
<body>
<h1 id="img-srchttpsmatterbridgeioassetsmatterbridgesvg-altmatterbridge-logo-width64px-height64pxnbspnbspnbspmatterbridge-docker-configuration"><img src="https://matterbridge.io/assets/matterbridge.svg" alt="Matterbridge Logo" width="64px" height="64px">&nbsp;&nbsp;&nbsp;Matterbridge Docker configuration</h1>
<p><a href="https://www.npmjs.com/package/matterbridge"><img src="https://img.shields.io/npm/v/matterbridge.svg" alt="npm version"></a>
<a href="https://www.npmjs.com/package/matterbridge"><img src="https://img.shields.io/npm/dt/matterbridge.svg" alt="npm downloads"></a>
<a href="https://hub.docker.com/r/luligu/matterbridge"><img src="https://img.shields.io/docker/v/luligu/matterbridge/latest?label=docker%20version" alt="Docker Version"></a>
<a href="https://hub.docker.com/r/luligu/matterbridge"><img src="https://img.shields.io/docker/pulls/luligu/matterbridge?label=docker%20pulls" alt="Docker Pulls"></a>
<img src="https://github.com/Luligu/matterbridge/actions/workflows/build.yml/badge.svg" alt="Node.js CI">
<img src="https://github.com/Luligu/matterbridge/actions/workflows/codeql.yml/badge.svg" alt="CodeQL">
<a href="https://codecov.io/gh/Luligu/matterbridge"><img src="https://codecov.io/gh/Luligu/matterbridge/branch/main/graph/badge.svg" alt="codecov"></a></p>
<p><a href="https://www.npmjs.com/package/matter-history"><img src="https://img.shields.io/badge/powered%20by-matter--history-blue" alt="powered by"></a>
<a href="https://www.npmjs.com/package/node-ansi-logger"><img src="https://img.shields.io/badge/powered%20by-node--ansi--logger-blue" alt="powered by"></a>
<a href="https://www.npmjs.com/package/node-persist-manager"><img src="https://img.shields.io/badge/powered%20by-node--persist--manager-blue" alt="powered by"></a></p>
<hr>
<h1 id="production-configuration">Production configuration</h1>
<h2 id="run-matterbridge-with-docker-and-docker-compose">Run Matterbridge with Docker and Docker Compose</h2>
<p>The Matterbridge Docker images (multi-arch manifest list for <strong>linux/amd64</strong> and <strong>linux/arm64</strong>) are published on <a href="https://hub.docker.com/r/luligu/matterbridge"><strong>Docker Hub</strong></a>. If you use them, please consider starring the project on <a href="https://hub.docker.com/r/luligu/matterbridge"><strong>Docker Hub</strong></a>.</p>
<p>The image (tag <strong>latest</strong>) includes Matterbridge and all official plugins, using the latest release published on npm. It is based on <code>node:22-bookworm-slim</code>. Since all official plugins are included, you can select and add a plugin without installing anything.</p>
<p>The image (tag <strong>dev</strong>) includes Matterbridge and all official plugins from the latest push on GitHub. It is based on <code>node:22-bookworm-slim</code>. Since all official plugins are included, you can select and add a plugin without installing anything. Note: if you update to the latest <strong>dev</strong> from the frontend, you will override the GitHub version with the latest <strong>dev</strong> published on npm.</p>
<p>The image (tag <strong>ubuntu</strong>) includes only Matterbridge, using the latest release published on npm. This image (<strong>for test and development only</strong>) is based on <code>ubuntu:latest</code> with Node.js 24 from NodeSource. Plugins are not included in the image; they will be installed on first run. This image preinstalls <code>bluetooth</code>, <code>build-essential</code>, and <code>python</code> packages (useful for plugins that require native builds).</p>
<p>The image (tag <strong>alpine</strong>) includes only Matterbridge, using the latest release published on npm. This image (<strong>for test and development only</strong>) is based on <code>node:24-alpine</code>. Plugins are not included in the image; they will be installed on first run.</p>
<h3 id="docker-health-check">Docker health check</h3>
<p>All images include a health check.</p>
<p>How health checks work in different scenarios:</p>
<ul>
<li>With Docker Compose: Docker monitors the health check and can restart the container (depending on your restart policy).</li>
<li>With <code>docker run</code>: the health check still runs, but the container will not restart automatically when it becomes unhealthy.</li>
</ul>
<p>You can manually check the health status:</p>
<pre><code class="language-bash">docker exec -it matterbridge curl -v http://localhost:8283/health
</code></pre>
<h3 id="create-the-matterbridge-directories-first">Create the Matterbridge directories first</h3>
<p>This creates the required directories in your home directory (if they don&#39;t already exist):</p>
<pre><code class="language-bash">cd ~
mkdir -p ~/Matterbridge
mkdir -p ~/.matterbridge
mkdir -p ~/.mattercert
sudo chown -R $USER:$USER ~/Matterbridge ~/.matterbridge ~/.mattercert
</code></pre>
<p>You may need to adapt the paths to your setup.</p>
<h3 id="add-your-user-to-the-docker-group">Add your user to the docker group</h3>
<p>If you don&#39;t want to use sudo with docker commands, run this command:</p>
<pre><code class="language-bash">sudo groupadd docker
sudo usermod -aG docker $USER
</code></pre>
<p>After adding your user to the <code>docker</code> group, log out and log back in so your current session picks up the new group membership.</p>
<h3 id="run-the-container">Run the container</h3>
<p>The container must have full access to the host network (needed for mDNS and the Matter protocol).</p>
<pre><code class="language-bash">sudo docker run --name matterbridge \
  -v ~/Matterbridge:/root/Matterbridge \
  -v ~/.matterbridge:/root/.matterbridge \
  -v ~/.mattercert:/root/.mattercert \
  --network host --restart always -d luligu/matterbridge:latest
</code></pre>
<p>You may need to adapt the paths to your setup.</p>
<h3 id="run-the-container-with-extra-parameters-eg-frontend-on-port-8585">Run the container with extra parameters (e.g. frontend on port 8585)</h3>
<pre><code class="language-bash">sudo docker run --name matterbridge \
  -v ~/Matterbridge:/root/Matterbridge \
  -v ~/.matterbridge:/root/.matterbridge \
  -v ~/.mattercert:/root/.mattercert \
  --network host --restart always -d luligu/matterbridge:latest \
  matterbridge --docker --frontend 8585
</code></pre>
<p>If you override the command, always start it with <code>matterbridge --docker</code>.</p>
<p><strong>If you change the frontend port, overriding the default command of the images, docker will report the container unhealty unless you add the --no-healthcheck param</strong>.</p>
<h3 id="run-with-docker-compose">Run with Docker Compose</h3>
<p>The <code>docker-compose.yml</code> file is available in the <code>docker</code> directory of this repository:</p>
<pre><code class="language-yaml">services:
  matterbridge:
    container_name: matterbridge
    image: luligu/matterbridge:latest                         # Matterbridge image with the tag latest
    network_mode: host                                        # Ensures the Matter mDNS works
    restart: always                                           # Ensures the container always restarts automatically
    volumes:
      - &quot;${HOME}/Matterbridge:/root/Matterbridge&quot;             # Mounts the Matterbridge plugin directory
      - &quot;${HOME}/.matterbridge:/root/.matterbridge&quot;           # Mounts the Matterbridge storage directory
      - &quot;${HOME}/.mattercert:/root/.mattercert&quot;               # Mounts the Matterbridge certificate directory
</code></pre>
<p>Copy it to your home directory or edit your existing compose file to add the Matterbridge service.</p>
<p>Then start Docker Compose with:</p>
<pre><code class="language-bash">docker compose up -d
</code></pre>
<p>Or start only the Matterbridge container with:</p>
<pre><code class="language-bash">docker compose up -d matterbridge
</code></pre>
<p>If you need to start Matterbridge with extra parameters (e.g. frontend on port 8585), override the default command by adding a <code>command</code> line to the service:</p>
<pre><code class="language-yaml">services:
  matterbridge:
    ...
    command: [&quot;matterbridge&quot;, &quot;--docker&quot;, &quot;--frontend&quot;, &quot;8585&quot;]
</code></pre>
<p>If you override the command, always start it with <code>[&quot;matterbridge&quot;, &quot;--docker&quot;]</code>.</p>
<p><strong>If you change the frontend port, overriding the default command of the images, docker will report the container unhealty unless you add:</strong>.</p>
<pre><code class="language-yaml">    healthcheck:
      disable: true
</code></pre>
<h3 id="stop-with-docker-compose">Stop with Docker Compose</h3>
<pre><code class="language-bash">docker compose down
</code></pre>
<h3 id="update-with-docker-compose">Update with Docker Compose</h3>
<p>This pulls the new Matterbridge image and restarts only the Matterbridge container:</p>
<pre><code class="language-bash">docker compose pull matterbridge
docker compose up -d --no-deps --force-recreate matterbridge
</code></pre>
<h3 id="inspect-the-container">Inspect the container</h3>
<pre><code class="language-bash">docker container inspect matterbridge
</code></pre>
<h3 id="start-the-docker-container">Start the Docker container</h3>
<pre><code class="language-bash">docker start matterbridge
</code></pre>
<h3 id="stop-the-docker-container">Stop the Docker container</h3>
<pre><code class="language-bash">docker stop matterbridge
</code></pre>
<h3 id="restart-the-docker-container">Restart the Docker container</h3>
<pre><code class="language-bash">docker restart matterbridge
</code></pre>
<h3 id="show-the-logs">Show the logs</h3>
<pre><code class="language-bash">docker logs matterbridge
</code></pre>
<h3 id="show-the-logs-for-a-time-interval">Show the logs for a time interval</h3>
<pre><code class="language-bash">docker logs \
  --since &quot;2025-04-19T00:00:00&quot; \
  --until &quot;2025-04-19T00:02:00&quot; \
  matterbridge
</code></pre>
<h3 id="show-the-logs-in-real-time-tail">Show the logs in real time (tail)</h3>
<pre><code class="language-bash">docker logs --tail 1000 -f matterbridge
</code></pre>
<h3 id="prevent-log-growth">Prevent log growth</h3>
<p>If you want to prevent Docker logs from growing too much, you can configure Docker&#39;s logging options globally.</p>
<p><strong>Warning</strong>: This will restart Docker and affect all running containers.</p>
<pre><code class="language-bash">sudo nano /etc/docker/daemon.json
</code></pre>
<p>Add or update the logging configuration in <code>daemon.json</code>:</p>
<pre><code class="language-json">{
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;100m&quot;,
    &quot;max-file&quot;: &quot;3&quot;
  }
}
</code></pre>
<p>Where:</p>
<ul>
<li><code>max-size</code>: Maximum size of each log file (e.g., &quot;10m&quot;, &quot;100m&quot;, &quot;1g&quot;)</li>
<li><code>max-file</code>: Maximum number of log files to keep</li>
</ul>
<p>Save the file and restart Docker:</p>
<pre><code class="language-bash">sudo systemctl restart docker
</code></pre>
<p><strong>Note</strong>: This configuration applies to new containers. Existing containers must be recreated to use the new logging settings.</p>
  <script>
    const copyIcon = '<svg viewBox="0 0 16 16" aria-hidden="true" focusable="false"><path d="M11 1H3c-.6 0-1 .4-1 1v10h2V3h7V1zm2 3H6c-.6 0-1 .4-1 1v10c0 .6.4 1 1 1h7c.6 0 1-.4 1-1V5c0-.6-.4-1-1-1zm-1 10H7V6h5v8z"></path></svg>';
    const successIcon = '<svg viewBox="0 0 16 16" aria-hidden="true" focusable="false"><path d="M6.5 10.7L4.3 8.5 3 9.8l3.5 3.5 6.5-6.5-1.3-1.3z"></path></svg>';

    document.querySelectorAll('pre').forEach(block => {
      const button = document.createElement('button');
      button.type = 'button';
      button.className = 'copy-btn';
      button.setAttribute('aria-label', 'Copy code snippet');
      button.innerHTML = copyIcon;

      let resetTimer;
      button.addEventListener('click', async () => {
        const code = block.querySelector('code')?.innerText ?? '';
        try {
          await navigator.clipboard.writeText(code);
        } catch {
          const textarea = document.createElement('textarea');
          textarea.value = code;
          textarea.style.position = 'fixed';
          textarea.style.opacity = '0';
          document.body.appendChild(textarea);
          textarea.focus();
          textarea.select();
          document.execCommand('copy');
          textarea.remove();
        }

        clearTimeout(resetTimer);
        button.innerHTML = successIcon;
        button.classList.add('copied');
        resetTimer = setTimeout(() => {
          button.innerHTML = copyIcon;
          button.classList.remove('copied');
        }, 2000);
      });

      block.appendChild(button);
    });
  </script>
</body>
</html>
